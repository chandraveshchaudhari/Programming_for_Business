
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>FINANCIAL FORECASTING &#8212; Machine Learning for Business</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'financial_forecasting';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Level Data Forecasting Models" href="level_data_time_series.html" />
    <link rel="prev" title="Differentiation and integration" href="Diff_and_integration.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Machine Learning for Business - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Machine Learning for Business - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to Machine Learning for Business Book
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="symbols.html">Common Math Symbols and Notations in Machine Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="1_Linear_regression.html">Linear Regression</a></li>

















<li class="toctree-l1"><a class="reference internal" href="2_Regularization.html">Generalization, Overfitting, Regularization</a></li>



<li class="toctree-l1"><a class="reference internal" href="3_Naive_Bayes.html">Naive Bayes</a></li>



<li class="toctree-l1"><a class="reference internal" href="4_Logistic_Regression.html"><strong>Logistic Regression (Mathematical Explanation)</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="5_Dimensionality_Reduction.html">Dimensionality Reduction: PCA</a></li>






<li class="toctree-l1"><a class="reference internal" href="6_Clustering.html">K-Means and Clustering</a></li>




<li class="toctree-l1"><a class="reference internal" href="7_Gaussian_Mixture_Models.html">Gaussian Mixture Models and EM</a></li>


<li class="toctree-l1"><a class="reference internal" href="8_Nearest_Neighbour_Algorithm.html">Nearest Neighbour Algorithm</a></li>







<li class="toctree-l1"><a class="reference internal" href="10_Support_Vector_Machines.html">Support Vector Machines</a></li>



<li class="toctree-l1"><a class="reference internal" href="11_Decision_Trees.html">Decision Trees</a></li>

<li class="toctree-l1"><a class="reference internal" href="12_Ensemble_Methods.html">Ensemble Methods</a></li>

<li class="toctree-l1"><a class="reference internal" href="13_Neural_Networks.html">Neural Networks: From Perceptron to MLP</a></li>





<li class="toctree-l1"><a class="reference internal" href="14_Arima.html">ARIMA</a></li>





<li class="toctree-l1"><a class="reference internal" href="15_LSTM.html">Advanced DL: ResNets, RNNs</a></li>

<li class="toctree-l1"><a class="reference internal" href="16_CNN.html">Convolutional Neural Networks</a></li>


<li class="toctree-l1"><a class="reference internal" href="17_Resnet.html">1D-ResNet (or TCN)</a></li>
<li class="toctree-l1"><a class="reference internal" href="18_LLM.html">Transformers and LLMs</a></li>

<li class="toctree-l1"><a class="reference internal" href="19_Reinforcement_Learning.html">Reinforcement Learning</a></li>

<li class="toctree-l1"><a class="reference internal" href="20_Multimodal_Learning.html">Multimodal Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="Generative_Models.html">Generative Models</a></li>




<li class="toctree-l1"><a class="reference internal" href="Performance_Metrics.html">Performance Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="Visualization.html">Visualisation</a></li>





<li class="toctree-l1"><a class="reference internal" href="clustering.html">Clustering KNN</a></li>

<li class="toctree-l1"><a class="reference internal" href="descriptive_analytics.html">Descriptive Analytics of Financial Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="Diff_and_integration.html">Differentiation and integration</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">FINANCIAL FORECASTING</a></li>
<li class="toctree-l1"><a class="reference internal" href="level_data_time_series.html">Level Data Forecasting Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="Llm_and_transformers.html">LLM Transformers</a></li>











































<li class="toctree-l1"><a class="reference internal" href="Python_crash_course.html">Python Crash Course</a></li>











<li class="toctree-l1"><a class="reference internal" href="seasonal_data.html">Seasonal Data Forecasting Models</a></li>








<li class="toctree-l1"><a class="reference internal" href="time_series_models.html">TIME SERIES MODELS</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/chandraveshchaudhari/BusinessML_web/blob/main/notebooks//./financial_forecasting.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>

<li>
  <a href="https://chandraveshchaudhari.github.io/BusinessML_web/jupyterlite/lab/index.html?path=financial_forecasting.ipynb" target="_blank"
     class="btn btn-sm dropdown-item"
     title="Launch on JupyterLite"
     data-bs-placement="left" data-bs-toggle="tooltip">
    <span class="btn__icon-container" style="display:inline-block; width:20px; height:20px;">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256">
        <circle cx="128" cy="128" r="128" fill="#f37726"/>
        <ellipse cx="128" cy="128" rx="110" ry="40" fill="white" transform="rotate(-25, 128, 128)"/>
        <ellipse cx="128" cy="128" rx="110" ry="40" fill="white" transform="rotate(25, 128, 128)"/>
        <circle cx="200" cy="60" r="18" fill="white"/>
        <circle cx="60" cy="200" r="18" fill="white"/>
      </svg>
    </span>
    <span class="btn__text-container">JupyterLite</span>
  </a>
</li>

</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/chandraveshchaudhari/BusinessML_web" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/chandraveshchaudhari/BusinessML_web/issues/new?title=Issue%20on%20page%20%2Ffinancial_forecasting.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/financial_forecasting.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>FINANCIAL FORECASTING</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of Contents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data">Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#types-of-data">1. Types of Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#datasets-and-databases">2. Datasets and Databases</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#relational-databases-sql">1. Relational Databases (SQL)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-a-relational-database">What is a Relational Database?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-concepts">Key Concepts</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-data">Example Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#querying-with-sql">Querying with SQL</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case">Use Case</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nosql-databases">2. NoSQL Databases</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-a-nosql-database">What is a NoSQL Database?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Key Concepts</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Example Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#querying-with-nosql-pseudo-code">Querying with NoSQL (Pseudo-Code)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Use Case</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparing-sql-and-nosql">3. Comparing SQL and NoSQL</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-in-python-pseudo-code">Example in Python (Pseudo-Code)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#why-this-matters">Why This Matters</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#data-selection">3. Data Selection</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-methods">Key Methods:</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#implementation-python"><strong>Implementation (Python)</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id4"><strong>Why This Matters</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-preparation-for-time-series">4. Data Preparation for Time Series</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#imputation">1. Imputation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#normalization-scaling">2. Normalization &amp; Scaling</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#outlier-detection-treatment">3. Outlier Detection &amp; Treatment</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#feature-engineering-for-time-series">4. Feature Engineering for Time Series</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#modifying-data-using-excel">5. Modifying Data Using Excel</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#using-range-names-in-databases">6. Using Range Names in Databases</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#excel-name-manager">Excel Name Manager</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#database-fields-and-naming-conventions-in-sql">Database Fields and Naming Conventions in SQL</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#examples">Examples</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1-excel-named-range-for-financial-calculations">Example 1: Excel Named Range for Financial Calculations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-2-dynamic-named-range-for-growing-data">Example 2: Dynamic Named Range for Growing Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-3-sql-database-field-naming">Example 3: SQL Database Field Naming</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#data-classification">7. Data Classification</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#data-partition">8. Data Partition</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#standard-splits">Standard Splits:</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#data-exploration">9. Data Exploration</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#common-steps-in-time-series-eda">Common Steps in Time Series EDA:</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sorting">10. Sorting</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-applications-in-time-series">Example Applications in Time Series:</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#filtering-data">11. Filtering Data</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#examples-in-time-series">Examples in Time Series:</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Modifying Data using Excel</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-distribution-from-data">12. Creating Distribution from Data</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#common-tools-for-visualizing-distributions">Common Tools for Visualizing Distributions:</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#analyzing-distribution">13. Analyzing Distribution</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tools-for-assessing-distribution-shape">Tools for Assessing Distribution Shape:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-distributions-from-time-series-data-for-forecasting">Creating Distributions from Time Series Data for Forecasting</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#measures-of-location">Measures of Location</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#measures-of-variability">Measures of Variability</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#measures-of-association">Measures of Association</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#autocorrelation-acf">1. Autocorrelation (ACF)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#partial-autocorrelation-pacf">2. Partial Autocorrelation (PACF)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cross-correlation">3. Cross-Correlation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analyzing-distributions-for-forecasting">Analyzing Distributions for Forecasting</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-reduction">17. Data Reduction</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pareto-analysis-80-20-rule">18. Pareto Analysis (80/20 Rule)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#steps">Steps:</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="financial-forecasting">
<h1>FINANCIAL FORECASTING<a class="headerlink" href="#financial-forecasting" title="Link to this heading">#</a></h1>
<hr style="height:2px; border-width:0; color:gray; background-color:gray">
<table width="100%">
  <tr>
    <td align="left" width="60%">
      <h2 style="color: #2c3e50; font-family: Arial, sans-serif;">
        Technology for Financial Forecasting
      </h2>
      <p>
        <strong>Chandravesh Chaudhari</strong><br>
        Assistant Professor<br>
        School of Business and Management<br>
        <a href="mailto:chandravesh.chaudhari@christuniversity.in" style="color: #2980b9; text-decoration: none;">
          chandravesh.chaudhari@christuniversity.in
        </a>
      </p>
    </td>
    <td align="right" width="40%">
      <img src="logo.jpg" alt="Christ University" width="250">
    </td>
  </tr>
</table>
<hr style="height:2px; border-width:0; color:gray; background-color:gray">
<p><strong>Duration</strong>: 9 Hours</p>
<section id="table-of-contents">
<h2>Table of Contents<a class="headerlink" href="#table-of-contents" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#Types-of-Data"><span class="xref myst">Types of Data</span></a></p></li>
<li><p><a class="reference internal" href="#Datasets-and-Databases"><span class="xref myst">Datasets and Databases</span></a></p></li>
<li><p><a class="reference internal" href="#Data-Selection"><span class="xref myst">Data Selection</span></a></p></li>
<li><p><a class="reference internal" href="#Data-Preparation"><span class="xref myst">Data Preparation</span></a></p></li>
<li><p><a class="reference internal" href="#Modifying-Data-Using-Excel"><span class="xref myst">Modifying Data Using Excel</span></a></p></li>
<li><p><a class="reference internal" href="#Using-Range-Names-in-Databases"><span class="xref myst">Using Range Names in Databases</span></a></p></li>
<li><p><a class="reference internal" href="#Data-Classification"><span class="xref myst">Data Classification</span></a></p></li>
<li><p><a class="reference internal" href="#Data-Partition"><span class="xref myst">Data Partition</span></a></p></li>
<li><p><a class="reference internal" href="#Data-Exploration"><span class="xref myst">Data Exploration</span></a></p></li>
<li><p><a class="reference internal" href="#Sorting"><span class="xref myst">Sorting</span></a></p></li>
<li><p><a class="reference internal" href="#Filtering-Data"><span class="xref myst">Filtering Data</span></a></p></li>
<li><p><a class="reference internal" href="#Creating-Distribution-from-Data"><span class="xref myst">Creating Distribution from Data</span></a></p></li>
<li><p><a class="reference internal" href="#Analyzing-Distribution"><span class="xref myst">Analyzing Distribution</span></a></p></li>
<li><p><a class="reference internal" href="#Measures-of-Location"><span class="xref myst">Measures of Location</span></a></p></li>
<li><p><a class="reference internal" href="#Measures-of-Variability"><span class="xref myst">Measures of Variability</span></a></p></li>
<li><p><a class="reference internal" href="#Measures-of-Association"><span class="xref myst">Measures of Association</span></a></p></li>
<li><p><a class="reference internal" href="#Data-Reduction"><span class="xref myst">Data Reduction</span></a></p></li>
<li><p><a class="reference internal" href="##Pareto-Analysis"><span class="xref myst">Pareto Analysis</span></a></p></li>
</ol>
<p>References:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://real-statistics.com/time-series-analysis/">https://real-statistics.com/time-series-analysis/</a></p></li>
</ul>
</section>
<hr class="docutils" />
<section id="data">
<h2>Data<a class="headerlink" href="#data" title="Link to this heading">#</a></h2>
<hr class="docutils" />
<p>The Latin word data is the plural of datum, “(thing) given,” and the neuter past participle of dare, “to give”. The first English use of the word “data” is from the 1640s. The word “data” was first used to mean “transmissible and storable computer information” in 1946. The expression “data processing” was first used in 1954 (<a class="reference external" href="https://en.wikipedia.org/wiki/Data">https://en.wikipedia.org/wiki/Data</a>).</p>
<img src="Data_types.png" alt="Data" width="500">
<p>These are some of the different types of data: Geographical, Cultural, Scientific, Financial, Statistical, Meteorological, Natural, Transport</p>
<hr class="docutils" />
<section id="types-of-data">
<h3>1. Types of Data<a class="headerlink" href="#types-of-data" title="Link to this heading">#</a></h3>
<hr class="docutils" />
<ul class="simple">
<li><p><strong>Description</strong>: Understanding the different forms of data: numerical (continuous, discrete), categorical (nominal, ordinal), and time-series.</p></li>
<li><p><strong>Relevance</strong>: Different data types require specific handling in forecasting models (e.g., time-series models for stock prices, classification models for credit risk).</p></li>
<li><p><strong>Related Concepts</strong>:</p>
<ul>
<li><p><strong>Data Scales</strong>: Nominal, ordinal, interval, and ratio scales.</p></li>
<li><p><strong>Data Sources</strong>: Primary (e.g., company sales records) vs. secondary (e.g., market indices).</p></li>
<li><p><strong>Time-Series Components</strong>: Trend, seasonality, and noise in financial data.</p></li>
</ul>
</li>
<li><p><strong>Example</strong>: Numerical: Stock prices (continuous). Categorical: Industry sectors (nominal). Time-series: Daily sales.</p></li>
<li><p><strong>Mathematical Context</strong>: Time-series data often follows models like:
$<span class="math notranslate nohighlight">\(
y_t = T_t + S_t + \epsilon_t
\)</span><span class="math notranslate nohighlight">\(
where \)</span> T_t <span class="math notranslate nohighlight">\( is the trend, \)</span> S_t <span class="math notranslate nohighlight">\( is the seasonal component, and \)</span> \epsilon_t $ is random noise.</p></li>
<li><p><strong>Teaching Tip</strong>: Use real-world examples (e.g., stock prices vs. customer ratings) and ask students to classify data types from a sample dataset.</p></li>
</ul>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Example</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Numerical</strong></p></td>
<td><p>Quantitative values</p></td>
<td><p>Stock price, volume</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Categorical</strong></p></td>
<td><p>Distinct groups</p></td>
<td><p>Sector: IT, Pharma, Banking</p></td>
</tr>
<tr class="row-even"><td><p><strong>Time Series</strong></p></td>
<td><p>Indexed by time</p></td>
<td><p>Daily closing prices</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Textual</strong></p></td>
<td><p>Unstructured data</p></td>
<td><p>News headlines, financial reports</p></td>
</tr>
<tr class="row-even"><td><p><strong>Ordinal</strong></p></td>
<td><p>Ordered categories</p></td>
<td><p>Credit ratings: AAA, AA, A, BBB…</p></td>
</tr>
</tbody>
</table>
</div>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">faker</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: faker in /Users/chandraveshchaudhari/anaconda3/lib/python3.12/site-packages (37.3.0)
Requirement already satisfied: tzdata in /Users/chandraveshchaudhari/anaconda3/lib/python3.12/site-packages (from faker) (2023.3)
Note: you may need to restart the kernel to use updated packages.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">faker</span><span class="w"> </span><span class="kn">import</span> <span class="n">Faker</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">datetime</span>

<span class="c1"># Set random seed for reproducibility</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Initialize Faker for generating realistic textual data</span>
<span class="n">fake</span> <span class="o">=</span> <span class="n">Faker</span><span class="p">()</span>

<span class="c1"># Number of samples</span>
<span class="n">n_samples</span> <span class="o">=</span> <span class="mi">100</span>

<span class="c1"># 1. Numerical Data (Continuous and Discrete)</span>
<span class="c1"># Continuous: Stock prices (e.g., normally distributed around $100 with some variation)</span>
<span class="n">stock_prices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n_samples</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># Discrete: Trading volume (e.g., random integers between 1000 and 10000)</span>
<span class="n">trading_volumes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n_samples</span><span class="p">)</span>

<span class="c1"># 2. Categorical Data (Nominal)</span>
<span class="c1"># Sectors: Randomly choose from IT, Pharma, Banking, Energy</span>
<span class="n">sectors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;IT&#39;</span><span class="p">,</span> <span class="s1">&#39;Pharma&#39;</span><span class="p">,</span> <span class="s1">&#39;Banking&#39;</span><span class="p">,</span> <span class="s1">&#39;Energy&#39;</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="n">n_samples</span><span class="p">)</span>

<span class="c1"># 3. Time Series Data</span>
<span class="c1"># Generate daily dates starting from Jan 1, 2025</span>
<span class="n">start_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">dates</span> <span class="o">=</span> <span class="p">[</span><span class="n">start_date</span> <span class="o">+</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_samples</span><span class="p">)]</span>
<span class="c1"># Time-series: Daily closing prices with trend, seasonality, and noise</span>
<span class="n">trend</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">)</span>  <span class="c1"># Linear trend from 90 to 110</span>
<span class="n">seasonality</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">10</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">))</span>  <span class="c1"># Seasonal component</span>
<span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">)</span>  <span class="c1"># Random noise</span>
<span class="n">closing_prices</span> <span class="o">=</span> <span class="p">(</span><span class="n">trend</span> <span class="o">+</span> <span class="n">seasonality</span> <span class="o">+</span> <span class="n">noise</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># 4. Textual Data</span>
<span class="c1"># Generate fake financial news headlines</span>
<span class="n">headlines</span> <span class="o">=</span> <span class="p">[</span><span class="n">fake</span><span class="o">.</span><span class="n">sentence</span><span class="p">(</span><span class="n">nb_words</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_samples</span><span class="p">)]</span>

<span class="c1"># 5. Ordinal Data</span>
<span class="c1"># Credit ratings: Ordered categories AAA, AA, A, BBB</span>
<span class="n">credit_ratings</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s1">&#39;AAA&#39;</span><span class="p">,</span> <span class="s1">&#39;AA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;BBB&#39;</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">])</span>

<span class="c1"># Create a DataFrame to hold all sample data</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Date&#39;</span><span class="p">:</span> <span class="n">dates</span><span class="p">,</span>
    <span class="s1">&#39;Stock_Price&#39;</span><span class="p">:</span> <span class="n">stock_prices</span><span class="p">,</span>
    <span class="s1">&#39;Trading_Volume&#39;</span><span class="p">:</span> <span class="n">trading_volumes</span><span class="p">,</span>
    <span class="s1">&#39;Sector&#39;</span><span class="p">:</span> <span class="n">sectors</span><span class="p">,</span>
    <span class="s1">&#39;Closing_Price&#39;</span><span class="p">:</span> <span class="n">closing_prices</span><span class="p">,</span>
    <span class="s1">&#39;News_Headline&#39;</span><span class="p">:</span> <span class="n">headlines</span><span class="p">,</span>
    <span class="s1">&#39;Credit_Rating&#39;</span><span class="p">:</span> <span class="n">credit_ratings</span>
<span class="p">}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Stock_Price</th>
      <th>Trading_Volume</th>
      <th>Sector</th>
      <th>Closing_Price</th>
      <th>News_Headline</th>
      <th>Credit_Rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2025-01-01</td>
      <td>104.97</td>
      <td>5413</td>
      <td>IT</td>
      <td>92.17</td>
      <td>Focus a place building me you way security som...</td>
      <td>A</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2025-01-02</td>
      <td>98.62</td>
      <td>4748</td>
      <td>Energy</td>
      <td>95.27</td>
      <td>Really lay future imagine perform such trial s...</td>
      <td>BBB</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2025-01-03</td>
      <td>106.48</td>
      <td>1663</td>
      <td>Energy</td>
      <td>92.42</td>
      <td>Mother seat financial attorney left meeting fo...</td>
      <td>BBB</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2025-01-04</td>
      <td>115.23</td>
      <td>2998</td>
      <td>Energy</td>
      <td>93.46</td>
      <td>Down maintain standard recognize TV relate off...</td>
      <td>A</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2025-01-05</td>
      <td>97.66</td>
      <td>8994</td>
      <td>Energy</td>
      <td>94.67</td>
      <td>Board market morning western feel whether pape...</td>
      <td>AA</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Closing_Price&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Daily Closing Price&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Sample Time-Series: Daily Closing Prices&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Price ($)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4a86db6cefc7e9c792347621de68222c798e5170493cd883ca8d9cc1efd2cd85.png" src="_images/4a86db6cefc7e9c792347621de68222c798e5170493cd883ca8d9cc1efd2cd85.png" />
</div>
</div>
<hr class="docutils" />
</section>
<section id="datasets-and-databases">
<h3>2. Datasets and Databases<a class="headerlink" href="#datasets-and-databases" title="Link to this heading">#</a></h3>
<hr class="docutils" />
<ul class="simple">
<li><p><strong>Description</strong>: Structured collections of data, stored in formats like CSV, Excel, or relational databases (e.g., SQL).</p></li>
<li><p><strong>Relevance</strong>: Financial forecasting relies on large datasets from sources like Bloomberg or internal ERP systems.</p></li>
<li><p><strong>Related Concepts</strong>:</p>
<ul>
<li><p><strong>Database Structures</strong>: Tables, rows, columns, and primary keys.</p></li>
<li><p><strong>Data Formats</strong>: CSV, JSON, SQL databases.</p></li>
<li><p><strong>Data Access</strong>: Querying with SQL (e.g., <code class="docutils literal notranslate"><span class="pre">SELECT</span> <span class="pre">*</span> <span class="pre">FROM</span> <span class="pre">sales</span> <span class="pre">WHERE</span> <span class="pre">date</span> <span class="pre">&gt;=</span> <span class="pre">'2024-01-01'</span></code>).</p></li>
</ul>
</li>
<li><p><strong>Example</strong>: A database of customer transactions with fields like <code class="docutils literal notranslate"><span class="pre">customer_id</span></code>, <code class="docutils literal notranslate"><span class="pre">date</span></code>, and <code class="docutils literal notranslate"><span class="pre">amount</span></code>.</p></li>
</ul>
<p>A dataset is a structured collection of data.</p>
<p>A database is a structured system for storing, querying, and managing data.</p>
<p><strong>Common Types:</strong></p>
<ul class="simple">
<li><p><strong>Relational (SQL)</strong>: PostgreSQL, MySQL, SQLite</p></li>
<li><p><strong>NoSQL</strong>: MongoDB (for unstructured data)</p></li>
</ul>
</section>
<section id="relational-databases-sql">
<h3>1. Relational Databases (SQL)<a class="headerlink" href="#relational-databases-sql" title="Link to this heading">#</a></h3>
</section>
<section id="what-is-a-relational-database">
<h3>What is a Relational Database?<a class="headerlink" href="#what-is-a-relational-database" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>A <strong>relational database</strong> stores data in <strong>tables</strong>, like spreadsheets.</p></li>
<li><p>Each table represents an entity (e.g., Customers, Orders).</p></li>
<li><p>Tables are connected using <strong>keys</strong>.</p></li>
</ul>
</section>
<section id="key-concepts">
<h3>Key Concepts<a class="headerlink" href="#key-concepts" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Table</strong>: A collection of rows and columns (e.g., a <code class="docutils literal notranslate"><span class="pre">customers</span></code> table with columns <code class="docutils literal notranslate"><span class="pre">customer_id</span></code>, <code class="docutils literal notranslate"><span class="pre">name</span></code>, <code class="docutils literal notranslate"><span class="pre">email</span></code>).</p></li>
<li><p><strong>Primary Key</strong>: A unique identifier for each row (e.g., <code class="docutils literal notranslate"><span class="pre">customer_id</span></code>). No two rows can have the same primary key.</p></li>
<li><p><strong>Foreign Key</strong>: A column in one table that links to the primary key of another table (e.g., <code class="docutils literal notranslate"><span class="pre">customer_id</span></code> in an <code class="docutils literal notranslate"><span class="pre">orders</span></code> table links to <code class="docutils literal notranslate"><span class="pre">customer_id</span></code> in <code class="docutils literal notranslate"><span class="pre">customers</span></code>).</p></li>
<li><p><strong>Relationships</strong>:</p>
<ul>
<li><p><strong>One-to-Many</strong>: One customer can have many orders.</p></li>
<li><p><strong>Many-to-Many</strong>: Requires a junction table (e.g., <code class="docutils literal notranslate"><span class="pre">student_courses</span></code> for students and courses).</p></li>
</ul>
</li>
</ul>
</section>
<section id="example-data">
<h3>Example Data<a class="headerlink" href="#example-data" title="Link to this heading">#</a></h3>
<p>Imagine two tables:</p>
<p><strong>Table: customers</strong></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>customer_id (Primary Key)</p></th>
<th class="head"><p>name</p></th>
<th class="head"><p>email</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>Alice Smith</p></td>
<td><p><a class="reference external" href="mailto:alice&#37;&#52;&#48;email&#46;com">alice<span>&#64;</span>email<span>&#46;</span>com</a></p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>Bob Jones</p></td>
<td><p><a class="reference external" href="mailto:bob&#37;&#52;&#48;email&#46;com">bob<span>&#64;</span>email<span>&#46;</span>com</a></p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>Cathy Lee</p></td>
<td><p><a class="reference external" href="mailto:cathy&#37;&#52;&#48;email&#46;com">cathy<span>&#64;</span>email<span>&#46;</span>com</a></p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Table: orders</strong></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>order_id (Primary Key)</p></th>
<th class="head"><p>customer_id (Foreign Key)</p></th>
<th class="head"><p>amount</p></th>
<th class="head"><p>order_date</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>101</p></td>
<td><p>1</p></td>
<td><p>150.50</p></td>
<td><p>2025-01-10</p></td>
</tr>
<tr class="row-odd"><td><p>102</p></td>
<td><p>1</p></td>
<td><p>89.99</p></td>
<td><p>2025-02-15</p></td>
</tr>
<tr class="row-even"><td><p>103</p></td>
<td><p>2</p></td>
<td><p>200.00</p></td>
<td><p>2025-03-01</p></td>
</tr>
<tr class="row-odd"><td><p>104</p></td>
<td><p>3</p></td>
<td><p>45.75</p></td>
<td><p>2025-04-20</p></td>
</tr>
</tbody>
</table>
</div>
<ul class="simple">
<li><p><strong>Connection</strong>: The <code class="docutils literal notranslate"><span class="pre">customer_id</span></code> in <code class="docutils literal notranslate"><span class="pre">orders</span></code> links to <code class="docutils literal notranslate"><span class="pre">customer_id</span></code> in <code class="docutils literal notranslate"><span class="pre">customers</span></code>. For example, Alice (customer_id 1) has two orders (order_id 101 and 102).</p></li>
</ul>
</section>
<section id="querying-with-sql">
<h3>Querying with SQL<a class="headerlink" href="#querying-with-sql" title="Link to this heading">#</a></h3>
<p>SQL (Structured Query Language) retrieves data. Example queries:</p>
<ol class="arabic">
<li><p><strong>Get all customers</strong>:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">customers</span><span class="p">;</span>
</pre></div>
</div>
<p>Returns the entire <code class="docutils literal notranslate"><span class="pre">customers</span></code> table.</p>
</li>
<li><p><strong>Get orders for a customer</strong>:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="k">c</span><span class="p">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">o</span><span class="p">.</span><span class="n">order_id</span><span class="p">,</span><span class="w"> </span><span class="n">o</span><span class="p">.</span><span class="n">amount</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">customers</span><span class="w"> </span><span class="k">c</span>
<span class="k">JOIN</span><span class="w"> </span><span class="n">orders</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">c</span><span class="p">.</span><span class="n">customer_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">o</span><span class="p">.</span><span class="n">customer_id</span>
<span class="k">WHERE</span><span class="w"> </span><span class="k">c</span><span class="p">.</span><span class="n">customer_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</pre></div>
</div>
<p>Returns:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>name</p></th>
<th class="head"><p>order_id</p></th>
<th class="head"><p>amount</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Alice Smith</p></td>
<td><p>101</p></td>
<td><p>150.50</p></td>
</tr>
<tr class="row-odd"><td><p>Alice Smith</p></td>
<td><p>102</p></td>
<td><p>89.99</p></td>
</tr>
</tbody>
</table>
</div>
</li>
</ol>
</section>
<section id="use-case">
<h3>Use Case<a class="headerlink" href="#use-case" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Banking systems</strong>: Store customer accounts and transactions with strict relationships.</p></li>
<li><p><strong>Advantages</strong>: Structured, enforces data consistency.</p></li>
<li><p><strong>Examples</strong>: MySQL, PostgreSQL, SQLite.</p></li>
</ul>
</section>
<section id="nosql-databases">
<h3>2. NoSQL Databases<a class="headerlink" href="#nosql-databases" title="Link to this heading">#</a></h3>
</section>
<section id="what-is-a-nosql-database">
<h3>What is a NoSQL Database?<a class="headerlink" href="#what-is-a-nosql-database" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>A <strong>NoSQL database</strong> stores data in flexible formats, like JSON documents, not tables.</p></li>
<li><p>Ideal for unstructured or semi-structured data (e.g., social media posts).</p></li>
</ul>
</section>
<section id="id1">
<h3>Key Concepts<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Collection</strong>: Similar to a table, holds documents (e.g., a <code class="docutils literal notranslate"><span class="pre">customers</span></code> collection).</p></li>
<li><p><strong>Document</strong>: A JSON-like object with key-value pairs (e.g., a customer with name, email, and orders).</p></li>
<li><p><strong>Relationships</strong>: Handled by:</p>
<ul>
<li><p><strong>Embedding</strong>: Store related data in one document (e.g., orders inside a customer).</p></li>
<li><p><strong>Referencing</strong>: Link documents using IDs (less common).</p></li>
</ul>
</li>
</ul>
</section>
<section id="id2">
<h3>Example Data<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<p>A <code class="docutils literal notranslate"><span class="pre">customers</span></code> collection with documents:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Alice Smith&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;email&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;alice@email.com&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;orders&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">      </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;order_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">101</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;amount&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">150.50</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;order_date&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2025-01-10&quot;</span><span class="w"> </span><span class="p">},</span>
<span class="w">      </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;order_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">102</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;amount&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">89.99</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;order_date&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2025-02-15&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">]</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Bob Jones&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;email&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;bob@email.com&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;orders&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">      </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;order_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">103</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;amount&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">200.00</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;order_date&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2025-03-01&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">]</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Cathy Lee&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;email&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;cathy@email.com&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;orders&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">      </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;order_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">104</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;amount&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">45.75</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;order_date&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2025-04-20&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">]</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>Connection</strong>: Orders are <strong>embedded</strong> in each customer document, making it easy to retrieve all data together.</p></li>
</ul>
</section>
<section id="querying-with-nosql-pseudo-code">
<h3>Querying with NoSQL (Pseudo-Code)<a class="headerlink" href="#querying-with-nosql-pseudo-code" title="Link to this heading">#</a></h3>
<p>NoSQL databases like MongoDB use their own query syntax. Example in Python-like pseudo-code:</p>
<ol class="arabic">
<li><p><strong>Get all customers</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">customers</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">customers</span><span class="o">.</span><span class="n">find</span><span class="p">()</span>
</pre></div>
</div>
<p>Returns all documents in the <code class="docutils literal notranslate"><span class="pre">customers</span></code> collection.</p>
</li>
<li><p><strong>Get orders for a customer</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">customer</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">customers</span><span class="o">.</span><span class="n">find</span><span class="p">({</span><span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="k">for</span> <span class="n">order</span> <span class="ow">in</span> <span class="n">customer</span><span class="p">[</span><span class="s2">&quot;orders&quot;</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">order</span><span class="p">[</span><span class="s2">&quot;order_id&quot;</span><span class="p">],</span> <span class="n">order</span><span class="p">[</span><span class="s2">&quot;amount&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">101</span> <span class="mf">150.50</span>
<span class="mi">102</span> <span class="mf">89.99</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="id3">
<h3>Use Case<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>E-commerce</strong>: Store product details with varying attributes (e.g., some products have colors, others have sizes).</p></li>
<li><p><strong>Advantages</strong>: Flexible, scales easily for large data.</p></li>
<li><p><strong>Examples</strong>: MongoDB, DynamoDB, Cassandra.</p></li>
</ul>
</section>
</section>
<section id="comparing-sql-and-nosql">
<h2>3. Comparing SQL and NoSQL<a class="headerlink" href="#comparing-sql-and-nosql" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Feature</p></th>
<th class="head"><p>SQL (Relational)</p></th>
<th class="head"><p>NoSQL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Structure</strong></p></td>
<td><p>Tables with fixed columns</p></td>
<td><p>Documents with flexible fields</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Schema</strong></p></td>
<td><p>Fixed (must define columns)</p></td>
<td><p>Dynamic (add fields anytime)</p></td>
</tr>
<tr class="row-even"><td><p><strong>Relationships</strong></p></td>
<td><p>Primary/Foreign Keys, JOINs</p></td>
<td><p>Embedding or Referencing</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Query Language</strong></p></td>
<td><p>SQL (standardized)</p></td>
<td><p>Database-specific (e.g., MongoDB’s <code class="docutils literal notranslate"><span class="pre">find()</span></code>)</p></td>
</tr>
<tr class="row-even"><td><p><strong>Scalability</strong></p></td>
<td><p>Vertical (bigger servers)</p></td>
<td><p>Horizontal (more servers)</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Use Case</strong></p></td>
<td><p>Banking, ERP systems</p></td>
<td><p>Social media, IoT, catalogs</p></td>
</tr>
</tbody>
</table>
</div>
<section id="example-in-python-pseudo-code">
<h3>Example in Python (Pseudo-Code)<a class="headerlink" href="#example-in-python-pseudo-code" title="Link to this heading">#</a></h3>
<p>To show how data might be processed, here’s a Python script that simulates querying the example data:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Simulate SQL data (as lists of dictionaries)</span>
<span class="n">customers</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s2">&quot;customer_id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Alice Smith&quot;</span><span class="p">,</span> <span class="s2">&quot;email&quot;</span><span class="p">:</span> <span class="s2">&quot;alice@email.com&quot;</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;customer_id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Bob Jones&quot;</span><span class="p">,</span> <span class="s2">&quot;email&quot;</span><span class="p">:</span> <span class="s2">&quot;bob@email.com&quot;</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;customer_id&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Cathy Lee&quot;</span><span class="p">,</span> <span class="s2">&quot;email&quot;</span><span class="p">:</span> <span class="s2">&quot;cathy@email.com&quot;</span><span class="p">}</span>
<span class="p">]</span>
<span class="n">orders</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s2">&quot;order_id&quot;</span><span class="p">:</span> <span class="mi">101</span><span class="p">,</span> <span class="s2">&quot;customer_id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;amount&quot;</span><span class="p">:</span> <span class="mf">150.50</span><span class="p">,</span> <span class="s2">&quot;order_date&quot;</span><span class="p">:</span> <span class="s2">&quot;2025-01-10&quot;</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;order_id&quot;</span><span class="p">:</span> <span class="mi">102</span><span class="p">,</span> <span class="s2">&quot;customer_id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;amount&quot;</span><span class="p">:</span> <span class="mf">89.99</span><span class="p">,</span> <span class="s2">&quot;order_date&quot;</span><span class="p">:</span> <span class="s2">&quot;2025-02-15&quot;</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;order_id&quot;</span><span class="p">:</span> <span class="mi">103</span><span class="p">,</span> <span class="s2">&quot;customer_id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;amount&quot;</span><span class="p">:</span> <span class="mf">200.00</span><span class="p">,</span> <span class="s2">&quot;order_date&quot;</span><span class="p">:</span> <span class="s2">&quot;2025-03-01&quot;</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;order_id&quot;</span><span class="p">:</span> <span class="mi">104</span><span class="p">,</span> <span class="s2">&quot;customer_id&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;amount&quot;</span><span class="p">:</span> <span class="mf">45.75</span><span class="p">,</span> <span class="s2">&quot;order_date&quot;</span><span class="p">:</span> <span class="s2">&quot;2025-04-20&quot;</span><span class="p">}</span>
<span class="p">]</span>

<span class="c1"># Simulate SQL JOIN: Get customer names and their orders</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SQL-like JOIN result:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">customer</span> <span class="ow">in</span> <span class="n">customers</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">order</span> <span class="ow">in</span> <span class="n">orders</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">order</span><span class="p">[</span><span class="s2">&quot;customer_id&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">customer</span><span class="p">[</span><span class="s2">&quot;customer_id&quot;</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Name: </span><span class="si">{</span><span class="n">customer</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">, Order ID: </span><span class="si">{</span><span class="n">order</span><span class="p">[</span><span class="s1">&#39;order_id&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">, Amount: </span><span class="si">{</span><span class="n">order</span><span class="p">[</span><span class="s1">&#39;amount&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Simulate NoSQL data (embedded structure)</span>
<span class="n">nosql_customers</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Alice Smith&quot;</span><span class="p">,</span>
        <span class="s2">&quot;email&quot;</span><span class="p">:</span> <span class="s2">&quot;alice@email.com&quot;</span><span class="p">,</span>
        <span class="s2">&quot;orders&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span><span class="s2">&quot;order_id&quot;</span><span class="p">:</span> <span class="mi">101</span><span class="p">,</span> <span class="s2">&quot;amount&quot;</span><span class="p">:</span> <span class="mf">150.50</span><span class="p">,</span> <span class="s2">&quot;order_date&quot;</span><span class="p">:</span> <span class="s2">&quot;2025-01-10&quot;</span><span class="p">},</span>
            <span class="p">{</span><span class="s2">&quot;order_id&quot;</span><span class="p">:</span> <span class="mi">102</span><span class="p">,</span> <span class="s2">&quot;amount&quot;</span><span class="p">:</span> <span class="mf">89.99</span><span class="p">,</span> <span class="s2">&quot;order_date&quot;</span><span class="p">:</span> <span class="s2">&quot;2025-02-15&quot;</span><span class="p">}</span>
        <span class="p">]</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Bob Jones&quot;</span><span class="p">,</span>
        <span class="s2">&quot;email&quot;</span><span class="p">:</span> <span class="s2">&quot;bob@email.com&quot;</span><span class="p">,</span>
        <span class="s2">&quot;orders&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span><span class="s2">&quot;order_id&quot;</span><span class="p">:</span> <span class="mi">103</span><span class="p">,</span> <span class="s2">&quot;amount&quot;</span><span class="p">:</span> <span class="mf">200.00</span><span class="p">,</span> <span class="s2">&quot;order_date&quot;</span><span class="p">:</span> <span class="s2">&quot;2025-03-01&quot;</span><span class="p">}</span>
        <span class="p">]</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Cathy Lee&quot;</span><span class="p">,</span>
        <span class="s2">&quot;email&quot;</span><span class="p">:</span> <span class="s2">&quot;cathy@email.com&quot;</span><span class="p">,</span>
        <span class="s2">&quot;orders&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span><span class="s2">&quot;order_id&quot;</span><span class="p">:</span> <span class="mi">104</span><span class="p">,</span> <span class="s2">&quot;amount&quot;</span><span class="p">:</span> <span class="mf">45.75</span><span class="p">,</span> <span class="s2">&quot;order_date&quot;</span><span class="p">:</span> <span class="s2">&quot;2025-04-20&quot;</span><span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">]</span>

<span class="c1"># Simulate NoSQL query: Get customer names and their orders</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">NoSQL query result:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">customer</span> <span class="ow">in</span> <span class="n">nosql_customers</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">order</span> <span class="ow">in</span> <span class="n">customer</span><span class="p">[</span><span class="s2">&quot;orders&quot;</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Name: </span><span class="si">{</span><span class="n">customer</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">, Order ID: </span><span class="si">{</span><span class="n">order</span><span class="p">[</span><span class="s1">&#39;order_id&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">, Amount: </span><span class="si">{</span><span class="n">order</span><span class="p">[</span><span class="s1">&#39;amount&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Output</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SQL</span><span class="o">-</span><span class="n">like</span> <span class="n">JOIN</span> <span class="n">result</span><span class="p">:</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">Alice</span> <span class="n">Smith</span><span class="p">,</span> <span class="n">Order</span> <span class="n">ID</span><span class="p">:</span> <span class="mi">101</span><span class="p">,</span> <span class="n">Amount</span><span class="p">:</span> <span class="mf">150.50</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">Alice</span> <span class="n">Smith</span><span class="p">,</span> <span class="n">Order</span> <span class="n">ID</span><span class="p">:</span> <span class="mi">102</span><span class="p">,</span> <span class="n">Amount</span><span class="p">:</span> <span class="mf">89.99</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">Bob</span> <span class="n">Jones</span><span class="p">,</span> <span class="n">Order</span> <span class="n">ID</span><span class="p">:</span> <span class="mi">103</span><span class="p">,</span> <span class="n">Amount</span><span class="p">:</span> <span class="mf">200.00</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">Cathy</span> <span class="n">Lee</span><span class="p">,</span> <span class="n">Order</span> <span class="n">ID</span><span class="p">:</span> <span class="mi">104</span><span class="p">,</span> <span class="n">Amount</span><span class="p">:</span> <span class="mf">45.75</span>

<span class="n">NoSQL</span> <span class="n">query</span> <span class="n">result</span><span class="p">:</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">Alice</span> <span class="n">Smith</span><span class="p">,</span> <span class="n">Order</span> <span class="n">ID</span><span class="p">:</span> <span class="mi">101</span><span class="p">,</span> <span class="n">Amount</span><span class="p">:</span> <span class="mf">150.50</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">Alice</span> <span class="n">Smith</span><span class="p">,</span> <span class="n">Order</span> <span class="n">ID</span><span class="p">:</span> <span class="mi">102</span><span class="p">,</span> <span class="n">Amount</span><span class="p">:</span> <span class="mf">89.99</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">Bob</span> <span class="n">Jones</span><span class="p">,</span> <span class="n">Order</span> <span class="n">ID</span><span class="p">:</span> <span class="mi">103</span><span class="p">,</span> <span class="n">Amount</span><span class="p">:</span> <span class="mf">200.00</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">Cathy</span> <span class="n">Lee</span><span class="p">,</span> <span class="n">Order</span> <span class="n">ID</span><span class="p">:</span> <span class="mi">104</span><span class="p">,</span> <span class="n">Amount</span><span class="p">:</span> <span class="mf">45.75</span>
</pre></div>
</div>
</section>
<section id="why-this-matters">
<h3>Why This Matters<a class="headerlink" href="#why-this-matters" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>SQL</strong>: Ensures data consistency, great for financial systems where every transaction must be accurate.</p></li>
<li><p><strong>NoSQL</strong>: Handles varied data, great for apps like social media where posts have different formats. Famous use is comments on social media posts.</p></li>
</ul>
<hr class="docutils" />
<section id="data-selection">
<h4>3. Data Selection<a class="headerlink" href="#data-selection" title="Link to this heading">#</a></h4>
<hr class="docutils" />
<p><strong>Definition:</strong> Data selection is the process of identifying relevant data</p>
</section>
</section>
<section id="key-methods">
<h3>Key Methods:<a class="headerlink" href="#key-methods" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Boolean indexing</strong>: Filter rows by conditions</p></li>
<li><p><strong>Column selection</strong>: Choose specific features</p></li>
<li><p><strong>Time-based selection</strong>: <code class="docutils literal notranslate"><span class="pre">data[data['date'].between('2023-01-01',</span> <span class="pre">'2023-12-31')]</span></code></p></li>
</ul>
<p>Modern forecasting leverages vast datasets and computational power, but <strong>strategic data selection remains critical</strong> to avoid garbage-in-garbage-out (GIGO) scenarios.</p>
<ol class="arabic">
<li><p><strong>Relevance to Objective</strong></p>
<ul class="simple">
<li><p><em>Example</em>:</p>
<ul>
<li><p>Stock price prediction → Historical prices, trading volume, volatility indices.</p></li>
<li><p>Credit risk → Transaction history, credit scores, macroeconomic indicators.</p></li>
</ul>
</li>
<li><p><em>Tech Impact</em>: AI models (e.g., LSTM, Transformer) can process high-dimensional data but require domain-driven feature selection.</p></li>
</ul>
</li>
<li><p><strong>Data Types</strong></p>
<ul class="simple">
<li><p><strong>Structured</strong>: Time-series (stock prices), tabular (balance sheets).</p></li>
<li><p><strong>Unstructured</strong>: Earnings call transcripts (NLP), satellite images (CV).</p></li>
<li><p><em>Tech Tools</em>:</p>
<ul>
<li><p>APIs (YFinance, Alpha Vantage) for real-time structured data.</p></li>
<li><p>Scrapy/Selenium for web scraping unstructured data.</p></li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Quality &amp; Preprocessing</strong></p>
<ul>
<li><p><strong>Timeliness</strong>: Use streaming pipelines (Kafka, Spark) for real-time forecasts.</p></li>
<li><p><strong>Missing Data</strong>: Auto-imputation (KNN, MICE) vs. deletion (threshold-based).</p></li>
<li><p><em>Code Example</em>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Automated missing data handling</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.impute</span><span class="w"> </span><span class="kn">import</span> <span class="n">KNNImputer</span>
<span class="n">imputer</span> <span class="o">=</span> <span class="n">KNNImputer</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">clean_data</span> <span class="o">=</span> <span class="n">imputer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">raw_data</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p><strong>Feature Engineering</strong></p>
<ul class="simple">
<li><p><strong>Traditional</strong>: Lags, rolling averages (Pandas).</p></li>
<li><p><strong>AI-Driven</strong>: Automated feature generation (FeatureTools, AutoML).</p></li>
<li><p><em>Math Context</em>:<br />
$<span class="math notranslate nohighlight">\( \text{Rolling Mean}_t = \frac{1}{w}\sum_{i=t-w+1}^t x_i \)</span><span class="math notranslate nohighlight">\(  
where \)</span><span class="math notranslate nohighlight">\( w \)</span> = window size.</p></li>
</ul>
</li>
</ol>
<hr class="docutils" />
<section id="implementation-python">
<h4><strong>Implementation (Python)</strong><a class="headerlink" href="#implementation-python" title="Link to this heading">#</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sample data selection pipeline for stock forecasting</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">yfinance</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">yf</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.feature_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">mutual_info_regression</span>

<span class="c1"># 1. Extract data</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">yf</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s2">&quot;AAPL&quot;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="s2">&quot;2020-01-01&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;2023-12-31&quot;</span><span class="p">)</span>

<span class="c1"># 2. Select features (e.g., OHLCV + technical indicators)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;MA_50&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>  <span class="c1"># Moving average</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;Daily_Return&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span>

<span class="c1"># 3. Filter by relevance (e.g., correlation with target)</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Predict next-day close</span>
<span class="n">selected_features</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s1">&#39;Open&#39;</span><span class="p">,</span> <span class="s1">&#39;Volume&#39;</span><span class="p">,</span> <span class="s1">&#39;MA_50&#39;</span><span class="p">,</span> <span class="s1">&#39;Daily_Return&#39;</span><span class="p">]]</span>
<span class="n">mi_scores</span> <span class="o">=</span> <span class="n">mutual_info_regression</span><span class="p">(</span><span class="n">selected_features</span><span class="p">,</span> <span class="n">target</span><span class="o">.</span><span class="n">dropna</span><span class="p">())</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>Ethics Discussion</strong>: Bias in data selection (e.g., excluding small-cap stocks in index forecasting).</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="id4">
<h4><strong>Why This Matters</strong><a class="headerlink" href="#id4" title="Link to this heading">#</a></h4>
<ul>
<li><p><strong>Overfitting Risk</strong>: More data ≠ better models. Curated features beat brute force.</p></li>
<li><p><strong>Tech Stack Alignment</strong>:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Data Needs</p></th>
<th class="head"><p>Tools</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Holt-Winters</strong></p></td>
<td><p>Clean univariate series</p></td>
<td><p>Statsmodels, Pandas</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Prophet</strong></p></td>
<td><p>Time + regressors</p></td>
<td><p>Facebook Prophet</p></td>
</tr>
<tr class="row-even"><td><p><strong>Deep Learning</strong></p></td>
<td><p>High-dimension data (e.g., tick-level)</p></td>
<td><p>TensorFlow, PyTorch</p></td>
</tr>
</tbody>
</table>
</div>
</li>
</ul>
<hr class="docutils" />
</section>
</section>
<hr class="docutils" />
<section id="data-preparation-for-time-series">
<h3>4. Data Preparation for Time Series<a class="headerlink" href="#data-preparation-for-time-series" title="Link to this heading">#</a></h3>
<hr class="docutils" />
<ul class="simple">
<li><p><strong>Description</strong>: Cleaning and transforming data (e.g., handling missing values, normalizing, removing outliers).</p></li>
<li><p><strong>Relevance</strong>: Clean data is critical for reliable forecasts.</p></li>
<li><p><strong>Related Concepts</strong>:</p>
<ul>
<li><p><strong>Imputation</strong>: Filling missing values (e.g., mean imputation).</p></li>
<li><p><strong>Normalization</strong>: Scaling data to a common range (e.g., min-max scaling: <span class="math notranslate nohighlight">\( x' = \frac{x - x_{\min}}{x_{\max} - x_{\min}} \)</span>).</p></li>
<li><p><strong>Outlier Detection</strong>: Using z-scores or IQR.</p></li>
</ul>
</li>
<li><p><strong>Example</strong>: Replacing missing sales data with the average of the previous month.</p></li>
</ul>
<hr class="docutils" />
<section id="imputation">
<h4>1. Imputation<a class="headerlink" href="#imputation" title="Link to this heading">#</a></h4>
<ol class="arabic simple">
<li><p><strong>Forward Fill (ffill)</strong>:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\hat{y}_j = y_i\)</span>, where <span class="math notranslate nohighlight">\(y_i\)</span> is the last valid observation before the missing value at time <span class="math notranslate nohighlight">\(j\)</span>.</p></li>
</ul>
</li>
<li><p><strong>Backward Fill (bfill)</strong>:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\hat{y}_j = y_k\)</span>, where <span class="math notranslate nohighlight">\(y_k\)</span> is the next valid observation after the missing value at time <span class="math notranslate nohighlight">\(j\)</span>.</p></li>
</ul>
</li>
<li><p><strong>Linear Interpolation</strong>:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\hat{y}_j = y_i + (y_k - y_i) \times \frac{j - i}{k - i}\)</span>, where <span class="math notranslate nohighlight">\(y_i\)</span> and <span class="math notranslate nohighlight">\(y_k\)</span> are the nearest valid observations.</p></li>
</ul>
</li>
<li><p><strong>Polynomial Interpolation (Quadratic)</strong>:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\hat{y}_j = P(j)\)</span>, where <span class="math notranslate nohighlight">\(P(t) = at^2 + bt + c\)</span> is a second-degree polynomial fitted to nearby points.</p></li>
</ul>
</li>
<li><p><strong>Time-based Interpolation</strong>:</p>
<ul class="simple">
<li><p>Analogous to linear interpolation, but <span class="math notranslate nohighlight">\(i, j, k\)</span> represent timestamps, considering irregular intervals.</p></li>
</ul>
</li>
<li><p><strong>Rolling Mean Imputation</strong>:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\hat{y}_j = \frac{1}{w} \sum_{i=j-w}^{j-1} y_i\)</span>, where <span class="math notranslate nohighlight">\(w\)</span> is the window size.</p></li>
</ul>
</li>
<li><p><strong>Rolling Median Imputation</strong>:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\hat{y}_j = \text{median}(y_{j-w}, \dots, y_{j-1})\)</span>, where <span class="math notranslate nohighlight">\(w\)</span> is the window size.</p></li>
</ul>
</li>
<li><p><strong>Seasonal Decomposition and Imputation</strong>:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(y_t = T_t + S_t + R_t\)</span> (additive model). Missing values are imputed using the estimated trend (<span class="math notranslate nohighlight">\(T_t\)</span>) and seasonal (<span class="math notranslate nohighlight">\(S_t\)</span>) components at the time of the missing value.</p></li>
</ul>
</li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.tsa.seasonal</span><span class="w"> </span><span class="kn">import</span> <span class="n">seasonal_decompose</span>

<span class="c1"># 1. Create Sample Time Series with Missing Values</span>
<span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s1">&#39;2024-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>
                   <span class="mi">18</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>
                   <span class="mi">35</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">48</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">dates</span><span class="p">)</span>

<span class="c1"># 2. Implement Different Missing Data Handling Methods</span>
<span class="n">df_imputed</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;original&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">})</span>
<span class="n">df_imputed</span><span class="p">[</span><span class="s1">&#39;ffill&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">ffill</span><span class="p">()</span>
<span class="n">df_imputed</span><span class="p">[</span><span class="s1">&#39;bfill&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">bfill</span><span class="p">()</span>
<span class="n">df_imputed</span><span class="p">[</span><span class="s1">&#39;linear_interp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
<span class="n">df_imputed</span><span class="p">[</span><span class="s1">&#39;quadratic_interp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;polynomial&#39;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">df_imputed</span><span class="p">[</span><span class="s1">&#39;time_interp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">df_imputed</span><span class="p">[</span><span class="s1">&#39;rolling_mean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">min_periods</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">df_imputed</span><span class="p">[</span><span class="s1">&#39;rolling_median&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">min_periods</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">median</span><span class="p">()</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># Seasonal Decomposition and Imputation</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">decomposition</span> <span class="o">=</span> <span class="n">seasonal_decompose</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(),</span> <span class="n">model</span><span class="o">=</span><span class="s1">&#39;additive&#39;</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">extrapolate_trend</span><span class="o">=</span><span class="s1">&#39;freq&#39;</span><span class="p">)</span>
    <span class="n">seasonal_component</span> <span class="o">=</span> <span class="n">decomposition</span><span class="o">.</span><span class="n">seasonal</span>
    <span class="n">seasonal_imputed_values</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">seasonal_imputed_values</span><span class="p">[</span><span class="n">seasonal_imputed_values</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
        <span class="n">seasonal_imputed_values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">decomposition</span><span class="o">.</span><span class="n">seasonal</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">decomposition</span><span class="o">.</span><span class="n">trend</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">decomposition</span><span class="o">.</span><span class="n">resid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">df_imputed</span><span class="p">[</span><span class="s1">&#39;seasonal_imputed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">seasonal_imputed_values</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error during seasonal decomposition: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">df_imputed</span><span class="p">[</span><span class="s1">&#39;seasonal_imputed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>


<span class="c1"># 3. Plot the Results for Comparison</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_imputed</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df_imputed</span><span class="p">[</span><span class="s1">&#39;original&#39;</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original (with NaN)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Original Data&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_imputed</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df_imputed</span><span class="p">[</span><span class="s1">&#39;ffill&#39;</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Forward Fill&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Forward Fill&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_imputed</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df_imputed</span><span class="p">[</span><span class="s1">&#39;bfill&#39;</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Backward Fill&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Backward Fill&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_imputed</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df_imputed</span><span class="p">[</span><span class="s1">&#39;linear_interp&#39;</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Linear Interpolation&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Linear Interpolation&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_imputed</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df_imputed</span><span class="p">[</span><span class="s1">&#39;quadratic_interp&#39;</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Quadratic Interpolation&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Quadratic Interpolation&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_imputed</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df_imputed</span><span class="p">[</span><span class="s1">&#39;time_interp&#39;</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Time-based Interpolation&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Time-based Interpolation&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_imputed</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df_imputed</span><span class="p">[</span><span class="s1">&#39;rolling_mean&#39;</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Rolling Mean (Window=3)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Rolling Mean (Window=3)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_imputed</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df_imputed</span><span class="p">[</span><span class="s1">&#39;rolling_median&#39;</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Rolling Median (Window=3)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Rolling Median (Window=3)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_imputed</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df_imputed</span><span class="p">[</span><span class="s1">&#39;original&#39;</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original (with NaN)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_imputed</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df_imputed</span><span class="p">[</span><span class="s1">&#39;seasonal_imputed&#39;</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Seasonal Imputation&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Seasonal Imputation&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/02ec885f51c4ad71b705047e8d739d700379334b709cfd7ab45171c0e71dea97.png" src="_images/02ec885f51c4ad71b705047e8d739d700379334b709cfd7ab45171c0e71dea97.png" />
<img alt="_images/c575420074b51fbd7802a6a62b0d6042092ea79bbcee113d552ea6cba4db7ae2.png" src="_images/c575420074b51fbd7802a6a62b0d6042092ea79bbcee113d552ea6cba4db7ae2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_imputed</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>original</th>
      <th>ffill</th>
      <th>bfill</th>
      <th>linear_interp</th>
      <th>quadratic_interp</th>
      <th>time_interp</th>
      <th>rolling_mean</th>
      <th>rolling_median</th>
      <th>seasonal_imputed</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2024-01-01</th>
      <td>10.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>10.0</td>
      <td>10.000000</td>
      <td>10.0</td>
      <td>10.000000</td>
      <td>10.0</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>2024-01-02</th>
      <td>12.0</td>
      <td>12.0</td>
      <td>12.0</td>
      <td>12.0</td>
      <td>12.000000</td>
      <td>12.0</td>
      <td>11.000000</td>
      <td>11.0</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>2024-01-03</th>
      <td>NaN</td>
      <td>12.0</td>
      <td>15.0</td>
      <td>13.5</td>
      <td>14.371799</td>
      <td>13.5</td>
      <td>11.000000</td>
      <td>11.0</td>
      <td>13.5</td>
    </tr>
    <tr>
      <th>2024-01-04</th>
      <td>15.0</td>
      <td>15.0</td>
      <td>15.0</td>
      <td>15.0</td>
      <td>15.000000</td>
      <td>15.0</td>
      <td>13.500000</td>
      <td>13.5</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>2024-01-05</th>
      <td>13.0</td>
      <td>13.0</td>
      <td>13.0</td>
      <td>13.0</td>
      <td>13.000000</td>
      <td>13.0</td>
      <td>14.000000</td>
      <td>14.0</td>
      <td>13.0</td>
    </tr>
    <tr>
      <th>2024-01-06</th>
      <td>NaN</td>
      <td>13.0</td>
      <td>20.0</td>
      <td>16.5</td>
      <td>15.756569</td>
      <td>16.5</td>
      <td>14.000000</td>
      <td>14.0</td>
      <td>16.5</td>
    </tr>
    <tr>
      <th>2024-01-07</th>
      <td>20.0</td>
      <td>20.0</td>
      <td>20.0</td>
      <td>20.0</td>
      <td>20.000000</td>
      <td>20.0</td>
      <td>16.500000</td>
      <td>16.5</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>2024-01-08</th>
      <td>22.0</td>
      <td>22.0</td>
      <td>22.0</td>
      <td>22.0</td>
      <td>22.000000</td>
      <td>22.0</td>
      <td>21.000000</td>
      <td>21.0</td>
      <td>22.0</td>
    </tr>
    <tr>
      <th>2024-01-09</th>
      <td>25.0</td>
      <td>25.0</td>
      <td>25.0</td>
      <td>25.0</td>
      <td>25.000000</td>
      <td>25.0</td>
      <td>22.333333</td>
      <td>22.0</td>
      <td>25.0</td>
    </tr>
    <tr>
      <th>2024-01-10</th>
      <td>NaN</td>
      <td>25.0</td>
      <td>18.0</td>
      <td>21.5</td>
      <td>21.503347</td>
      <td>21.5</td>
      <td>23.500000</td>
      <td>23.5</td>
      <td>21.5</td>
    </tr>
    <tr>
      <th>2024-01-11</th>
      <td>18.0</td>
      <td>18.0</td>
      <td>18.0</td>
      <td>18.0</td>
      <td>18.000000</td>
      <td>18.0</td>
      <td>21.500000</td>
      <td>21.5</td>
      <td>18.0</td>
    </tr>
    <tr>
      <th>2024-01-12</th>
      <td>21.0</td>
      <td>21.0</td>
      <td>21.0</td>
      <td>21.0</td>
      <td>21.000000</td>
      <td>21.0</td>
      <td>19.500000</td>
      <td>19.5</td>
      <td>21.0</td>
    </tr>
    <tr>
      <th>2024-01-13</th>
      <td>23.0</td>
      <td>23.0</td>
      <td>23.0</td>
      <td>23.0</td>
      <td>23.000000</td>
      <td>23.0</td>
      <td>20.666667</td>
      <td>21.0</td>
      <td>23.0</td>
    </tr>
    <tr>
      <th>2024-01-14</th>
      <td>26.0</td>
      <td>26.0</td>
      <td>26.0</td>
      <td>26.0</td>
      <td>26.000000</td>
      <td>26.0</td>
      <td>23.333333</td>
      <td>23.0</td>
      <td>26.0</td>
    </tr>
    <tr>
      <th>2024-01-15</th>
      <td>NaN</td>
      <td>26.0</td>
      <td>29.0</td>
      <td>27.5</td>
      <td>27.640680</td>
      <td>27.5</td>
      <td>24.500000</td>
      <td>24.5</td>
      <td>27.5</td>
    </tr>
    <tr>
      <th>2024-01-16</th>
      <td>29.0</td>
      <td>29.0</td>
      <td>29.0</td>
      <td>29.0</td>
      <td>29.000000</td>
      <td>29.0</td>
      <td>27.500000</td>
      <td>27.5</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>2024-01-17</th>
      <td>31.0</td>
      <td>31.0</td>
      <td>31.0</td>
      <td>31.0</td>
      <td>31.000000</td>
      <td>31.0</td>
      <td>30.000000</td>
      <td>30.0</td>
      <td>31.0</td>
    </tr>
    <tr>
      <th>2024-01-18</th>
      <td>30.0</td>
      <td>30.0</td>
      <td>30.0</td>
      <td>30.0</td>
      <td>30.000000</td>
      <td>30.0</td>
      <td>30.000000</td>
      <td>30.0</td>
      <td>30.0</td>
    </tr>
    <tr>
      <th>2024-01-19</th>
      <td>28.0</td>
      <td>28.0</td>
      <td>28.0</td>
      <td>28.0</td>
      <td>28.000000</td>
      <td>28.0</td>
      <td>29.666667</td>
      <td>30.0</td>
      <td>28.0</td>
    </tr>
    <tr>
      <th>2024-01-20</th>
      <td>NaN</td>
      <td>28.0</td>
      <td>35.0</td>
      <td>31.5</td>
      <td>30.536134</td>
      <td>31.5</td>
      <td>29.000000</td>
      <td>29.0</td>
      <td>31.5</td>
    </tr>
    <tr>
      <th>2024-01-21</th>
      <td>35.0</td>
      <td>35.0</td>
      <td>35.0</td>
      <td>35.0</td>
      <td>35.000000</td>
      <td>35.0</td>
      <td>31.500000</td>
      <td>31.5</td>
      <td>35.0</td>
    </tr>
    <tr>
      <th>2024-01-22</th>
      <td>38.0</td>
      <td>38.0</td>
      <td>38.0</td>
      <td>38.0</td>
      <td>38.000000</td>
      <td>38.0</td>
      <td>36.500000</td>
      <td>36.5</td>
      <td>38.0</td>
    </tr>
    <tr>
      <th>2024-01-23</th>
      <td>40.0</td>
      <td>40.0</td>
      <td>40.0</td>
      <td>40.0</td>
      <td>40.000000</td>
      <td>40.0</td>
      <td>37.666667</td>
      <td>38.0</td>
      <td>40.0</td>
    </tr>
    <tr>
      <th>2024-01-24</th>
      <td>NaN</td>
      <td>40.0</td>
      <td>42.0</td>
      <td>41.0</td>
      <td>40.634635</td>
      <td>41.0</td>
      <td>39.000000</td>
      <td>39.0</td>
      <td>41.0</td>
    </tr>
    <tr>
      <th>2024-01-25</th>
      <td>42.0</td>
      <td>42.0</td>
      <td>42.0</td>
      <td>42.0</td>
      <td>42.000000</td>
      <td>42.0</td>
      <td>41.000000</td>
      <td>41.0</td>
      <td>42.0</td>
    </tr>
    <tr>
      <th>2024-01-26</th>
      <td>45.0</td>
      <td>45.0</td>
      <td>45.0</td>
      <td>45.0</td>
      <td>45.000000</td>
      <td>45.0</td>
      <td>43.500000</td>
      <td>43.5</td>
      <td>45.0</td>
    </tr>
    <tr>
      <th>2024-01-27</th>
      <td>43.0</td>
      <td>43.0</td>
      <td>43.0</td>
      <td>43.0</td>
      <td>43.000000</td>
      <td>43.0</td>
      <td>43.333333</td>
      <td>43.0</td>
      <td>43.0</td>
    </tr>
    <tr>
      <th>2024-01-28</th>
      <td>41.0</td>
      <td>41.0</td>
      <td>41.0</td>
      <td>41.0</td>
      <td>41.000000</td>
      <td>41.0</td>
      <td>43.000000</td>
      <td>43.0</td>
      <td>41.0</td>
    </tr>
    <tr>
      <th>2024-01-29</th>
      <td>NaN</td>
      <td>41.0</td>
      <td>48.0</td>
      <td>44.5</td>
      <td>42.524938</td>
      <td>44.5</td>
      <td>42.000000</td>
      <td>42.0</td>
      <td>44.5</td>
    </tr>
    <tr>
      <th>2024-01-30</th>
      <td>48.0</td>
      <td>48.0</td>
      <td>48.0</td>
      <td>48.0</td>
      <td>48.000000</td>
      <td>48.0</td>
      <td>44.500000</td>
      <td>44.5</td>
      <td>48.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<hr class="docutils" />
<section id="normalization-scaling">
<h4>2. Normalization &amp; Scaling<a class="headerlink" href="#normalization-scaling" title="Link to this heading">#</a></h4>
<hr class="docutils" />
<ul class="simple">
<li><p><strong>original</strong>: The original time series data.</p></li>
<li><p><strong>minmax</strong>: The data scaled using the <strong>Min-Max Scaler</strong>, which transforms values to a range between 0 and 1.</p>
<ul>
<li><p>Mathematically, for each value <span class="math notranslate nohighlight">\(x\)</span>, the scaled value <span class="math notranslate nohighlight">\(x'\)</span> is:
$<span class="math notranslate nohighlight">\(x' = \frac{x - \min(X)}{\max(X) - \min(X)}\)</span><span class="math notranslate nohighlight">\(
where \)</span>\min(X)<span class="math notranslate nohighlight">\( and \)</span>\max(X)<span class="math notranslate nohighlight">\( are the minimum and maximum values in the dataset \)</span>X$.</p></li>
</ul>
</li>
<li><p><strong>robust</strong>: The data scaled using the <strong>Robust Scaler</strong>, which is less sensitive to outliers. It scales the data based on the interquartile range (IQR).</p>
<ul>
<li><p>Mathematically, the scaled value <span class="math notranslate nohighlight">\(x'\)</span> is:
$<span class="math notranslate nohighlight">\(x' = \frac{x - \text{median}(X)}{\text{IQR}(X)}\)</span><span class="math notranslate nohighlight">\(
where \)</span>\text{IQR}(X) = Q_3(X) - Q_1(X)$ is the difference between the 75th and 25th percentiles.</p></li>
</ul>
</li>
<li><p><strong>standard</strong>: The data scaled using the <strong>StandardScaler</strong> (Z-score normalization), which centers the data around zero with a standard deviation of one.</p>
<ul>
<li><p>Mathematically, the scaled value <span class="math notranslate nohighlight">\(x'\)</span> is:
$<span class="math notranslate nohighlight">\(x' = \frac{x - \mu}{\sigma}\)</span><span class="math notranslate nohighlight">\(
where \)</span>\mu<span class="math notranslate nohighlight">\( is the mean of the data and \)</span>\sigma$ is the standard deviation.</p></li>
</ul>
</li>
<li><p><strong>maxabs</strong>: The data scaled using the <strong>MaxAbsScaler</strong>, which scales each value by the maximum absolute value in the dataset, resulting in a range of $$-1, 1].</p>
<ul>
<li><p>Mathematically, the scaled value <span class="math notranslate nohighlight">\(x'\)</span> is:
$<span class="math notranslate nohighlight">\(x' = \frac{x}{\max(|X|)}\)</span><span class="math notranslate nohighlight">\(
where \)</span>\max(|X|)<span class="math notranslate nohighlight">\( is the maximum of the absolute values in the dataset \)</span>X$.</p></li>
</ul>
</li>
<li><p><strong>power_yj</strong>: The data transformed using the <strong>Yeo-Johnson Power Transformer</strong>. This transformation aims to make the data more normally distributed and can handle both positive and negative values. The transformation is defined piecewise and involves a logarithmic or power transformation depending on the value and the estimated parameter <span class="math notranslate nohighlight">\(\lambda\)</span>.</p></li>
<li><p><strong>quantile_uniform</strong>: The data transformed using the <strong>Quantile Transformer</strong> with a uniform output distribution. This maps the data to the percentiles of a uniform distribution, resulting in values between 0 and 1. It can help to reduce the impact of outliers and non-linearities.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">MinMaxScaler</span><span class="p">,</span> <span class="n">RobustScaler</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">,</span> <span class="n">MaxAbsScaler</span><span class="p">,</span> <span class="n">PowerTransformer</span><span class="p">,</span> <span class="n">QuantileTransformer</span><span class="p">,</span> <span class="n">Normalizer</span>

<span class="c1"># Sample financial data (volatile with outliers and some trend)</span>
<span class="n">prices</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">118</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>
<span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">prices</span><span class="p">))</span>  <span class="c1"># Using a simple index for these scalers</span>

<span class="c1"># Create a DataFrame for comparison</span>
<span class="n">df_scaled</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;original&#39;</span><span class="p">:</span> <span class="n">prices</span><span class="o">.</span><span class="n">values</span><span class="p">})</span>

<span class="c1"># 1. Min-Max Scaling (range [0, 1])</span>
<span class="n">scaler_minmax</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">df_scaled</span><span class="p">[</span><span class="s1">&#39;minmax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scaler_minmax</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">prices</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="c1"># 2. Robust Scaling (resistant to outliers)</span>
<span class="n">scaler_robust</span> <span class="o">=</span> <span class="n">RobustScaler</span><span class="p">()</span>
<span class="n">df_scaled</span><span class="p">[</span><span class="s1">&#39;robust&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scaler_robust</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">prices</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="c1"># 3. StandardScaler (Z-score Normalization)</span>
<span class="n">scaler_standard</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">df_scaled</span><span class="p">[</span><span class="s1">&#39;standard&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scaler_standard</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">prices</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="c1"># 4. MaxAbsScaler (range [-1, 1])</span>
<span class="n">scaler_maxabs</span> <span class="o">=</span> <span class="n">MaxAbsScaler</span><span class="p">()</span>
<span class="n">df_scaled</span><span class="p">[</span><span class="s1">&#39;maxabs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scaler_maxabs</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">prices</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="c1"># 5. Power Transformer (Yeo-Johnson)</span>
<span class="n">power_transformer_yj</span> <span class="o">=</span> <span class="n">PowerTransformer</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;yeo-johnson&#39;</span><span class="p">)</span>
<span class="n">df_scaled</span><span class="p">[</span><span class="s1">&#39;power_yj&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">power_transformer_yj</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">prices</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="c1"># 6. Quantile Transformer (Uniform Output)</span>
<span class="n">quantile_transformer_uniform</span> <span class="o">=</span> <span class="n">QuantileTransformer</span><span class="p">(</span><span class="n">output_distribution</span><span class="o">=</span><span class="s1">&#39;uniform&#39;</span><span class="p">,</span> <span class="n">n_quantiles</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">prices</span><span class="p">))</span>
<span class="n">df_scaled</span><span class="p">[</span><span class="s1">&#39;quantile_uniform&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">quantile_transformer_uniform</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">prices</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>


<span class="c1"># Plotting the results</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">column</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">df_scaled</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_scaled</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df_scaled</span><span class="p">[</span><span class="n">column</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">column</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">column</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s1"> Scaling&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time Step&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Scaled Value&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4e036816e9c89bd0e2c8aeb53df5738b3c56e1adcbfc94de8b5c901489fd92a8.png" src="_images/4e036816e9c89bd0e2c8aeb53df5738b3c56e1adcbfc94de8b5c901489fd92a8.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_scaled</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>original</th>
      <th>minmax</th>
      <th>robust</th>
      <th>standard</th>
      <th>maxabs</th>
      <th>power_yj</th>
      <th>quantile_uniform</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>100</td>
      <td>0.019608</td>
      <td>-0.410959</td>
      <td>-0.671063</td>
      <td>0.500</td>
      <td>-1.015589</td>
      <td>0.153846</td>
    </tr>
    <tr>
      <th>1</th>
      <td>102</td>
      <td>0.039216</td>
      <td>-0.301370</td>
      <td>-0.596203</td>
      <td>0.510</td>
      <td>-0.758435</td>
      <td>0.307692</td>
    </tr>
    <tr>
      <th>2</th>
      <td>101</td>
      <td>0.029412</td>
      <td>-0.356164</td>
      <td>-0.633633</td>
      <td>0.505</td>
      <td>-0.883538</td>
      <td>0.230769</td>
    </tr>
    <tr>
      <th>3</th>
      <td>150</td>
      <td>0.509804</td>
      <td>2.328767</td>
      <td>1.200427</td>
      <td>0.750</td>
      <td>1.526262</td>
      <td>0.923077</td>
    </tr>
    <tr>
      <th>4</th>
      <td>99</td>
      <td>0.009804</td>
      <td>-0.465753</td>
      <td>-0.708493</td>
      <td>0.495</td>
      <td>-1.155050</td>
      <td>0.076923</td>
    </tr>
    <tr>
      <th>5</th>
      <td>105</td>
      <td>0.068627</td>
      <td>-0.136986</td>
      <td>-0.483914</td>
      <td>0.525</td>
      <td>-0.420687</td>
      <td>0.461538</td>
    </tr>
    <tr>
      <th>6</th>
      <td>200</td>
      <td>1.000000</td>
      <td>5.068493</td>
      <td>3.071918</td>
      <td>1.000</td>
      <td>1.884688</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>7</th>
      <td>98</td>
      <td>0.000000</td>
      <td>-0.520548</td>
      <td>-0.745923</td>
      <td>0.490</td>
      <td>-1.302415</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>8</th>
      <td>103</td>
      <td>0.049020</td>
      <td>-0.246575</td>
      <td>-0.558774</td>
      <td>0.515</td>
      <td>-0.639853</td>
      <td>0.384615</td>
    </tr>
    <tr>
      <th>9</th>
      <td>110</td>
      <td>0.117647</td>
      <td>0.136986</td>
      <td>-0.296765</td>
      <td>0.550</td>
      <td>0.037821</td>
      <td>0.538462</td>
    </tr>
    <tr>
      <th>10</th>
      <td>115</td>
      <td>0.166667</td>
      <td>0.410959</td>
      <td>-0.109616</td>
      <td>0.575</td>
      <td>0.395385</td>
      <td>0.615385</td>
    </tr>
    <tr>
      <th>11</th>
      <td>120</td>
      <td>0.215686</td>
      <td>0.684932</td>
      <td>0.077533</td>
      <td>0.600</td>
      <td>0.677243</td>
      <td>0.769231</td>
    </tr>
    <tr>
      <th>12</th>
      <td>118</td>
      <td>0.196078</td>
      <td>0.575342</td>
      <td>0.002674</td>
      <td>0.590</td>
      <td>0.572290</td>
      <td>0.692308</td>
    </tr>
    <tr>
      <th>13</th>
      <td>130</td>
      <td>0.313725</td>
      <td>1.232877</td>
      <td>0.451831</td>
      <td>0.650</td>
      <td>1.081871</td>
      <td>0.846154</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<hr class="docutils" />
<section id="outlier-detection-treatment">
<h5>3. Outlier Detection &amp; Treatment<a class="headerlink" href="#outlier-detection-treatment" title="Link to this heading">#</a></h5>
<hr class="docutils" />
<ul class="simple">
<li><p><strong>original</strong>: The original time series data.</p></li>
<li><p><strong>cleaned_iqr_median_rolling</strong>: The time series after treating outliers (detected using the IQR method) by replacing them with the median of a rolling window.</p>
<ul>
<li><p><strong>IQR Outlier Detection</strong>: An observation <span class="math notranslate nohighlight">\(y_t\)</span> is considered an outlier if:
$<span class="math notranslate nohighlight">\(y_t &lt; Q_1 - 1.5 \times IQR \quad \text{or} \quad y_t &gt; Q_3 + 1.5 \times IQR\)</span><span class="math notranslate nohighlight">\(
where \)</span>Q_1<span class="math notranslate nohighlight">\( is the first quartile and \)</span>Q_3<span class="math notranslate nohighlight">\( is the third quartile, and \)</span>IQR = Q_3 - Q_1$.</p></li>
<li><p><strong>Median Rolling Treatment</strong>: For each detected outlier at index <span class="math notranslate nohighlight">\(i\)</span>, the treated value <span class="math notranslate nohighlight">\(\hat{y}_i\)</span> is:
$<span class="math notranslate nohighlight">\(\hat{y}_i = \text{median}(y_{i-w/2}, \dots, y_{i}, \dots, y_{i+w/2})\)</span><span class="math notranslate nohighlight">\(
where \)</span>w<span class="math notranslate nohighlight">\( is the window size (here, \)</span>w=5$), and the median is calculated over the valid observations within that window.</p></li>
</ul>
</li>
<li><p><strong>cleaned_zscore_median_rolling</strong>: The time series after treating outliers (detected using the Z-score method) by replacing them with the median of a rolling window.</p>
<ul>
<li><p><strong>Z-score Outlier Detection</strong>: An observation <span class="math notranslate nohighlight">\(y_t\)</span> is considered an outlier if:
$<span class="math notranslate nohighlight">\(|y_t - \mu| &gt; z \times \sigma\)</span><span class="math notranslate nohighlight">\(
where \)</span>\mu<span class="math notranslate nohighlight">\( is the mean of the time series, \)</span>\sigma<span class="math notranslate nohighlight">\( is the standard deviation, and \)</span>z<span class="math notranslate nohighlight">\( is a chosen threshold (here, \)</span>z=3$).</p></li>
<li><p><strong>Median Rolling Treatment</strong>: (Same as above)</p></li>
</ul>
</li>
<li><p><strong>cleaned_es_median_rolling</strong>: The time series after treating outliers (detected using the Exponential Smoothing deviation method) by replacing them with the median of a rolling window.</p>
<ul>
<li><p><strong>Exponential Smoothing Deviation Outlier Detection</strong>: Let <span class="math notranslate nohighlight">\(S_t\)</span> be the exponentially smoothed value. An observation <span class="math notranslate nohighlight">\(y_t\)</span> is an outlier if:
$<span class="math notranslate nohighlight">\(|y_t - S_t| &gt; k \times \sigma_{\text{residuals}}\)</span><span class="math notranslate nohighlight">\(
where \)</span>k<span class="math notranslate nohighlight">\( is a threshold (here, \)</span>k=2<span class="math notranslate nohighlight">\() and \)</span>\sigma_{\text{residuals}}$ is the standard deviation of the residuals.</p></li>
<li><p><strong>Median Rolling Treatment</strong>: (Same as above)</p></li>
</ul>
</li>
<li><p><strong>winsorized</strong>: The time series after applying Winsorization, where extreme values below the 5th percentile and above the 95th percentile are capped and floored respectively.</p>
<ul>
<li><p>Let <span class="math notranslate nohighlight">\(P_{lower}\)</span> be the value at the lower percentile (e.g., 5th) and <span class="math notranslate nohighlight">\(P_{upper}\)</span> be the value at the upper percentile (e.g., 95th). The winsorized value <span class="math notranslate nohighlight">\(\hat{y}_t\)</span> is:
$<span class="math notranslate nohighlight">\(\hat{y}_t = \begin{cases}
P_{lower} &amp; \text{if } y_t &lt; P_{lower} \\
y_t &amp; \text{if } P_{lower} \le y_t \le P_{upper} \\
P_{upper} &amp; \text{if } y_t &gt; P_{upper}
\end{cases}\)</span>$</p></li>
</ul>
</li>
<li><p><strong>interpolated_linear_iqr</strong>: The time series after treating outliers (detected using the IQR method) by replacing them with NaN and then performing linear interpolation.</p>
<ul>
<li><p><strong>IQR Outlier Detection</strong>: (Same as above)</p></li>
<li><p><strong>Linear Interpolation Treatment</strong>: For a replaced outlier at time <span class="math notranslate nohighlight">\(j\)</span> between two valid points <span class="math notranslate nohighlight">\(y_i\)</span> and <span class="math notranslate nohighlight">\(y_k\)</span> (<span class="math notranslate nohighlight">\(i &lt; j &lt; k\)</span>), the interpolated value <span class="math notranslate nohighlight">\(\hat{y}_j\)</span> is:
$<span class="math notranslate nohighlight">\(\hat{y}_j = y_i + (y_k - y_i) \times \frac{j - i}{k - i}\)</span>$</p></li>
</ul>
</li>
</ul>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.tsa.seasonal</span><span class="w"> </span><span class="kn">import</span> <span class="n">seasonal_decompose</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.tsa.holtwinters</span><span class="w"> </span><span class="kn">import</span> <span class="n">SimpleExpSmoothing</span>

<span class="c1"># 1. Create realistic time series data</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2023-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
<span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">values</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span> <span class="o">=</span> <span class="mi">150</span>
<span class="n">values</span><span class="p">[</span><span class="mi">30</span><span class="p">:</span><span class="mi">33</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">205</span><span class="p">,</span> <span class="mi">190</span><span class="p">]</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">dates</span><span class="p">)</span>


<span class="c1"># 2. Outlier Detection Functions (for reference in treatment)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">detect_outliers_iqr</span><span class="p">(</span><span class="n">series</span><span class="p">):</span>
    <span class="n">Q1</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
    <span class="n">Q3</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.75</span><span class="p">)</span>
    <span class="n">IQR</span> <span class="o">=</span> <span class="n">Q3</span> <span class="o">-</span> <span class="n">Q1</span>
    <span class="k">return</span> <span class="n">series</span><span class="p">[(</span><span class="n">series</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">Q1</span> <span class="o">-</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">IQR</span><span class="p">))</span> <span class="o">|</span> <span class="p">(</span><span class="n">series</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">Q3</span> <span class="o">+</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">IQR</span><span class="p">))]</span>

<span class="k">def</span><span class="w"> </span><span class="nf">detect_outliers_zscore</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">z_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">series</span> <span class="o">-</span> <span class="n">series</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">/</span> <span class="n">series</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">series</span><span class="p">[</span><span class="n">z_scores</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">]</span>

<span class="k">def</span><span class="w"> </span><span class="nf">detect_outliers_exponential_smoothing</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">std_multiplier</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">SimpleExpSmoothing</span><span class="p">(</span><span class="n">series</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">smoothing_level</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">optimized</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">smoothed</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fittedvalues</span>
    <span class="n">residuals</span> <span class="o">=</span> <span class="n">series</span> <span class="o">-</span> <span class="n">smoothed</span>
    <span class="n">std_dev</span> <span class="o">=</span> <span class="n">residuals</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
    <span class="n">upper_bound</span> <span class="o">=</span> <span class="n">smoothed</span> <span class="o">+</span> <span class="p">(</span><span class="n">std_multiplier</span> <span class="o">*</span> <span class="n">std_dev</span><span class="p">)</span>
    <span class="n">lower_bound</span> <span class="o">=</span> <span class="n">smoothed</span> <span class="o">-</span> <span class="p">(</span><span class="n">std_multiplier</span> <span class="o">*</span> <span class="n">std_dev</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">series</span><span class="p">[(</span><span class="n">series</span> <span class="o">&gt;</span> <span class="n">upper_bound</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">series</span> <span class="o">&lt;</span> <span class="n">lower_bound</span><span class="p">)]</span>

<span class="c1"># 3. Outlier Treatment Functions</span>
<span class="k">def</span><span class="w"> </span><span class="nf">treat_outliers_median_rolling_iqr</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">cleaned</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">outlier_indices</span> <span class="o">=</span> <span class="n">detect_outliers_iqr</span><span class="p">(</span><span class="n">series</span><span class="p">)</span><span class="o">.</span><span class="n">index</span>
    <span class="n">cleaned</span><span class="p">[</span><span class="n">outlier_indices</span><span class="p">]</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span>
        <span class="n">window</span><span class="p">,</span> <span class="n">min_periods</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span><span class="o">.</span><span class="n">median</span><span class="p">()[</span><span class="n">outlier_indices</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">cleaned</span>

<span class="k">def</span><span class="w"> </span><span class="nf">treat_outliers_winsorize</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">lower_percentile</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">upper_percentile</span><span class="o">=</span><span class="mi">95</span><span class="p">):</span>
    <span class="n">lower_bound</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">lower_percentile</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">upper_bound</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">upper_percentile</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">cleaned</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">cleaned</span><span class="p">[</span><span class="n">series</span> <span class="o">&lt;</span> <span class="n">lower_bound</span><span class="p">]</span> <span class="o">=</span> <span class="n">lower_bound</span>
    <span class="n">cleaned</span><span class="p">[</span><span class="n">series</span> <span class="o">&gt;</span> <span class="n">upper_bound</span><span class="p">]</span> <span class="o">=</span> <span class="n">upper_bound</span>
    <span class="k">return</span> <span class="n">cleaned</span>

<span class="k">def</span><span class="w"> </span><span class="nf">treat_outliers_interpolate_iqr</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">):</span>
    <span class="n">cleaned</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">outlier_indices</span> <span class="o">=</span> <span class="n">detect_outliers_iqr</span><span class="p">(</span><span class="n">series</span><span class="p">)</span><span class="o">.</span><span class="n">index</span>
    <span class="n">cleaned</span><span class="p">[</span><span class="n">outlier_indices</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="n">cleaned</span> <span class="o">=</span> <span class="n">cleaned</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cleaned</span>

<span class="k">def</span><span class="w"> </span><span class="nf">treat_outliers_median_rolling_zscore</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">cleaned</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">outlier_indices</span> <span class="o">=</span> <span class="n">detect_outliers_zscore</span><span class="p">(</span><span class="n">series</span><span class="p">)</span><span class="o">.</span><span class="n">index</span>
    <span class="n">cleaned</span><span class="p">[</span><span class="n">outlier_indices</span><span class="p">]</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span>
        <span class="n">window</span><span class="p">,</span> <span class="n">min_periods</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span><span class="o">.</span><span class="n">median</span><span class="p">()[</span><span class="n">outlier_indices</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">cleaned</span>

<span class="k">def</span><span class="w"> </span><span class="nf">treat_outliers_median_rolling_es</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">cleaned</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">outlier_indices</span> <span class="o">=</span> <span class="n">detect_outliers_exponential_smoothing</span><span class="p">(</span><span class="n">series</span><span class="p">)</span><span class="o">.</span><span class="n">index</span>
    <span class="n">cleaned</span><span class="p">[</span><span class="n">outlier_indices</span><span class="p">]</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span>
        <span class="n">window</span><span class="p">,</span> <span class="n">min_periods</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span><span class="o">.</span><span class="n">median</span><span class="p">()[</span><span class="n">outlier_indices</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">cleaned</span>

<span class="c1"># 4. Apply Treatment and Create DataFrame</span>
<span class="n">df_treated</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;original&#39;</span><span class="p">:</span> <span class="n">ts</span><span class="p">})</span>
<span class="n">df_treated</span><span class="p">[</span><span class="s1">&#39;cleaned_iqr_median_rolling&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">treat_outliers_median_rolling_iqr</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>
<span class="n">df_treated</span><span class="p">[</span><span class="s1">&#39;cleaned_zscore_median_rolling&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">treat_outliers_median_rolling_zscore</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>
<span class="n">df_treated</span><span class="p">[</span><span class="s1">&#39;cleaned_es_median_rolling&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">treat_outliers_median_rolling_es</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>
<span class="n">df_treated</span><span class="p">[</span><span class="s1">&#39;winsorized&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">treat_outliers_winsorize</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>
<span class="n">df_treated</span><span class="p">[</span><span class="s1">&#39;interpolated_linear_iqr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">treat_outliers_interpolate_iqr</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">DataFrame with Original and Treated Values:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_treated</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="c1"># 5. Visual Verification</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_treated</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df_treated</span><span class="p">[</span><span class="s1">&#39;original&#39;</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_treated</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df_treated</span><span class="p">[</span><span class="s1">&#39;cleaned_iqr_median_rolling&#39;</span><span class="p">],</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Cleaned (IQR - Median Rolling)&#39;</span><span class="p">)</span>
<span class="n">outliers_iqr</span> <span class="o">=</span> <span class="n">detect_outliers_iqr</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">outliers_iqr</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">outliers_iqr</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Outliers (IQR)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Outlier Treatment with IQR - Median Rolling&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_treated</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df_treated</span><span class="p">[</span><span class="s1">&#39;original&#39;</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_treated</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df_treated</span><span class="p">[</span><span class="s1">&#39;cleaned_zscore_median_rolling&#39;</span><span class="p">],</span> <span class="s1">&#39;g--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Cleaned (Z-score - Median Rolling)&#39;</span><span class="p">)</span>
<span class="n">outliers_zscore</span> <span class="o">=</span> <span class="n">detect_outliers_zscore</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">outliers_zscore</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">outliers_zscore</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Outliers (Z-score)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Outlier Treatment with Z-score - Median Rolling&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_treated</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df_treated</span><span class="p">[</span><span class="s1">&#39;original&#39;</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_treated</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df_treated</span><span class="p">[</span><span class="s1">&#39;cleaned_es_median_rolling&#39;</span><span class="p">],</span> <span class="s1">&#39;c--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Cleaned (Exp. Smooth - Median Rolling)&#39;</span><span class="p">)</span>
<span class="n">outliers_es</span> <span class="o">=</span> <span class="n">detect_outliers_exponential_smoothing</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">outliers_es</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">outliers_es</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Outliers (Exp. Smooth)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Outlier Treatment with Exponential Smoothing - Median Rolling&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_treated</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df_treated</span><span class="p">[</span><span class="s1">&#39;original&#39;</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_treated</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df_treated</span><span class="p">[</span><span class="s1">&#39;winsorized&#39;</span><span class="p">],</span> <span class="s1">&#39;y--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Winsorized&#39;</span><span class="p">)</span>
<span class="n">winsorized_outlier_indices</span> <span class="o">=</span> <span class="n">ts</span><span class="p">[</span><span class="n">ts</span> <span class="o">&lt;</span> <span class="n">ts</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">ts</span><span class="p">[</span><span class="n">ts</span> <span class="o">&gt;</span> <span class="n">ts</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.95</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">winsorized_outlier_indices</span><span class="p">,</span> <span class="n">ts</span><span class="p">[</span><span class="n">winsorized_outlier_indices</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Winsorized Points&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Outlier Treatment with Winsorization&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_treated</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df_treated</span><span class="p">[</span><span class="s1">&#39;original&#39;</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_treated</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df_treated</span><span class="p">[</span><span class="s1">&#39;interpolated_linear_iqr&#39;</span><span class="p">],</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Interpolated (Linear - IQR)&#39;</span><span class="p">)</span>
<span class="n">outliers_iqr</span> <span class="o">=</span> <span class="n">detect_outliers_iqr</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">outliers_iqr</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">ts</span><span class="p">[</span><span class="n">outliers_iqr</span><span class="o">.</span><span class="n">index</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Outliers (for Interp)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Outlier Treatment with Linear Interpolation (IQR)&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DataFrame with Original and Treated Values:
            original  cleaned_iqr_median_rolling  \
2023-01-01      52.5                        52.5   
2023-01-02      49.3                        49.3   
2023-01-03      53.2                        53.2   
2023-01-04      57.6                        57.6   
2023-01-05      48.8                        48.8   

            cleaned_zscore_median_rolling  cleaned_es_median_rolling  \
2023-01-01                           52.5                       52.5   
2023-01-02                           49.3                       49.3   
2023-01-03                           53.2                       53.2   
2023-01-04                           57.6                       57.6   
2023-01-05                           48.8                       48.8   

            winsorized  interpolated_linear_iqr  
2023-01-01        52.5                     52.5  
2023-01-02        49.3                     49.3  
2023-01-03        53.2                     53.2  
2023-01-04        57.6                     57.6  
2023-01-05        48.8                     48.8  
</pre></div>
</div>
<img alt="_images/aed1abb80afaca973c1f753a3671243c10d05e80b81ebb77d7f8d6508ff4ba8c.png" src="_images/aed1abb80afaca973c1f753a3671243c10d05e80b81ebb77d7f8d6508ff4ba8c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_treated</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>original</th>
      <th>cleaned_iqr_median_rolling</th>
      <th>cleaned_zscore_median_rolling</th>
      <th>cleaned_es_median_rolling</th>
      <th>winsorized</th>
      <th>interpolated_linear_iqr</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2023-01-01</th>
      <td>52.5</td>
      <td>52.5</td>
      <td>52.5</td>
      <td>52.5</td>
      <td>52.5</td>
      <td>52.5</td>
    </tr>
    <tr>
      <th>2023-01-02</th>
      <td>49.3</td>
      <td>49.3</td>
      <td>49.3</td>
      <td>49.3</td>
      <td>49.3</td>
      <td>49.3</td>
    </tr>
    <tr>
      <th>2023-01-03</th>
      <td>53.2</td>
      <td>53.2</td>
      <td>53.2</td>
      <td>53.2</td>
      <td>53.2</td>
      <td>53.2</td>
    </tr>
    <tr>
      <th>2023-01-04</th>
      <td>57.6</td>
      <td>57.6</td>
      <td>57.6</td>
      <td>57.6</td>
      <td>57.6</td>
      <td>57.6</td>
    </tr>
    <tr>
      <th>2023-01-05</th>
      <td>48.8</td>
      <td>48.8</td>
      <td>48.8</td>
      <td>48.8</td>
      <td>48.8</td>
      <td>48.8</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2023-04-06</th>
      <td>42.7</td>
      <td>42.7</td>
      <td>42.7</td>
      <td>42.7</td>
      <td>42.7</td>
      <td>42.7</td>
    </tr>
    <tr>
      <th>2023-04-07</th>
      <td>51.5</td>
      <td>51.5</td>
      <td>51.5</td>
      <td>51.5</td>
      <td>51.5</td>
      <td>51.5</td>
    </tr>
    <tr>
      <th>2023-04-08</th>
      <td>51.3</td>
      <td>51.3</td>
      <td>51.3</td>
      <td>51.3</td>
      <td>51.3</td>
      <td>51.3</td>
    </tr>
    <tr>
      <th>2023-04-09</th>
      <td>50.0</td>
      <td>50.0</td>
      <td>50.0</td>
      <td>50.0</td>
      <td>50.0</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>2023-04-10</th>
      <td>48.8</td>
      <td>48.8</td>
      <td>48.8</td>
      <td>48.8</td>
      <td>48.8</td>
      <td>48.8</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 6 columns</p>
</div></div></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="feature-engineering-for-time-series">
<h4>4. Feature Engineering for Time Series<a class="headerlink" href="#feature-engineering-for-time-series" title="Link to this heading">#</a></h4>
<hr class="docutils" />
<p>Time series data exhibit temporal dependencies, trends, and sometimes seasonality. Effective preprocessing helps models learn these patterns. Below are key feature engineering techniques:</p>
<ol class="arabic simple">
<li><p>Lags (Autoregression)</p></li>
</ol>
<p>Lag features use past values of the target variable to capture autoregressive behavior.</p>
<div class="math notranslate nohighlight">
\[
\text{lag}_k(t) = y(t - k)
\]</div>
<p>For example:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">lag_1</span></code> captures the value at time $t-1$</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lag_2</span></code> captures the value at time $t-2$</p></li>
</ul>
<p>These are helpful for models like ARIMA or any regression-based forecasting.</p>
<ol class="arabic simple" start="2">
<li><p>Rolling Windows (Moving Statistics)</p></li>
</ol>
<p>Rolling windows smooth the data and extract local trends or volatility. Two common statistics:</p>
<ul>
<li><p><strong>Rolling Mean</strong>:</p>
<div class="math notranslate nohighlight">
\[
  \text{roll\_mean}_w(t) = \frac{1}{w} \sum_{i=0}^{w-1} y(t - i)
  \]</div>
</li>
<li><p><strong>Rolling Standard Deviation</strong>:</p>
<div class="math notranslate nohighlight">
\[
  \text{roll\_std}_w(t) = \sqrt{\frac{1}{w} \sum_{i=0}^{w-1} (y(t - i) - \text{roll\_mean}_w(t))^2}
  \]</div>
</li>
</ul>
<p>This helps detect moving averages and changes in volatility.</p>
<ol class="arabic simple" start="3">
<li><p>Differencing (Stationarity)</p></li>
</ol>
<p>Differencing removes trends and stabilizes the mean of a time series. It is especially useful before applying ARIMA:</p>
<ul>
<li><p><strong>First-order differencing</strong>:</p>
<div class="math notranslate nohighlight">
\[
  \text{diff}_1(t) = y(t) - y(t - 1)
  \]</div>
</li>
</ul>
<p>This transformation makes non-stationary time series more stationary by removing linear trends.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Simulate time series data</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">date_range</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s1">&#39;2020-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span> <span class="o">+</span> <span class="mi">10</span>
<span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="n">date_range</span><span class="p">)</span>

<span class="c1"># --- Debugging Tip: Check for missing values before processing</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Initial Missing Values:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>

<span class="c1"># --- Lags: Capture autoregressive patterns</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;lag_1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;lag_2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># --- Rolling Windows: Smooth noise and extract trends/volatility</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;roll_mean_7&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;roll_std_7&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

<span class="c1"># --- Differencing: Remove trend and stabilize the mean</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;diff_1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>

<span class="c1"># --- Debugging Tip: Check for new NaNs after feature engineering</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Missing Values After Transformations:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>

<span class="c1"># --- Visualization: Plot transformations</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="c1"># 1. Lags</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">data</span><span class="p">[[</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;lag_1&#39;</span><span class="p">,</span> <span class="s1">&#39;lag_2&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">(),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Original and Lag Features&#39;</span><span class="p">)</span>

<span class="c1"># 2. Rolling Mean</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">data</span><span class="p">[[</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;roll_mean_7&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">(),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;7-Day Rolling Mean&#39;</span><span class="p">)</span>

<span class="c1"># 3. Rolling Std Dev (compared to value)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">data</span><span class="p">[[</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;roll_std_7&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">(),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;7-Day Rolling Standard Deviation&#39;</span><span class="p">)</span>

<span class="c1"># 4. Differencing (compared to value)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">data</span><span class="p">[[</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;diff_1&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">(),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;First-order Differencing&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initial Missing Values:
 value    0
dtype: int64

Missing Values After Transformations:
 value          0
lag_1          1
lag_2          2
roll_mean_7    6
roll_std_7     6
diff_1         1
dtype: int64
</pre></div>
</div>
<img alt="_images/d21ee46df700b9001df43d99d2679cc0c3ea304a9d798069fba5317ffa6e2be5.png" src="_images/d21ee46df700b9001df43d99d2679cc0c3ea304a9d798069fba5317ffa6e2be5.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># --- Simulate time series with trend, seasonality, and noise</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">date_range</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s1">&#39;2020-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>

<span class="n">trend</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>                            <span class="c1"># Linear trend</span>
<span class="n">seasonality</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">date_range</span><span class="o">.</span><span class="n">dayofyear</span> <span class="o">/</span> <span class="mi">30</span><span class="p">)</span>  <span class="c1"># Monthly seasonality</span>
<span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>                 <span class="c1"># Small Gaussian noise</span>

<span class="n">values</span> <span class="o">=</span> <span class="n">trend</span> <span class="o">+</span> <span class="n">seasonality</span> <span class="o">+</span> <span class="n">noise</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">values</span><span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="n">date_range</span><span class="p">)</span>

<span class="c1"># --- Debugging Tip: Check for missing values before processing</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Initial Missing Values:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>

<span class="c1"># --- Feature Engineering</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;lag_1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;lag_2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="n">data</span><span class="p">[</span><span class="s1">&#39;roll_mean_7&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;roll_std_7&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

<span class="n">data</span><span class="p">[</span><span class="s1">&#39;diff_1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>

<span class="c1"># --- Debugging Tip: Check for missing values after transformations</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Missing Values After Transformations:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>

<span class="c1"># --- Visualization</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="c1"># 1. Lags</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">data</span><span class="p">[[</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;lag_1&#39;</span><span class="p">,</span> <span class="s1">&#39;lag_2&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">(),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Original and Lag Features&#39;</span><span class="p">)</span>

<span class="c1"># 2. Rolling Mean</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">data</span><span class="p">[[</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;roll_mean_7&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">(),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;7-Day Rolling Mean&#39;</span><span class="p">)</span>

<span class="c1"># 3. Rolling Std Dev</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">data</span><span class="p">[[</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;roll_std_7&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">(),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;7-Day Rolling Standard Deviation&#39;</span><span class="p">)</span>

<span class="c1"># 4. Differencing</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">data</span><span class="p">[[</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;diff_1&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">(),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;First-order Differencing&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># --- Final null summary</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Final Missing Values Summary:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initial Missing Values:
 value    0
dtype: int64

Missing Values After Transformations:
 value          0
lag_1          1
lag_2          2
roll_mean_7    6
roll_std_7     6
diff_1         1
dtype: int64
</pre></div>
</div>
<img alt="_images/7e8743e8a08d7759fa3a3cb7255db8ae0be1a93ba5e265a65806fe81d791a446.png" src="_images/7e8743e8a08d7759fa3a3cb7255db8ae0be1a93ba5e265a65806fe81d791a446.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final Missing Values Summary:
 value          0
lag_1          1
lag_2          2
roll_mean_7    6
roll_std_7     6
diff_1         1
dtype: int64
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="modifying-data-using-excel">
<h4>5. Modifying Data Using Excel<a class="headerlink" href="#modifying-data-using-excel" title="Link to this heading">#</a></h4>
<hr class="docutils" />
<ul class="simple">
<li><p><strong>Description</strong>: Using Excel functions, formulas, and tools to manipulate data.</p></li>
<li><p><strong>Relevance</strong>: Excel is a widely used tool for financial data analysis and forecasting.</p></li>
<li><p><strong>Related Concepts</strong>:</p>
<ul>
<li><p><strong>Excel Functions</strong>: <code class="docutils literal notranslate"><span class="pre">AVERAGE</span></code>, <code class="docutils literal notranslate"><span class="pre">STDEV</span></code>, <code class="docutils literal notranslate"><span class="pre">VLOOKUP</span></code>, <code class="docutils literal notranslate"><span class="pre">IF</span></code>.</p></li>
<li><p><strong>Pivot Tables</strong>: Aggregating data for summaries.</p></li>
<li><p><strong>Charts</strong>: Visualizing trends or distributions.</p></li>
</ul>
</li>
<li><p><strong>Example</strong>: Calculating monthly sales averages or creating a line chart of stock prices.</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="using-range-names-in-databases">
<h4>6. Using Range Names in Databases<a class="headerlink" href="#using-range-names-in-databases" title="Link to this heading">#</a></h4>
</section>
</section>
<hr class="docutils" />
<section id="excel-name-manager">
<h3>Excel Name Manager<a class="headerlink" href="#excel-name-manager" title="Link to this heading">#</a></h3>
<p>The <strong>Name Manager</strong> in Excel is a built-in feature (accessed via <em>Formulas &gt; Name Manager</em>) that allows users to:</p>
<ul class="simple">
<li><p><strong>Create Named Ranges</strong>: Select a range (e.g., <code class="docutils literal notranslate"><span class="pre">A1:A12</span></code>) and assign a name like <code class="docutils literal notranslate"><span class="pre">MonthlySales</span></code>.</p></li>
<li><p><strong>Edit Names</strong>: Modify the range or name as the model evolves.</p></li>
<li><p><strong>Scope Names</strong>: Define whether a name applies to the entire workbook or a specific worksheet.</p></li>
<li><p><strong>Use in Formulas</strong>: Reference named ranges in formulas, such as <code class="docutils literal notranslate"><span class="pre">$AVERAGE(MonthlySales)$</span></code> or <code class="docutils literal notranslate"><span class="pre">$VLOOKUP(TargetMonth,</span> <span class="pre">SalesTable,</span> <span class="pre">2,</span> <span class="pre">FALSE)$</span></code>.</p></li>
</ul>
<p>For example, if <code class="docutils literal notranslate"><span class="pre">MonthlySales</span></code> refers to <code class="docutils literal notranslate"><span class="pre">A1:A12</span></code>, the formula <code class="docutils literal notranslate"><span class="pre">$SUM(MonthlySales)$</span></code> computes the total of that range, and Excel automatically updates the formula if the range is modified (e.g., adding a new month).</p>
</section>
<section id="database-fields-and-naming-conventions-in-sql">
<h3>Database Fields and Naming Conventions in SQL<a class="headerlink" href="#database-fields-and-naming-conventions-in-sql" title="Link to this heading">#</a></h3>
<p>In relational databases, fields (columns) and tables are given meaningful names to improve query readability and maintainability. For instance, a table might be named <code class="docutils literal notranslate"><span class="pre">Sales_Records</span></code> with fields like <code class="docutils literal notranslate"><span class="pre">Transaction_Date</span></code>, <code class="docutils literal notranslate"><span class="pre">Sales_Amount</span></code>, and <code class="docutils literal notranslate"><span class="pre">Customer_ID</span></code>. SQL queries can then use these names, such as:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">Sales_Amount</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">TotalSales</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">Sales_Records</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">Transaction_Date</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="s1">&#39;2025-01-01&#39;</span><span class="p">;</span>
</pre></div>
</div>
<p><strong>Naming Conventions</strong> in SQL often follow rules like:</p>
<ul class="simple">
<li><p>Use descriptive, singular nouns for tables (e.g., <code class="docutils literal notranslate"><span class="pre">Customer</span></code> instead of <code class="docutils literal notranslate"><span class="pre">Customers</span></code>).</p></li>
<li><p>Use underscores for multi-word names (e.g., <code class="docutils literal notranslate"><span class="pre">Sales_Amount</span></code>).</p></li>
<li><p>Avoid reserved SQL keywords (e.g., <code class="docutils literal notranslate"><span class="pre">SELECT</span></code>, <code class="docutils literal notranslate"><span class="pre">FROM</span></code>).</p></li>
<li><p>Prefix or suffix fields to indicate their role (e.g., <code class="docutils literal notranslate"><span class="pre">ID_Customer</span></code> for a primary key).</p></li>
</ul>
<p>These conventions mirror the logic of range names in Excel, ensuring that database operations are intuitive and less prone to errors.</p>
</section>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Link to this heading">#</a></h2>
<section id="example-1-excel-named-range-for-financial-calculations">
<h3>Example 1: Excel Named Range for Financial Calculations<a class="headerlink" href="#example-1-excel-named-range-for-financial-calculations" title="Link to this heading">#</a></h3>
<p>Suppose you have a financial model in Excel with monthly sales data in cells <code class="docutils literal notranslate"><span class="pre">B2:B13</span></code> (January to December 2025). Instead of referencing <code class="docutils literal notranslate"><span class="pre">B2:B13</span></code> in formulas, you can name the range <code class="docutils literal notranslate"><span class="pre">MonthlySales</span></code>.</p>
<p><strong>Steps to Create a Named Range</strong>:</p>
<ol class="arabic simple">
<li><p>Select cells <code class="docutils literal notranslate"><span class="pre">B2:B13</span></code>.</p></li>
<li><p>Go to <em>Formulas &gt; Define Name</em> in Excel.</p></li>
<li><p>Enter <code class="docutils literal notranslate"><span class="pre">MonthlySales</span></code> as the name and ensure the scope is set to the workbook.</p></li>
<li><p>Click <em>OK</em>.</p></li>
</ol>
<p>Now, you can use <code class="docutils literal notranslate"><span class="pre">MonthlySales</span></code> in formulas. For instance:</p>
<ul class="simple">
<li><p>Total sales: <code class="docutils literal notranslate"><span class="pre">$SUM(MonthlySales)$</span></code></p></li>
<li><p>Average sales: <code class="docutils literal notranslate"><span class="pre">$AVERAGE(MonthlySales)$</span></code></p></li>
<li><p>Maximum sales: <code class="docutils literal notranslate"><span class="pre">$MAX(MonthlySales)$</span></code></p></li>
</ul>
<p>If you add a new month (e.g., extending the range to <code class="docutils literal notranslate"><span class="pre">B2:B14</span></code>), you can update the named range in the Name Manager, and all formulas using <code class="docutils literal notranslate"><span class="pre">MonthlySales</span></code> will automatically reflect the change.</p>
<p><strong>Mathematical Representation</strong>:
Let the sales data be a vector <span class="math notranslate nohighlight">\(\mathbf{S} = [s_1, s_2, \dots, s_{12}]\)</span>, where <span class="math notranslate nohighlight">\(s_i\)</span> is the sales amount for month <span class="math notranslate nohighlight">\(i\)</span>. The total sales can be expressed as:
$<span class="math notranslate nohighlight">\(
\text{TotalSales} = \sum_{i=1}^{12} s_i
\)</span><span class="math notranslate nohighlight">\(
In Excel, this is simply `\)</span>SUM(MonthlySales)<span class="math notranslate nohighlight">\(`, where `MonthlySales` maps to \)</span>\mathbf{S}$.</p>
</section>
<section id="example-2-dynamic-named-range-for-growing-data">
<h3>Example 2: Dynamic Named Range for Growing Data<a class="headerlink" href="#example-2-dynamic-named-range-for-growing-data" title="Link to this heading">#</a></h3>
<p>For datasets that grow over time (e.g., adding new sales data each month), you can create a <strong>dynamic named range</strong> using Excel’s <code class="docutils literal notranslate"><span class="pre">OFFSET</span></code> and <code class="docutils literal notranslate"><span class="pre">COUNTA</span></code> functions. For example:</p>
<ul class="simple">
<li><p>Select <em>Formulas &gt; Define Name</em>.</p></li>
<li><p>Name: <code class="docutils literal notranslate"><span class="pre">DynamicSales</span></code>.</p></li>
<li><p>Formula: <code class="docutils literal notranslate"><span class="pre">=OFFSET(Sheet1!$B$2,</span> <span class="pre">0,</span> <span class="pre">0,</span> <span class="pre">COUNTA(Sheet1!$B:$B)-1,</span> <span class="pre">1)</span></code>.</p></li>
</ul>
<p>This formula starts at <code class="docutils literal notranslate"><span class="pre">B2</span></code>, counts non-empty cells in column <code class="docutils literal notranslate"><span class="pre">B</span></code>, and adjusts the range height dynamically. You can then use <code class="docutils literal notranslate"><span class="pre">$SUM(DynamicSales)$</span></code> to always sum the current dataset, even as new data is added.</p>
</section>
<section id="example-3-sql-database-field-naming">
<h3>Example 3: SQL Database Field Naming<a class="headerlink" href="#example-3-sql-database-field-naming" title="Link to this heading">#</a></h3>
<p>Consider a database table <code class="docutils literal notranslate"><span class="pre">Financial_Transactions</span></code> with fields <code class="docutils literal notranslate"><span class="pre">Transaction_ID</span></code>, <code class="docutils literal notranslate"><span class="pre">Transaction_Date</span></code>, and <code class="docutils literal notranslate"><span class="pre">Revenue</span></code>. To calculate total revenue for 2025, you write:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">Revenue</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">TotalRevenue</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">Financial_Transactions</span>
<span class="k">WHERE</span><span class="w"> </span><span class="k">YEAR</span><span class="p">(</span><span class="n">Transaction_Date</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2025</span><span class="p">;</span>
</pre></div>
</div>
<p>Here, <code class="docutils literal notranslate"><span class="pre">Revenue</span></code> is a clearly named field, making the query self-explanatory. If the field were named <code class="docutils literal notranslate"><span class="pre">col3</span></code>, the query would be less intuitive and harder to maintain.</p>
<p><strong>Mathematical Representation</strong>:
Let the revenue data be a set <span class="math notranslate nohighlight">\(\{ r_1, r_2, \dots, r_n \}\)</span>, where <span class="math notranslate nohighlight">\(r_i\)</span> is the revenue for transaction <span class="math notranslate nohighlight">\(i\)</span> in 2025. The total revenue is:
$<span class="math notranslate nohighlight">\(
\text{TotalRevenue} = \sum_{i=1}^n r_i
\)</span>$
The SQL query computes this sum by referencing the <code class="docutils literal notranslate"><span class="pre">Revenue</span></code> field.</p>
<hr class="docutils" />
<section id="data-classification">
<h4>7. Data Classification<a class="headerlink" href="#data-classification" title="Link to this heading">#</a></h4>
<hr class="docutils" />
<p><strong>Data classification</strong> in forecasting refers to the process of organizing and categorizing input data based on its characteristics or properties. This helps in selecting the appropriate preprocessing methods and forecasting models.</p>
<ol class="arabic simple">
<li><p><strong>Structured vs Unstructured Data</strong></p>
<ul class="simple">
<li><p><strong>Structured</strong>: Data organized in tables (e.g., stock prices in a CSV)</p></li>
<li><p><strong>Unstructured</strong>: Text, images, audio (e.g., news articles used for sentiment forecasting)</p></li>
</ul>
</li>
<li><p><strong>Quantitative vs Qualitative</strong></p>
<ul class="simple">
<li><p><strong>Quantitative</strong>: Numeric values (e.g., revenue, temperature)</p></li>
<li><p><strong>Qualitative</strong>: Descriptive categories (e.g., region, product type)</p></li>
</ul>
</li>
<li><p><strong>Time Series vs Cross-sectional</strong></p>
<ul class="simple">
<li><p><strong>Time Series</strong>: Observations indexed in time order (e.g., daily sales)</p></li>
<li><p><strong>Cross-sectional</strong>: Data collected at a single point in time (e.g., customer survey results)</p></li>
</ul>
</li>
<li><p><strong>Categorical vs Continuous</strong></p>
<ul class="simple">
<li><p><strong>Categorical</strong>: Finite set of categories (e.g., “low”, “medium”, “high” risk)</p></li>
<li><p><strong>Continuous</strong>: Real-valued measurements (e.g., $x \in \mathbb{R}$)</p></li>
</ul>
</li>
</ol>
</section>
<hr class="docutils" />
<section id="data-partition">
<h4>8. Data Partition<a class="headerlink" href="#data-partition" title="Link to this heading">#</a></h4>
<hr class="docutils" />
<ul class="simple">
<li><p><strong>Description</strong>: Splitting data into training, validation, and test sets.</p></li>
<li><p><strong>Relevance</strong>: Prevents overfitting (e.g., memorizing vs. learning) and evaluates model performance.</p></li>
<li><p><strong>Related Concepts</strong>:</p>
<ul>
<li><p><strong>Cross-Validation</strong>: K-fold validation for robust testing.</p></li>
</ul>
</li>
</ul>
<p><strong>Data partitioning</strong> is the process of splitting a dataset into subsets for training, validation, and testing.</p>
</section>
</section>
<section id="standard-splits">
<h3>Standard Splits:<a class="headerlink" href="#standard-splits" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Training Set (60-70%)</strong>: Used to train the forecasting model.</p></li>
<li><p><strong>Validation Set (10-20%)</strong>: Used to tune model parameters.</p></li>
<li><p><strong>Test Set (20-30%)</strong>: Used to evaluate model performance.</p></li>
</ul>
<p>Mathematically:</p>
<p>If <span class="math notranslate nohighlight">\( D \)</span> is the full dataset,</p>
<div class="math notranslate nohighlight">
\[
D = D_{train} \cup D_{val} \cup D_{test}
\quad \text{and} \quad
D_{train} \cap D_{val} \cap D_{test} = \emptyset
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>

<span class="c1"># Using the same dataset from earlier (Monthly Total Equity Flows)</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/datasets/investor-flow-of-funds-us/master/data/weekly.csv&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">])</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="s1">&#39;Total Equity&#39;</span><span class="p">]]</span>
<span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="s1">&#39;equity_flow&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;ME&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;date&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

<span class="c1"># Create lag features for supervised learning</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;equity_flow_lag1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;equity_flow&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;equity_flow_lag2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;equity_flow&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Split into features and target</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;equity_flow_lag1&#39;</span><span class="p">,</span> <span class="s1">&#39;equity_flow_lag2&#39;</span><span class="p">]]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;equity_flow&#39;</span><span class="p">]</span>

<span class="c1"># Split into Train and Test (80-20)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;X shape: </span><span class="si">{</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;y shape: </span><span class="si">{</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;X_train shape: </span><span class="si">{</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;X_test shape: </span><span class="si">{</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;y_train shape: </span><span class="si">{</span><span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;y_test shape: </span><span class="si">{</span><span class="n">y_test</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>X shape: (157, 2)
y shape: (157,)
X_train shape: (125, 2)
X_test shape: (32, 2)
y_train shape: (125,)
y_test shape: (32,)
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<section id="data-exploration">
<h4>9. Data Exploration<a class="headerlink" href="#data-exploration" title="Link to this heading">#</a></h4>
<hr class="docutils" />
<ul class="simple">
<li><p><strong>Description</strong>: Analyzing time-ordered data to uncover underlying patterns, trends, seasonality, and anomalies. This crucial step provides vital insights into the temporal characteristics of the data before applying forecasting models.</p></li>
<li><p><strong>Relevance</strong>: Understanding the inherent structure of the time series data is fundamental for selecting appropriate forecasting techniques and building effective models. Visualizations and statistical summaries help in identifying key components and potential challenges.</p></li>
<li><p><strong>Related Concepts</strong>:</p>
<ul>
<li><p><strong>Exploratory Data Analysis (EDA) for Time Series</strong>: Adapting general EDA techniques to account for the temporal dependence in the data. This includes time series plots, decomposition, autocorrelation analysis, and stationarity checks.</p></li>
<li><p><strong>Data Visualization</strong>: Utilizing specialized plots like line plots over time, seasonal subseries plots, and autocorrelation function (ACF) and partial autocorrelation function (PACF) plots. Python libraries like Matplotlib and Seaborn are invaluable here.</p></li>
</ul>
</li>
<li><p><strong>Example</strong>: Plotting monthly sales data over several years to visually identify an upward trend and a recurring seasonal pattern within each year.</p></li>
</ul>
<p>Exploratory Data Analysis (EDA) for time series data focuses on understanding how the variable of interest evolves over time.</p>
</section>
</section>
<section id="common-steps-in-time-series-eda">
<h3>Common Steps in Time Series EDA:<a class="headerlink" href="#common-steps-in-time-series-eda" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Time Series Visualization</strong>: Plotting the data against time to observe trends, seasonality, and irregular components.</p>
<ul>
<li><p>Let <span class="math notranslate nohighlight">\(y_t\)</span> denote the value of the time series at time <span class="math notranslate nohighlight">\(t\)</span>. A basic time series plot visualizes <span class="math notranslate nohighlight">\((t, y_t)\)</span> for <span class="math notranslate nohighlight">\(t = 1, 2, ..., n\)</span>, where <span class="math notranslate nohighlight">\(n\)</span> is the number of observations.</p></li>
</ul>
</li>
<li><p><strong>Decomposition</strong>: Separating the time series into its constituent components: trend (<span class="math notranslate nohighlight">\(T_t\)</span>), seasonality (<span class="math notranslate nohighlight">\(S_t\)</span>), and residuals (<span class="math notranslate nohighlight">\(R_t\)</span>).</p>
<ul>
<li><p>An additive decomposition model is represented as:
$<span class="math notranslate nohighlight">\(y_t = T_t + S_t + R_t\)</span>$</p></li>
<li><p>A multiplicative decomposition model is represented as:
$<span class="math notranslate nohighlight">\(y_t = T_t \times S_t \times R_t\)</span>$</p></li>
</ul>
</li>
<li><p><strong>Autocorrelation Analysis</strong>: Examining the correlation between a time series and its lagged values.</p>
<ul>
<li><p>The autocorrelation function (ACF), <span class="math notranslate nohighlight">\(\rho(k)\)</span>, measures the linear relationship between <span class="math notranslate nohighlight">\(y_t\)</span> and <span class="math notranslate nohighlight">\(y_{t-k}\)</span>, where <span class="math notranslate nohighlight">\(k\)</span> is the lag.
$<span class="math notranslate nohighlight">\(\rho(k) = \frac{Cov(y_t, y_{t-k})}{Var(y_t)}\)</span>$</p></li>
<li><p>The partial autocorrelation function (PACF) measures the correlation between <span class="math notranslate nohighlight">\(y_t\)</span> and <span class="math notranslate nohighlight">\(y_{t-k}\)</span> after removing the effects of the intermediate lags.</p></li>
</ul>
</li>
<li><p><strong>Stationarity Checks</strong>: Assessing whether the statistical properties of the time series (mean, variance, autocovariance) remain constant over time.</p>
<ul>
<li><p>A strictly stationary process has the property that its probabilistic behavior does not change over time.</p></li>
<li><p>A weakly stationary process has a constant mean, a constant variance, and an autocovariance that depends only on the lag. Tests like the Augmented Dickey-Fuller (ADF) test are used to check for stationarity.</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.tsa.seasonal</span><span class="w"> </span><span class="kn">import</span> <span class="n">seasonal_decompose</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.graphics.tsaplots</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_acf</span><span class="p">,</span> <span class="n">plot_pacf</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.tsa.stattools</span><span class="w"> </span><span class="kn">import</span> <span class="n">adfuller</span>

<span class="c1"># Sample time series data (replace with your actual data)</span>
<span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s1">&#39;2020-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">))</span>
<span class="n">sales</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span> <span class="o">+</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">12</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
<span class="n">time_series_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Date&#39;</span><span class="p">:</span> <span class="n">dates</span><span class="p">,</span> <span class="s1">&#39;Sales&#39;</span><span class="p">:</span> <span class="n">sales</span><span class="p">})</span>
<span class="n">time_series_data</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># 1. Time Series Visualization</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_series_data</span><span class="p">[</span><span class="s1">&#39;Sales&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Monthly Sales&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Time Series Plot of Monthly Sales&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Sales&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 2. Decomposition</span>
<span class="n">decomposition</span> <span class="o">=</span> <span class="n">seasonal_decompose</span><span class="p">(</span><span class="n">time_series_data</span><span class="p">[</span><span class="s1">&#39;Sales&#39;</span><span class="p">],</span> <span class="n">model</span><span class="o">=</span><span class="s1">&#39;additive&#39;</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">411</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">decomposition</span><span class="o">.</span><span class="n">observed</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Observed&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">412</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">decomposition</span><span class="o">.</span><span class="n">trend</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Trend&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">413</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">decomposition</span><span class="o">.</span><span class="n">seasonal</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Seasonal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">414</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">decomposition</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Residuals&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 3. Autocorrelation Analysis</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plot_acf</span><span class="p">(</span><span class="n">time_series_data</span><span class="p">[</span><span class="s1">&#39;Sales&#39;</span><span class="p">],</span> <span class="n">lags</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plot_pacf</span><span class="p">(</span><span class="n">time_series_data</span><span class="p">[</span><span class="s1">&#39;Sales&#39;</span><span class="p">],</span> <span class="n">lags</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 4. Stationarity Check (Augmented Dickey-Fuller Test)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Augmented Dickey-Fuller Test:&#39;</span><span class="p">)</span>
<span class="n">adf_test</span> <span class="o">=</span> <span class="n">adfuller</span><span class="p">(</span><span class="n">time_series_data</span><span class="p">[</span><span class="s1">&#39;Sales&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ADF Statistic: </span><span class="si">{</span><span class="n">adf_test</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;p-value: </span><span class="si">{</span><span class="n">adf_test</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Critical Values:&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">adf_test</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;   </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">adf_test</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.05</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Time series is likely non-stationary.&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Time series is likely stationary.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/93/7lt42x5j7m39kz7wxbcghvrm0000gn/T/ipykernel_25888/4191842216.py:10: FutureWarning: &#39;M&#39; is deprecated and will be removed in a future version, please use &#39;ME&#39; instead.
  dates = pd.to_datetime(pd.date_range(start=&#39;2020-01-01&#39;, periods=60, freq=&#39;M&#39;))
</pre></div>
</div>
<img alt="_images/18cb5ff4a9b4deefb01014e3713432380cc10cf5ab1899be248f2657afd77898.png" src="_images/18cb5ff4a9b4deefb01014e3713432380cc10cf5ab1899be248f2657afd77898.png" />
<img alt="_images/eb98c7e40d93a2d6a163c4bc15e2fff8dde1be011f4ff2868fefe1b1a87bc19c.png" src="_images/eb98c7e40d93a2d6a163c4bc15e2fff8dde1be011f4ff2868fefe1b1a87bc19c.png" />
<img alt="_images/1b37a66d5786b875885a71834b74e430458eb4e745e9a7491f668de9a19eff61.png" src="_images/1b37a66d5786b875885a71834b74e430458eb4e745e9a7491f668de9a19eff61.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Augmented Dickey-Fuller Test:
ADF Statistic: 1.417
p-value: 0.997
Critical Values:
   1%: -3.571
   5%: -2.923
   10%: -2.599
Time series is likely non-stationary.
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<section id="sorting">
<h4>10. Sorting<a class="headerlink" href="#sorting" title="Link to this heading">#</a></h4>
<hr class="docutils" />
<ul class="simple">
<li><p><strong>Description</strong>: The process of arranging data records based on the values of one or more columns (variables). This can be done in ascending order (from smallest to largest, or A to Z) or descending order (from largest to smallest, or Z to A).</p></li>
<li><p><strong>Related Concepts</strong>:</p>
<ul>
<li><p><strong>Single-Level Sorting</strong>: Arranging data based on the values of a single column.</p></li>
<li><p><strong>Multi-Level Sorting</strong>: Sorting data based on the values of multiple columns, where the order of precedence of the columns determines the final arrangement. For example, sorting time series data first by year and then by month.</p></li>
<li><p><strong>Sorting Algorithms</strong> (Optional): For a deeper understanding, one could briefly discuss the basic principles behind algorithms like bubble sort (simple comparison-based sorting) or quicksort (more efficient divide-and-conquer approach). While the underlying algorithms are often abstracted away by software, understanding their efficiency can be beneficial for very large datasets.</p></li>
</ul>
</li>
<li><p><strong>Example</strong>: In a time series of product sales, sorting the data by date ensures that the observations are in chronological order, which is essential for identifying trends and patterns over time. Additionally, one might sort by sales volume within a specific month to see the best-selling products for that period.</p></li>
</ul>
<p>Sorting is a foundational operation for organizing and examining data. In time series analysis, maintaining the correct temporal order is paramount.</p>
</section>
</section>
<section id="example-applications-in-time-series">
<h3>Example Applications in Time Series:<a class="headerlink" href="#example-applications-in-time-series" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Chronological Ordering</strong>: Ensuring time series data is ordered by the time index (e.g., date, timestamp) before any analysis or modeling. If the data is not sorted chronologically, identifying trends, seasonality, or applying time-dependent models will be incorrect.</p></li>
<li><p><strong>Identifying Extreme Events</strong>: After sorting by the value of the time series (e.g., sales, temperature), one can easily identify the periods with the highest or lowest values.</p></li>
<li><p><strong>Ranking Periods</strong>: Sorting by a specific metric (e.g., sales volume in each month) allows for ranking different time periods based on that metric.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Sample time series data (replace with your actual data)</span>
<span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">([</span><span class="s1">&#39;2023-01-05&#39;</span><span class="p">,</span> <span class="s1">&#39;2023-01-02&#39;</span><span class="p">,</span> <span class="s1">&#39;2023-01-10&#39;</span><span class="p">,</span> <span class="s1">&#39;2023-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2023-01-08&#39;</span><span class="p">])</span>
<span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">28</span><span class="p">]</span>
<span class="n">time_series_data_unsorted</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Date&#39;</span><span class="p">:</span> <span class="n">dates</span><span class="p">,</span> <span class="s1">&#39;Value&#39;</span><span class="p">:</span> <span class="n">values</span><span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unsorted Time Series Data:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">time_series_data_unsorted</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">---&quot;</span><span class="p">)</span>

<span class="c1"># 1. Sorting by Date (Chronological Order)</span>
<span class="n">time_series_data_sorted_by_date</span> <span class="o">=</span> <span class="n">time_series_data_unsorted</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Time Series Data Sorted by Date:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">time_series_data_sorted_by_date</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">---&quot;</span><span class="p">)</span>

<span class="c1"># Sample data with another column for multi-level sorting</span>
<span class="n">category</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">]</span>
<span class="n">time_series_data_multi</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Date&#39;</span><span class="p">:</span> <span class="n">dates</span><span class="p">,</span> <span class="s1">&#39;Category&#39;</span><span class="p">:</span> <span class="n">category</span><span class="p">,</span> <span class="s1">&#39;Value&#39;</span><span class="p">:</span> <span class="n">values</span><span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unsorted Time Series Data with Category:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">time_series_data_multi</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">---&quot;</span><span class="p">)</span>

<span class="c1"># 2. Multi-Level Sorting (by Category then by Value in descending order)</span>
<span class="n">time_series_data_multi_sorted</span> <span class="o">=</span> <span class="n">time_series_data_multi</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Category&#39;</span><span class="p">,</span> <span class="s1">&#39;Value&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Time Series Data Sorted by Category (ascending) then Value (descending):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">time_series_data_multi_sorted</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">---&quot;</span><span class="p">)</span>

<span class="c1"># 3. Sorting by Value (to identify extreme values)</span>
<span class="n">time_series_data_sorted_by_value_desc</span> <span class="o">=</span> <span class="n">time_series_data_unsorted</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Value&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Time Series Data Sorted by Value (Descending - Highest Value First):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">time_series_data_sorted_by_value_desc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Unsorted Time Series Data:
        Date  Value
0 2023-01-05     25
1 2023-01-02     30
2 2023-01-10     22
3 2023-01-01     35
4 2023-01-08     28

---
Time Series Data Sorted by Date:
        Date  Value
3 2023-01-01     35
1 2023-01-02     30
0 2023-01-05     25
4 2023-01-08     28
2 2023-01-10     22

---
Unsorted Time Series Data with Category:
        Date Category  Value
0 2023-01-05        A     25
1 2023-01-02        B     30
2 2023-01-10        A     22
3 2023-01-01        B     35
4 2023-01-08        A     28

---
Time Series Data Sorted by Category (ascending) then Value (descending):
        Date Category  Value
4 2023-01-08        A     28
0 2023-01-05        A     25
2 2023-01-10        A     22
3 2023-01-01        B     35
1 2023-01-02        B     30

---
Time Series Data Sorted by Value (Descending - Highest Value First):
        Date  Value
3 2023-01-01     35
1 2023-01-02     30
4 2023-01-08     28
0 2023-01-05     25
2 2023-01-10     22
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<section id="filtering-data">
<h4>11. Filtering Data<a class="headerlink" href="#filtering-data" title="Link to this heading">#</a></h4>
<hr class="docutils" />
<ul class="simple">
<li><p><strong>Description</strong>: The process of selecting specific subsets of data from a larger dataset based on predefined conditions or criteria. This allows analysts to focus on the most relevant portions of the data for their specific questions or analyses.</p></li>
<li><p><strong>Related Concepts</strong>:</p>
<ul>
<li><p><strong>Basic Filtering</strong>: Applying single conditions to select data (e.g., all sales records from a specific month).</p></li>
<li><p><strong>Advanced Filtering</strong>: Using multiple conditions combined with logical operators (AND, OR, NOT) to create more complex selection criteria (e.g., all sales above a certain threshold AND occurring during a specific promotional period).</p></li>
<li><p><strong>Querying</strong>: Similar to using <code class="docutils literal notranslate"><span class="pre">WHERE</span></code> clauses in SQL, filtering in data analysis tools allows for specifying conditions that the data records must satisfy to be included in the resulting subset.</p></li>
</ul>
</li>
<li><p><strong>Example</strong>: In a time series of website traffic, filtering the data to show only the traffic during weekdays between 9 AM and 5 PM might be useful for analyzing user behavior during business hours. Another example could be filtering stock prices to only include data points after a specific market event.</p></li>
</ul>
</section>
</section>
<section id="examples-in-time-series">
<h3>Examples in Time Series:<a class="headerlink" href="#examples-in-time-series" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Filtering by Time Period</strong>: Selecting data within a specific date range (e.g., sales data for the last quarter, temperature readings for a particular year).</p></li>
<li><p><strong>Filtering by Value Threshold</strong>: Identifying time points where the value of the time series exceeds or falls below a certain level (e.g., days when stock prices were above $150, hours when website traffic was below 500).</p></li>
<li><p><strong>Filtering by Event</strong>: Selecting data points associated with specific events or conditions (if event markers are present in the data).</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Sample time series data (replace with your actual data)</span>
<span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s1">&#39;2023-01-01&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;2023-01-10&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">))</span>
<span class="n">sales</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dates</span><span class="p">))</span>
<span class="n">temperatures</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dates</span><span class="p">))</span>
<span class="n">events</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;No Event&#39;</span><span class="p">,</span> <span class="s1">&#39;Promotion&#39;</span><span class="p">,</span> <span class="s1">&#39;No Event&#39;</span><span class="p">,</span> <span class="s1">&#39;Holiday&#39;</span><span class="p">,</span> <span class="s1">&#39;No Event&#39;</span><span class="p">,</span> <span class="s1">&#39;No Event&#39;</span><span class="p">,</span> <span class="s1">&#39;Promotion&#39;</span><span class="p">,</span> <span class="s1">&#39;No Event&#39;</span><span class="p">,</span> <span class="s1">&#39;Holiday&#39;</span><span class="p">,</span> <span class="s1">&#39;No Event&#39;</span><span class="p">]</span>
<span class="n">time_series_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Date&#39;</span><span class="p">:</span> <span class="n">dates</span><span class="p">,</span> <span class="s1">&#39;Sales&#39;</span><span class="p">:</span> <span class="n">sales</span><span class="p">,</span> <span class="s1">&#39;Temperature&#39;</span><span class="p">:</span> <span class="n">temperatures</span><span class="p">,</span> <span class="s1">&#39;Event&#39;</span><span class="p">:</span> <span class="n">events</span><span class="p">})</span>
<span class="n">time_series_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original Time Series Data:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">time_series_df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">---&quot;</span><span class="p">)</span>

<span class="c1"># 1. Filtering by Time Period (e.g., sales after 2023-01-05)</span>
<span class="n">after_date</span> <span class="o">=</span> <span class="s1">&#39;2023-01-05&#39;</span>
<span class="n">filtered_after_date</span> <span class="o">=</span> <span class="n">time_series_df</span><span class="p">[</span><span class="n">time_series_df</span><span class="o">.</span><span class="n">index</span> <span class="o">&gt;</span> <span class="n">after_date</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sales data after </span><span class="si">{</span><span class="n">after_date</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">filtered_after_date</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">---&quot;</span><span class="p">)</span>

<span class="c1"># 2. Filtering by Value Threshold (e.g., days with sales above 150)</span>
<span class="n">sales_threshold</span> <span class="o">=</span> <span class="mi">150</span>
<span class="n">high_sales</span> <span class="o">=</span> <span class="n">time_series_df</span><span class="p">[</span><span class="n">time_series_df</span><span class="p">[</span><span class="s1">&#39;Sales&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">sales_threshold</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Days with sales above </span><span class="si">{</span><span class="n">sales_threshold</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">high_sales</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">---&quot;</span><span class="p">)</span>

<span class="c1"># 3. Filtering by Multiple Conditions (e.g., days with temperature above 20 AND a &#39;Promotion&#39; event)</span>
<span class="n">filtered_multiple_conditions</span> <span class="o">=</span> <span class="n">time_series_df</span><span class="p">[(</span><span class="n">time_series_df</span><span class="p">[</span><span class="s1">&#39;Temperature&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">time_series_df</span><span class="p">[</span><span class="s1">&#39;Event&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Promotion&#39;</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Days with temperature above 20 and a &#39;Promotion&#39; event:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">filtered_multiple_conditions</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">---&quot;</span><span class="p">)</span>

<span class="c1"># 4. Filtering by a list of values (e.g., events that are &#39;Holiday&#39;)</span>
<span class="n">filtered_by_event</span> <span class="o">=</span> <span class="n">time_series_df</span><span class="p">[</span><span class="n">time_series_df</span><span class="p">[</span><span class="s1">&#39;Event&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;Holiday&#39;</span><span class="p">])]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data points where the event is &#39;Holiday&#39;:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">filtered_by_event</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Original Time Series Data:
            Sales  Temperature      Event
Date                                     
2023-01-01    193    15.453040   No Event
2023-01-02    134    18.746126  Promotion
2023-01-03     88    21.258599   No Event
2023-01-04    149    20.031363    Holiday
2023-01-05     82    23.564898   No Event
2023-01-06    150    21.586936   No Event
2023-01-07     72    16.629344  Promotion
2023-01-08     59    15.705687   No Event
2023-01-09    118    21.424193    Holiday
2023-01-10    149    15.265113   No Event

---
Sales data after 2023-01-05:
            Sales  Temperature      Event
Date                                     
2023-01-06    150    21.586936   No Event
2023-01-07     72    16.629344  Promotion
2023-01-08     59    15.705687   No Event
2023-01-09    118    21.424193    Holiday
2023-01-10    149    15.265113   No Event

---
Days with sales above 150:
            Sales  Temperature     Event
Date                                    
2023-01-01    193     15.45304  No Event

---
Days with temperature above 20 and a &#39;Promotion&#39; event:
Empty DataFrame
Columns: [Sales, Temperature, Event]
Index: []

---
Data points where the event is &#39;Holiday&#39;:
            Sales  Temperature    Event
Date                                   
2023-01-04    149    20.031363  Holiday
2023-01-09    118    21.424193  Holiday
</pre></div>
</div>
</div>
</div>
<section id="id5">
<h4>Modifying Data using Excel<a class="headerlink" href="#id5" title="Link to this heading">#</a></h4>
<p>Excel is a practical tool for quick transformations:</p>
<ul class="simple">
<li><p><strong>Range Names</strong>: Assign names to cells (e.g., <code class="docutils literal notranslate"><span class="pre">=Average(Returns)</span></code>)</p></li>
<li><p><strong>Sorting</strong>: Data → Sort (ascending/descending)</p></li>
<li><p><strong>Filtering</strong>: Use filters to view subset of data</p></li>
<li><p><strong>Basic Formulas</strong>: <code class="docutils literal notranslate"><span class="pre">=AVERAGE(A1:A10)</span></code>, <code class="docutils literal notranslate"><span class="pre">=STDEV.P(A1:A10)</span></code></p></li>
<li><p><strong>Charts</strong>: Insert → Chart → Time Series Plot</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="creating-distribution-from-data">
<h4>12. Creating Distribution from Data<a class="headerlink" href="#creating-distribution-from-data" title="Link to this heading">#</a></h4>
<hr class="docutils" />
<ul class="simple">
<li><p><strong>Description</strong>: The process of summarizing the values within a time series dataset to understand their frequency or probability of occurrence. This involves grouping the data into intervals (bins) and counting how many observations fall into each bin, or estimating the underlying probability density function.</p></li>
<li><p><strong>Related Concepts</strong>:</p>
<ul>
<li><p><strong>Histograms</strong>: Graphical representations of frequency distributions, where the height of each bar corresponds to the number of observations within a particular bin.</p></li>
<li><p><strong>Probability Distributions</strong>: Mathematical functions that describe the likelihood of different outcomes. Common examples include the normal (Gaussian) distribution, log-normal distribution (often used for asset prices), and others depending on the nature of the time series.</p></li>
<li><p><strong>Kernel Density Estimation (KDE)</strong>: A non-parametric method to estimate the probability density function of a random variable. It provides a smoothed representation of the distribution.</p></li>
</ul>
</li>
<li><p><strong>Example</strong>: Creating a histogram of daily stock returns over a year can help visualize the distribution of these returns, allowing one to assess if they roughly follow a normal distribution, are skewed, or have heavy tails (more extreme events than a normal distribution would predict).</p></li>
<li><p><strong>Mathematical Context</strong>: For a normal distribution with mean <span class="math notranslate nohighlight">\(\mu\)</span> and standard deviation <span class="math notranslate nohighlight">\(\sigma\)</span>, the probability density function <span class="math notranslate nohighlight">\(f(x)\)</span> is given by:
$<span class="math notranslate nohighlight">\(
  f(x) = \frac{1}{\sigma \sqrt{2\pi}} e^{-\frac{(x-\mu)^2}{2\sigma^2}}
  \)</span>$
This bell-shaped curve is often used as a benchmark for understanding the distribution of many natural phenomena and financial data.</p></li>
</ul>
<p>A <strong>distribution</strong> provides a visual and statistical summary of how frequently different values occur in a time series. This understanding is vital for:</p>
<ul class="simple">
<li><p><strong>Identifying Data Skewness</strong>: Determining if the distribution is asymmetric, with a longer tail on one side.</p></li>
<li><p><strong>Understanding Volatility in Returns</strong>: Observing the spread or dispersion of returns, which is a measure of risk in financial time series.</p></li>
</ul>
</section>
</section>
<section id="common-tools-for-visualizing-distributions">
<h3>Common Tools for Visualizing Distributions:<a class="headerlink" href="#common-tools-for-visualizing-distributions" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Histogram</strong>: Displays the frequency of data points falling within specified bins.</p></li>
<li><p><strong>Box Plot</strong>: Summarizes the distribution through quartiles, median, and potential outliers, providing insights into spread and skewness.</p></li>
<li><p><strong>KDE (Kernel Density Estimate)</strong>: Provides a smooth, continuous estimate of the probability density function of the data.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>

<span class="c1"># Sample time series data (replace with your actual data)</span>
<span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s1">&#39;2023-01-01&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;2023-12-31&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">))</span>
<span class="n">daily_returns</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">0.0005</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dates</span><span class="p">))</span> <span class="c1"># Simulate daily returns</span>
<span class="n">time_series_returns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Date&#39;</span><span class="p">:</span> <span class="n">dates</span><span class="p">,</span> <span class="s1">&#39;Daily Return&#39;</span><span class="p">:</span> <span class="n">daily_returns</span><span class="p">})</span>
<span class="n">time_series_returns</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sample Time Series of Daily Returns:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">time_series_returns</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">---&quot;</span><span class="p">)</span>

<span class="c1"># 1. Histogram of Daily Returns</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">time_series_returns</span><span class="p">[</span><span class="s1">&#39;Daily Return&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Histogram of Daily Returns&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Daily Return&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">---&quot;</span><span class="p">)</span>

<span class="c1"># 2. Box Plot of Daily Returns</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">time_series_returns</span><span class="p">[</span><span class="s1">&#39;Daily Return&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Box Plot of Daily Returns&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Daily Return&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">---&quot;</span><span class="p">)</span>

<span class="c1"># 3. Kernel Density Estimate (KDE) of Daily Returns</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">time_series_returns</span><span class="p">[</span><span class="s1">&#39;Daily Return&#39;</span><span class="p">],</span> <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Kernel Density Estimate of Daily Returns&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Daily Return&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">---&quot;</span><span class="p">)</span>

<span class="c1"># 4. Combining Histogram and KDE</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">time_series_returns</span><span class="p">[</span><span class="s1">&#39;Daily Return&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;skyblue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Histogram with KDE of Daily Returns&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Daily Return&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency / Density&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sample Time Series of Daily Returns:
            Daily Return
Date                    
2023-01-01      0.006972
2023-01-02      0.001761
2023-01-03     -0.018474
2023-01-04      0.013305
2023-01-05     -0.005651

---
</pre></div>
</div>
<img alt="_images/ed47576a27e882037d764fd2283fbd82214da8474bdfb8adeab07e6d055a4414.png" src="_images/ed47576a27e882037d764fd2283fbd82214da8474bdfb8adeab07e6d055a4414.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>---
</pre></div>
</div>
<img alt="_images/7a0095f49d3a1c59bb3314c92cc8725df070cbc1e26451d138333b39405591ee.png" src="_images/7a0095f49d3a1c59bb3314c92cc8725df070cbc1e26451d138333b39405591ee.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>---
</pre></div>
</div>
<img alt="_images/1bc47cfb896e893d4265e730543daba3c2c555f62a344812fb09c72abadac404.png" src="_images/1bc47cfb896e893d4265e730543daba3c2c555f62a344812fb09c72abadac404.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>---
</pre></div>
</div>
<img alt="_images/5b30403219be3bb9267d8a6cfc7c9f9678975c543191c32395bf993be2f3fe9f.png" src="_images/5b30403219be3bb9267d8a6cfc7c9f9678975c543191c32395bf993be2f3fe9f.png" />
</div>
</div>
<hr class="docutils" />
<section id="analyzing-distribution">
<h4>13. Analyzing Distribution<a class="headerlink" href="#analyzing-distribution" title="Link to this heading">#</a></h4>
<hr class="docutils" />
<ul class="simple">
<li><p><strong>Description</strong>: Quantifying the shape of a distribution by evaluating its asymmetry (skewness) and the heaviness of its tails (kurtosis). These measures provide insights beyond central tendency and dispersion, revealing important characteristics of the data’s distribution.</p></li>
<li><p><strong>Related Concepts</strong>:</p>
<ul>
<li><p><strong>Skewness</strong>: A measure of the asymmetry of the probability distribution of a real-valued random variable about its mean. A positive skew indicates a long tail extending towards more positive values (right-skewed), while a negative skew indicates a long tail extending towards more negative values (left-skewed). The formula for sample skewness is:
$<span class="math notranslate nohighlight">\(
  \text{Skew} = \frac{\frac{1}{n} \sum_{i=1}^n (x_i - \mu)^3}{\sigma^3}
  \)</span><span class="math notranslate nohighlight">\(
  where \)</span>x_i<span class="math notranslate nohighlight">\( are the data points, \)</span>\mu<span class="math notranslate nohighlight">\( is the sample mean, \)</span>\sigma<span class="math notranslate nohighlight">\( is the sample standard deviation, and \)</span>n$ is the number of data points.</p></li>
<li><p><strong>Kurtosis</strong>: A measure of the “tailedness” of the probability distribution. High kurtosis indicates that the distribution has heavier tails and a sharper peak around the mean compared to a normal distribution, suggesting more frequent extreme values. The formula for sample kurtosis (often adjusted to excess kurtosis by subtracting 3, where a normal distribution has a kurtosis of 3) is:
$<span class="math notranslate nohighlight">\(
  \text{Kurt} = \frac{\frac{1}{n} \sum_{i=1}^n (x_i - \mu)^4}{\sigma^4}
  \)</span><span class="math notranslate nohighlight">\(
  Excess kurtosis is then \)</span>\text{Kurt}_{excess} = \text{Kurt} - 3$.</p></li>
</ul>
</li>
<li><p><strong>Example</strong>: In financial modeling, checking the skewness of stock returns is vital. A significant negative skew might indicate a higher probability of large negative returns (crashes) compared to large positive returns. Similarly, examining kurtosis helps assess the risk associated with extreme price movements.</p></li>
</ul>
<p>Distribution analysis provides crucial insights into the shape of time series data, helping to determine if the returns or values are normally distributed, skewed, or exhibit heavy tails.</p>
</section>
</section>
<section id="tools-for-assessing-distribution-shape">
<h3>Tools for Assessing Distribution Shape:<a class="headerlink" href="#tools-for-assessing-distribution-shape" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Histogram</strong>: Visual inspection can reveal asymmetry and the relative frequency of values in the tails.</p></li>
<li><p><strong>KDE Plot</strong>: Provides a smoothed visualization of the distribution, making it easier to observe skewness and the overall shape.</p></li>
<li><p><strong>Skewness Coefficient</strong>: A numerical measure of asymmetry.
$<span class="math notranslate nohighlight">\(
  \text{Skewness} &gt; 0 \implies \text{Right-tailed (positive skew)}
  \)</span><span class="math notranslate nohighlight">\(
  \)</span><span class="math notranslate nohighlight">\(
  \text{Skewness} &lt; 0 \implies \text{Left-tailed (negative skew)}
  \)</span><span class="math notranslate nohighlight">\(
  \)</span><span class="math notranslate nohighlight">\(
  \text{Skewness} \approx 0 \implies \text{Symmetric}
  \)</span>$</p></li>
<li><p><strong>Kurtosis Coefficient</strong>: A numerical measure of the tailedness of the distribution.
$<span class="math notranslate nohighlight">\(
  \text{Kurtosis} &gt; 3 \implies \text{Leptokurtic (heavy tails, sharper peak)}
  \)</span><span class="math notranslate nohighlight">\(
  \)</span><span class="math notranslate nohighlight">\(
  \text{Kurtosis} &lt; 3 \implies \text{Platykurtic (thin tails, flatter peak)}
  \)</span><span class="math notranslate nohighlight">\(
  \)</span><span class="math notranslate nohighlight">\(
  \text{Kurtosis} \approx 3 \implies \text{Mesokurtic (similar to normal distribution)}
  \)</span>$</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">norm</span><span class="p">,</span> <span class="n">skewnorm</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">skew</span><span class="p">,</span> <span class="n">kurtosis</span>

<span class="c1"># Generate data points</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>  <span class="c1"># for reproducibility</span>
<span class="n">n_points</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="c1"># Normal distribution</span>
<span class="n">normal_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n_points</span><span class="p">)</span>
<span class="n">skewness_normal</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># Right-skewed distribution (using a different distribution for better visual)</span>
<span class="n">right_skewed_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n_points</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="c1"># Shifted exponential</span>
<span class="n">skewness_right</span> <span class="o">=</span> <span class="n">skew</span><span class="p">(</span><span class="n">right_skewed_data</span><span class="p">)</span>

<span class="c1"># Left-skewed distribution (mirroring the right-skewed)</span>
<span class="n">left_skewed_data</span> <span class="o">=</span> <span class="o">-</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n_points</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">skewness_left</span> <span class="o">=</span> <span class="n">skew</span><span class="p">(</span><span class="n">left_skewed_data</span><span class="p">)</span>

<span class="c1"># Plotting histograms</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">normal_data</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Normal&#39;</span><span class="p">)</span>
<span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">()</span>
<span class="n">x_norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">p_norm</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x_norm</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">normal_data</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">normal_data</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_norm</span><span class="p">,</span> <span class="n">p_norm</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Normal (Skewness ≈ </span><span class="si">{</span><span class="n">skewness_normal</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Data Value&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Probability Density&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">right_skewed_data</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Right-Skewed&#39;</span><span class="p">)</span>
<span class="n">xmin_right</span><span class="p">,</span> <span class="n">xmax_right</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">()</span>
<span class="n">x_right</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xmin_right</span><span class="p">,</span> <span class="n">xmax_right</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">p_right</span> <span class="o">=</span> <span class="n">skewnorm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x_right</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">skewness_right</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">right_skewed_data</span><span class="p">),</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">right_skewed_data</span><span class="p">))</span> <span class="c1"># Using skewnorm to fit</span>
<span class="c1"># Note: Fitting skewnorm might not perfectly match the exponential, but shows the skewed shape</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_right</span><span class="p">,</span> <span class="n">p_right</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Right-Skewed (Skewness ≈ </span><span class="si">{</span><span class="n">skewness_right</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Data Value&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Probability Density&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">left_skewed_data</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Left-Skewed&#39;</span><span class="p">)</span>
<span class="n">xmin_left</span><span class="p">,</span> <span class="n">xmax_left</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">()</span>
<span class="n">x_left</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xmin_left</span><span class="p">,</span> <span class="n">xmax_left</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">p_left</span> <span class="o">=</span> <span class="n">skewnorm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x_left</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">skewness_left</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">left_skewed_data</span><span class="p">),</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">left_skewed_data</span><span class="p">))</span> <span class="c1"># Using skewnorm to fit</span>
<span class="c1"># Note: Fitting skewnorm might not perfectly match the mirrored exponential, but shows the skewed shape</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_left</span><span class="p">,</span> <span class="n">p_left</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Left-Skewed (Skewness ≈ </span><span class="si">{</span><span class="n">skewness_left</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Data Value&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Probability Density&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/496f4871e605c087f32493b06b147b14cbb25288fed12c3ad3b3b0e8e3ca2580.png" src="_images/496f4871e605c087f32493b06b147b14cbb25288fed12c3ad3b3b0e8e3ca2580.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">skew</span><span class="p">,</span> <span class="n">kurtosis</span>

<span class="c1"># Sample time series data (replace with your actual data)</span>
<span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s1">&#39;2023-01-01&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;2023-12-31&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">))</span>
<span class="n">daily_returns_normal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">0.0005</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dates</span><span class="p">))</span>
<span class="n">daily_returns_skewed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">0.0005</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dates</span><span class="p">))</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="mf">0.005</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dates</span><span class="p">))</span> <span class="o">*</span> <span class="mf">0.5</span>
<span class="n">daily_returns_heavy_tailed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">standard_t</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dates</span><span class="p">))</span> <span class="o">*</span> <span class="mf">0.01</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Date&#39;</span><span class="p">:</span> <span class="n">dates</span><span class="p">,</span>
    <span class="s1">&#39;Normal Returns&#39;</span><span class="p">:</span> <span class="n">daily_returns_normal</span><span class="p">,</span>
    <span class="s1">&#39;Skewed Returns&#39;</span><span class="p">:</span> <span class="n">daily_returns_skewed</span><span class="p">,</span>
    <span class="s1">&#39;Heavy-Tailed Returns&#39;</span><span class="p">:</span> <span class="n">daily_returns_heavy_tailed</span>
<span class="p">})</span>
<span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sample Time Series of Returns:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">---&quot;</span><span class="p">)</span>

<span class="c1"># Analyze Normal Returns</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Analysis of Normal Returns:&quot;</span><span class="p">)</span>
<span class="n">skewness_normal</span> <span class="o">=</span> <span class="n">skew</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Normal Returns&#39;</span><span class="p">])</span>
<span class="n">kurtosis_normal</span> <span class="o">=</span> <span class="n">kurtosis</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Normal Returns&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Skewness: </span><span class="si">{</span><span class="n">skewness_normal</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Kurtosis (Excess): </span><span class="si">{</span><span class="n">kurtosis_normal</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># scipy.stats.kurtosis returns excess kurtosis</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Normal Returns&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;skyblue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Histogram with KDE of Normal Returns&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Daily Return&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency / Density&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">---&quot;</span><span class="p">)</span>

<span class="c1"># Analyze Skewed Returns</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Analysis of Skewed Returns:&quot;</span><span class="p">)</span>
<span class="n">skewness_skewed</span> <span class="o">=</span> <span class="n">skew</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Skewed Returns&#39;</span><span class="p">])</span>
<span class="n">kurtosis_skewed</span> <span class="o">=</span> <span class="n">kurtosis</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Skewed Returns&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Skewness: </span><span class="si">{</span><span class="n">skewness_skewed</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Kurtosis (Excess): </span><span class="si">{</span><span class="n">kurtosis_skewed</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Skewed Returns&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;salmon&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Histogram with KDE of Skewed Returns&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Daily Return&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency / Density&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">---&quot;</span><span class="p">)</span>

<span class="c1"># Analyze Heavy-Tailed Returns</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Analysis of Heavy-Tailed Returns:&quot;</span><span class="p">)</span>
<span class="n">skewness_heavy_tailed</span> <span class="o">=</span> <span class="n">skew</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Heavy-Tailed Returns&#39;</span><span class="p">])</span>
<span class="n">kurtosis_heavy_tailed</span> <span class="o">=</span> <span class="n">kurtosis</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Heavy-Tailed Returns&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Skewness: </span><span class="si">{</span><span class="n">skewness_heavy_tailed</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Kurtosis (Excess): </span><span class="si">{</span><span class="n">kurtosis_heavy_tailed</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Heavy-Tailed Returns&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgreen&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Histogram with KDE of Heavy-Tailed Returns&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Daily Return&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency / Density&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sample Time Series of Returns:
            Normal Returns  Skewed Returns  Heavy-Tailed Returns
Date                                                            
2023-01-01       -0.005567       -0.005480              0.016412
2023-01-02        0.002613       -0.003066             -0.012828
2023-01-03        0.012501       -0.007143              0.003276
2023-01-04       -0.004419        0.013458             -0.021952
2023-01-05       -0.018266       -0.001169              0.010649

---
Analysis of Normal Returns:
Skewness: 0.0289
Kurtosis (Excess): 0.3690
</pre></div>
</div>
<img alt="_images/2112ac92f1e37734b0054e5a462ca7756aa90675036b4727dd46c5cafbd5ae3a.png" src="_images/2112ac92f1e37734b0054e5a462ca7756aa90675036b4727dd46c5cafbd5ae3a.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>---
Analysis of Skewed Returns:
Skewness: -0.0920
Kurtosis (Excess): -0.1990
</pre></div>
</div>
<img alt="_images/c075334317c1caa0a5b49f2a5e7e88c11c9b68996ee71d48c652bf421783fe23.png" src="_images/c075334317c1caa0a5b49f2a5e7e88c11c9b68996ee71d48c652bf421783fe23.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>---
Analysis of Heavy-Tailed Returns:
Skewness: 0.3461
Kurtosis (Excess): 3.4767
</pre></div>
</div>
<img alt="_images/c80dc7df747ce58a801929eb720db162c6e8fe6d2d88edb5459835c2f3588233.png" src="_images/c80dc7df747ce58a801929eb720db162c6e8fe6d2d88edb5459835c2f3588233.png" />
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="creating-distributions-from-time-series-data-for-forecasting">
<h2>Creating Distributions from Time Series Data for Forecasting<a class="headerlink" href="#creating-distributions-from-time-series-data-for-forecasting" title="Link to this heading">#</a></h2>
<hr class="docutils" />
<p>In forecasting, distributions of time series data help model uncertainty and predict future values. Key approaches include:</p>
<ul class="simple">
<li><p><strong>Empirical Distributions</strong>: Histograms or kernel density estimates of historical values.</p></li>
<li><p><strong>Residual Distributions</strong>: Distributions of errors from a forecasting model.</p></li>
<li><p><strong>Lag Distributions</strong>: Distributions of differences between observations at specific lags.</p></li>
</ul>
<p><strong>Example</strong>: For a time series $<span class="math notranslate nohighlight">\( X_t = \{x_1, x_2, \ldots, x_T\} \)</span>, the residual distribution is based on errors $<span class="math notranslate nohighlight">\( e_t = x_t - \hat{x}_t \)</span>, where $<span class="math notranslate nohighlight">\( \hat{x}_t \)</span> is the predicted value. The probability density of residuals can be estimated as:
$<span class="math notranslate nohighlight">\( f(e) \approx \frac{1}{Th} \sum_{t=1}^T K\left(\frac{e - e_t}{h}\right) \)</span><span class="math notranslate nohighlight">\(
where \)</span><span class="math notranslate nohighlight">\( K \)</span> is a kernel function and $<span class="math notranslate nohighlight">\( h \)</span> is the bandwidth.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">gaussian_kde</span>

<span class="c1"># Generate synthetic time series</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">trend</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">t</span>
<span class="n">seasonality</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span> <span class="o">/</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">trend</span> <span class="o">+</span> <span class="n">seasonality</span> <span class="o">+</span> <span class="n">noise</span>

<span class="c1"># Simple moving average forecast</span>
<span class="n">window</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">forecast</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span> <span class="n">min_periods</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">residuals</span> <span class="o">=</span> <span class="n">X</span> <span class="o">-</span> <span class="n">forecast</span>

<span class="c1"># Lag differences (lag=1)</span>
<span class="n">lag_diff</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

<span class="c1"># Empirical distribution (histogram)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Empirical&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Empirical Distribution of Time Series&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Value&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Residual distribution (kernel density)</span>
<span class="n">kde</span> <span class="o">=</span> <span class="n">gaussian_kde</span><span class="p">(</span><span class="n">residuals</span><span class="o">.</span><span class="n">dropna</span><span class="p">())</span>
<span class="n">x_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">residuals</span><span class="o">.</span><span class="n">dropna</span><span class="p">()),</span> <span class="nb">max</span><span class="p">(</span><span class="n">residuals</span><span class="o">.</span><span class="n">dropna</span><span class="p">()),</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_range</span><span class="p">,</span> <span class="n">kde</span><span class="p">(</span><span class="n">x_range</span><span class="p">),</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Residual KDE&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">residuals</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Residual Histogram&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Residual Distribution&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Residual&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Lag distribution</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">lag_diff</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Lag-1 Differences&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Lag-1 Difference Distribution&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Difference&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;distributions_forecasting.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f26ae81c2ac10d86aaba7b91ee6c5797b313b81c200f13eafe79bcf5c32681b4.png" src="_images/f26ae81c2ac10d86aaba7b91ee6c5797b313b81c200f13eafe79bcf5c32681b4.png" />
</div>
</div>
</section>
<hr class="docutils" />
<section id="measures-of-location">
<h2>Measures of Location<a class="headerlink" href="#measures-of-location" title="Link to this heading">#</a></h2>
<hr class="docutils" />
<p>Measures of location summarize the central tendency, which is crucial for forecasting point estimates:</p>
<ul class="simple">
<li><p><strong>Mean</strong>: Average value, often used as a baseline forecast.
$<span class="math notranslate nohighlight">\( \bar{x} = \frac{1}{T} \sum_{t=1}^T x_t \)</span>$</p></li>
<li><p><strong>Median</strong>: Robust to outliers, useful for skewed data.</p></li>
<li><p><strong>Exponential Moving Average (EMA)</strong>: Weights recent observations more heavily.
$<span class="math notranslate nohighlight">\( \text{EMA}_t = \alpha x_t + (1 - \alpha) \text{EMA}_{t-1} \)</span><span class="math notranslate nohighlight">\(
where \)</span><span class="math notranslate nohighlight">\( \alpha \)</span> is the smoothing factor.</p></li>
</ul>
<p><strong>Example</strong>: For $<span class="math notranslate nohighlight">\( X_t = \{10, 12, 11, 13\} \)</span>, the mean is:
$<span class="math notranslate nohighlight">\( \bar{x} = \frac{10 + 12 + 11 + 13}{4} = 11.5 \)</span>$</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Generate synthetic time series</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">trend</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">t</span>
<span class="n">seasonality</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span> <span class="o">/</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">trend</span> <span class="o">+</span> <span class="n">seasonality</span> <span class="o">+</span> <span class="n">noise</span>

<span class="c1"># Calculate measures of location</span>
<span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">median</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">ema</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">ewm</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># Plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Time Series&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Mean: </span><span class="si">{</span><span class="n">mean</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">median</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Median: </span><span class="si">{</span><span class="n">median</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">ema</span><span class="p">,</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;EMA (α=0.2)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Measures of Location&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Value&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;measures_location.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/cf3858fa023a31b850bf5bcb11b29d615b3563419841b6d94be93220fc2fe195.png" src="_images/cf3858fa023a31b850bf5bcb11b29d615b3563419841b6d94be93220fc2fe195.png" />
</div>
</div>
</section>
<hr class="docutils" />
<section id="measures-of-variability">
<h2>Measures of Variability<a class="headerlink" href="#measures-of-variability" title="Link to this heading">#</a></h2>
<hr class="docutils" />
<p>Variability measures inform forecast uncertainty and confidence intervals:</p>
<ul class="simple">
<li><p><strong>Variance</strong>: Spread of the series or residuals.
$<span class="math notranslate nohighlight">\( \sigma^2 = \frac{1}{T} \sum_{t=1}^T (x_t - \bar{x})^2 \)</span>$</p></li>
<li><p><strong>Standard Deviation</strong>: Square root of variance, used for prediction intervals.
$<span class="math notranslate nohighlight">\( \sigma = \sqrt{\sigma^2} \)</span>$</p></li>
<li><p><strong>Mean Absolute Error (MAE)</strong>: Average absolute forecast error.
$<span class="math notranslate nohighlight">\( \text{MAE} = \frac{1}{T} \sum_{t=1}^T |x_t - \hat{x}_t| \)</span>$</p></li>
</ul>
<p><strong>Example</strong>: For residuals $<span class="math notranslate nohighlight">\( e_t = \{1, -0.5, 0.2, -1.2\} \)</span>, variance is:
$<span class="math notranslate nohighlight">\( \sigma^2 = \frac{1^2 + (-0.5)^2 + 0.2^2 + (-1.2)^2}{4} = 0.6825 \)</span>$</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Generate synthetic time series</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">trend</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">t</span>
<span class="n">seasonality</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span> <span class="o">/</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">trend</span> <span class="o">+</span> <span class="n">seasonality</span> <span class="o">+</span> <span class="n">noise</span>

<span class="c1"># Moving average forecast</span>
<span class="n">window</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">forecast</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span> <span class="n">min_periods</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Calculate residuals, aligning X with non-NaN forecast values</span>
<span class="n">valid_indices</span> <span class="o">=</span> <span class="n">forecast</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span>
<span class="n">residuals</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">valid_indices</span><span class="p">]</span> <span class="o">-</span> <span class="n">forecast</span><span class="p">[</span><span class="n">valid_indices</span><span class="p">]</span>

<span class="c1"># Calculate variability measures</span>
<span class="n">variance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span>
<span class="n">std_dev</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span>
<span class="n">mae</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">residuals</span><span class="p">))</span>

<span class="c1"># Plot time series with prediction intervals</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Time Series&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">valid_indices</span><span class="p">],</span> <span class="n">forecast</span><span class="p">[</span><span class="n">valid_indices</span><span class="p">],</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Forecast&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">valid_indices</span><span class="p">],</span> <span class="n">forecast</span><span class="p">[</span><span class="n">valid_indices</span><span class="p">]</span> <span class="o">-</span> <span class="mf">1.96</span> <span class="o">*</span> <span class="n">std_dev</span><span class="p">,</span> 
                 <span class="n">forecast</span><span class="p">[</span><span class="n">valid_indices</span><span class="p">]</span> <span class="o">+</span> <span class="mf">1.96</span> <span class="o">*</span> <span class="n">std_dev</span><span class="p">,</span> 
                 <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;95% Prediction Interval&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Measures of Variability</span><span class="se">\n</span><span class="s1">Variance: </span><span class="si">{</span><span class="n">variance</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">, Std Dev: </span><span class="si">{</span><span class="n">std_dev</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">, MAE: </span><span class="si">{</span><span class="n">mae</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Value&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;measures_variability.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/75b806e6ab3811a9ff1137626d1551da6540d9072e621641f4e4550f6b4a973f.png" src="_images/75b806e6ab3811a9ff1137626d1551da6540d9072e621641f4e4550f6b4a973f.png" />
</div>
</div>
</section>
<hr class="docutils" />
<section id="measures-of-association">
<h2>Measures of Association<a class="headerlink" href="#measures-of-association" title="Link to this heading">#</a></h2>
<hr class="docutils" />
<p>Association measures help identify patterns for forecasting:</p>
<section id="autocorrelation-acf">
<h3>1. Autocorrelation (ACF)<a class="headerlink" href="#autocorrelation-acf" title="Link to this heading">#</a></h3>
<p><strong>Definition</strong>: Autocorrelation measures the correlation between a time series and a lagged version of itself. It quantifies how values at time <span class="math notranslate nohighlight">\( t \)</span> relate to values at time <span class="math notranslate nohighlight">\( t+k \)</span>, where <span class="math notranslate nohighlight">\( k \)</span> is the lag. ACF is essential for detecting repeating patterns (e.g., seasonality) or dependencies in the data.</p>
<p><strong>Mathematical Formula</strong>:
$<span class="math notranslate nohighlight">\(
\rho(k) = \frac{\sum_{t=1}^{T-k} (x_t - \bar{x})(x_{t+k} - \bar{x})}{\sum_{t=1}^T (x_t - \bar{x})^2}
\)</span>$</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( x_t \)</span>: Time series value at time <span class="math notranslate nohighlight">\( t \)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\( \bar{x} \)</span>: Mean of the time series.</p></li>
<li><p><span class="math notranslate nohighlight">\( k \)</span>: Lag (number of time steps).</p></li>
<li><p><span class="math notranslate nohighlight">\( T \)</span>: Total number of observations.</p></li>
<li><p>The numerator is the covariance between the series and its lagged version, adjusted for the mean.</p></li>
<li><p>The denominator is the variance of the series, normalizing the correlation to range between -1 and 1.</p></li>
</ul>
<p><strong>Interpretation</strong>:</p>
<ul class="simple">
<li><p><strong>Positive ACF</strong> at lag <span class="math notranslate nohighlight">\( k \)</span>: Indicates that higher (or lower) values at time <span class="math notranslate nohighlight">\( t \)</span> are associated with higher (or lower) values at time <span class="math notranslate nohighlight">\( t+k \)</span>.</p></li>
<li><p><strong>Negative ACF</strong>: Suggests an inverse relationship.</p></li>
<li><p><strong>Significant spikes</strong> in the ACF plot (outside confidence intervals, typically 95%) indicate meaningful correlations.</p></li>
<li><p><strong>Seasonality</strong>: For monthly data, a significant spike at lag 12 suggests annual seasonality.</p></li>
<li><p><strong>Trends</strong>: Slowly decaying ACF values often indicate a non-stationary series with a trend.</p></li>
</ul>
<p><strong>Use in Forecasting</strong>:</p>
<ul class="simple">
<li><p>ACF helps identify the order of autoregressive (AR) or moving average (MA) components in ARIMA models.</p></li>
<li><p>Seasonal spikes guide the inclusion of seasonal terms in models like SARIMA.</p></li>
</ul>
</section>
<section id="partial-autocorrelation-pacf">
<h3>2. Partial Autocorrelation (PACF)<a class="headerlink" href="#partial-autocorrelation-pacf" title="Link to this heading">#</a></h3>
<p><strong>Definition</strong>: PACF measures the correlation between a time series and its lagged values at lag <span class="math notranslate nohighlight">\( k \)</span>, after removing the effects of all earlier lags (1, 2, …, <span class="math notranslate nohighlight">\( k-1 \)</span>). It isolates the direct relationship at lag <span class="math notranslate nohighlight">\( k \)</span>.</p>
<p><strong>Calculation</strong>:</p>
<ul class="simple">
<li><p>PACF is typically computed using methods like the Yule-Walker equations or regression techniques. For lag <span class="math notranslate nohighlight">\( k \)</span>, it represents the correlation of <span class="math notranslate nohighlight">\( x_t \)</span> and <span class="math notranslate nohighlight">\( x_{t+k} \)</span> after regressing both on <span class="math notranslate nohighlight">\( x_{t+1}, x_{t+2}, ..., x_{t+k-1} \)</span> and removing their influence.</p></li>
<li><p>Mathematically, for an autoregressive process, PACF at lag <span class="math notranslate nohighlight">\( k \)</span> corresponds to the coefficient <span class="math notranslate nohighlight">\( \phi_k \)</span> in the AR(k) model:
$<span class="math notranslate nohighlight">\(
x_t = \phi_1 x_{t-1} + \phi_2 x_{t-2} + \cdots + \phi_k x_{t-k} + \epsilon_t
\)</span>$</p></li>
</ul>
<p><strong>Interpretation</strong>:</p>
<ul class="simple">
<li><p><strong>Significant PACF</strong> at lag <span class="math notranslate nohighlight">\( k \)</span>: Indicates a direct relationship at that lag, useful for determining the order of an AR model.</p></li>
<li><p><strong>Zero PACF</strong> beyond a certain lag: Suggests that higher lags don’t contribute directly to the series (common in AR processes).</p></li>
<li><p><strong>Seasonal patterns</strong>: In seasonal data, PACF may show spikes at seasonal lags (e.g., lag 12 for monthly data).</p></li>
</ul>
<p><strong>Use in Forecasting</strong>:</p>
<ul class="simple">
<li><p>PACF is critical for specifying the AR order in ARIMA models. For example, if PACF is significant at lags 1 and 2 but near zero beyond, an AR(2) model may be appropriate.</p></li>
<li><p>It helps distinguish direct effects from indirect correlations propagated through earlier lags.</p></li>
</ul>
</section>
<section id="cross-correlation">
<h3>3. Cross-Correlation<a class="headerlink" href="#cross-correlation" title="Link to this heading">#</a></h3>
<p><strong>Definition</strong>: Cross-correlation measures the correlation between two different time series (or a time series and an external variable) at various lags. It’s used to identify whether one series leads or lags another, which is valuable when incorporating predictors in forecasting.</p>
<p><strong>Mathematical Formula</strong>:
For two series <span class="math notranslate nohighlight">\( x_t \)</span> and <span class="math notranslate nohighlight">\( y_t \)</span>, the cross-correlation at lag <span class="math notranslate nohighlight">\( k \)</span> is:
$<span class="math notranslate nohighlight">\(
\text{CCF}(k) = \frac{\sum_{t=1}^{T-k} (x_t - \bar{x})(y_{t+k} - \bar{y})}{\sqrt{\sum_{t=1}^T (x_t - \bar{x})^2 \sum_{t=1}^T (y_t - \bar{y})^2}}
\)</span>$</p>
<ul class="simple">
<li><p>Positive <span class="math notranslate nohighlight">\( k \)</span>: <span class="math notranslate nohighlight">\( y_t \)</span> leads <span class="math notranslate nohighlight">\( x_t \)</span>.</p></li>
<li><p>Negative <span class="math notranslate nohighlight">\( k \)</span>: <span class="math notranslate nohighlight">\( x_t \)</span> leads <span class="math notranslate nohighlight">\( y_t \)</span>.</p></li>
<li><p>The denominator normalizes by the standard deviations of both series.</p></li>
</ul>
<p><strong>Interpretation</strong>:</p>
<ul class="simple">
<li><p>A significant peak at lag <span class="math notranslate nohighlight">\( k \)</span> indicates that <span class="math notranslate nohighlight">\( y_{t+k} \)</span> is correlated with <span class="math notranslate nohighlight">\( x_t \)</span>.</p></li>
<li><p>For example, if the cross-correlation between sales (<span class="math notranslate nohighlight">\( x_t \)</span>) and advertising spend (<span class="math notranslate nohighlight">\( y_t \)</span>) peaks at lag 2, advertising may influence sales with a two-period delay.</p></li>
</ul>
<p><strong>Use in Forecasting</strong>:</p>
<ul class="simple">
<li><p>Cross-correlation identifies external variables (e.g., economic indicators, weather) that improve forecast accuracy.</p></li>
<li><p>It informs the structure of models like VAR (Vector Autoregression) or transfer function models.</p></li>
</ul>
<p><strong>Challenges</strong>:</p>
<ul class="simple">
<li><p>Spurious correlations can arise if both series have trends or seasonality. Pre-whitening (e.g., differencing or fitting an ARIMA model) is often needed to isolate true relationships.</p></li>
<li><p>Stationarity of both series is typically required for reliable results.</p></li>
</ul>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.graphics.tsaplots</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_acf</span><span class="p">,</span> <span class="n">plot_pacf</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.tsa.stattools</span><span class="w"> </span><span class="kn">import</span> <span class="n">ccf</span>

<span class="c1"># Generate synthetic time series with seasonality</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">trend</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">t</span>
<span class="n">seasonality</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span> <span class="o">/</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">trend</span> <span class="o">+</span> <span class="n">seasonality</span> <span class="o">+</span> <span class="n">noise</span>

<span class="c1"># Generate an external variable (e.g., advertising spend) correlated with X</span>
<span class="n">Y</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">98</span><span class="p">)</span>  <span class="c1"># Lagged effect at lag 2</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Y</span><span class="p">])</span>  <span class="c1"># Align lengths</span>

<span class="c1"># Plot time series and external variable</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Time Series (X)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;External Variable (Y)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Time Series and External Variable&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Value&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># ACF plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plot_acf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">(),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Autocorrelation Function (ACF)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Lag 12 (Seasonal)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Lag&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Correlation&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># PACF plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plot_pacf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">(),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Partial Autocorrelation Function (PACF)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Lag 12 (Seasonal)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Lag&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Correlation&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Cross-correlation plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">lags</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">ccf_values</span> <span class="o">=</span> <span class="n">ccf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">adjusted</span><span class="o">=</span><span class="kc">False</span><span class="p">)[:</span><span class="n">lags</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Positive lags only</span>
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">lags</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">ccf_values</span><span class="p">,</span> <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">1.96</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=-</span><span class="mf">1.96</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Lag 2 (Peak)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Cross-Correlation (X vs. Y)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Lag&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Correlation&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;measures_association_enhanced.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2fc49310cb9e10ddc9396cbe91b52701d7d6ed02431cb89b02a2f5d8603d87b2.png" src="_images/2fc49310cb9e10ddc9396cbe91b52701d7d6ed02431cb89b02a2f5d8603d87b2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.graphics.tsaplots</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_acf</span><span class="p">,</span> <span class="n">plot_pacf</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.tsa.stattools</span><span class="w"> </span><span class="kn">import</span> <span class="n">ccf</span>

<span class="c1"># Generate synthetic retail sales data (84 months, Jan 2018 - Dec 2024)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">84</span><span class="p">)</span>
<span class="n">trend</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">t</span>  <span class="c1"># Slight upward trend: $300/month increase</span>
<span class="n">seasonality</span> <span class="o">=</span> <span class="mi">60</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span> <span class="o">/</span> <span class="mi">12</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>  <span class="c1"># Peak in December</span>
<span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">84</span><span class="p">)</span>  <span class="c1"># Random noise</span>
<span class="n">sales</span> <span class="o">=</span> <span class="mi">120</span> <span class="o">+</span> <span class="n">trend</span> <span class="o">+</span> <span class="n">seasonality</span> <span class="o">+</span> <span class="n">noise</span>  <span class="c1"># Baseline sales $~$$120K</span>

<span class="c1"># Generate marketing spend, peaking in Oct/Nov</span>
<span class="n">marketing</span> <span class="o">=</span> <span class="mi">30</span> <span class="o">+</span> <span class="mi">15</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">12</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">84</span><span class="p">)</span>
<span class="c1"># Marketing affects sales with lag 2 (strong) and lag 1 (weak)</span>
<span class="n">sales</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">marketing</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">marketing</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Create DataFrame with dates</span>
<span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s1">&#39;2018-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">84</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Sales&#39;</span><span class="p">:</span> <span class="n">sales</span><span class="p">,</span> <span class="s1">&#39;Marketing&#39;</span><span class="p">:</span> <span class="n">marketing</span><span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="n">dates</span><span class="p">)</span>

<span class="c1"># Plot time series and measures of association</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="c1"># Time series plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Sales&#39;</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sales ($K)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Marketing&#39;</span><span class="p">],</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Marketing Spend ($K)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Monthly Retail Sales and Marketing Spend (2018–2024)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amount ($K)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># ACF plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plot_acf</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Sales&#39;</span><span class="p">],</span> <span class="n">lags</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">(),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Autocorrelation Function (Sales)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Lag 12 (Seasonal Period)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Lag (Months)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Correlation&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="s1">&#39;Confirms 12-month seasonality</span><span class="se">\n</span><span class="s1">for Holt-Winters&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="c1"># PACF plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plot_pacf</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Sales&#39;</span><span class="p">],</span> <span class="n">lags</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">(),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Partial Autocorrelation Function (Sales)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Lag 12 (Seasonal)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Lag (Months)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Correlation&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="s1">&#39;Minimal short-term AR effects</span><span class="se">\n</span><span class="s1">Suitable for Holt-Winters&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="c1"># Cross-correlation plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">lags</span> <span class="o">=</span> <span class="mi">24</span>
<span class="n">ccf_values</span> <span class="o">=</span> <span class="n">ccf</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Sales&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Marketing&#39;</span><span class="p">],</span> <span class="n">adjusted</span><span class="o">=</span><span class="kc">False</span><span class="p">)[:</span><span class="n">lags</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Positive lags</span>
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">lags</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">ccf_values</span><span class="p">,</span> <span class="n">basefmt</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">1.96</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;95% CI&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=-</span><span class="mf">1.96</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Lag 2 (Marketing Effect)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Cross-Correlation (Sales vs. Marketing Spend)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Lag (Months)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Correlation&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;Marketing impacts sales</span><span class="se">\n</span><span class="s1">at lag 2 for forecast adjustments&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;measures_association_holt_winters.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/93/7lt42x5j7m39kz7wxbcghvrm0000gn/T/ipykernel_25888/3346886218.py:21: FutureWarning: &#39;M&#39; is deprecated and will be removed in a future version, please use &#39;ME&#39; instead.
  dates = pd.date_range(start=&#39;2018-01-01&#39;, periods=84, freq=&#39;M&#39;)
</pre></div>
</div>
<img alt="_images/5c4cfd4ea62c050da7da4c46b426e40893bb39df8a38f52639069e97a08d2982.png" src="_images/5c4cfd4ea62c050da7da4c46b426e40893bb39df8a38f52639069e97a08d2982.png" />
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="analyzing-distributions-for-forecasting">
<h2>Analyzing Distributions for Forecasting<a class="headerlink" href="#analyzing-distributions-for-forecasting" title="Link to this heading">#</a></h2>
<hr class="docutils" />
<p>Analyzing the distributions of a time series and its forecast residuals is critical to validate the assumptions of forecasting models like Holt-Winters, which relies on stable patterns and well-behaved errors for accurate predictions. The key aspects—stationarity, residual normality, skewness, and outliers—help diagnose model fit and ensure reliable forecasts. Here’s a deeper explanation of each:</p>
<ol class="arabic simple">
<li><p><strong>Stationarity</strong>:</p>
<ul class="simple">
<li><p><strong>Definition</strong>: A time series is stationary if its statistical properties (mean, variance, autocorrelation) are constant over time. Holt-Winters assumes weak stationarity in the seasonal and residual components after accounting for trend and seasonality.</p></li>
<li><p><strong>Why It Matters</strong>: Non-stationary data (e.g., with trends or changing variance) can lead to unreliable forecasts, as Holt-Winters may fail to capture evolving patterns. For example, a strong trend requires the trend component to be modeled correctly.</p></li>
<li><p><strong>Testing</strong>: The <strong>Augmented Dickey-Fuller (ADF) test</strong> assesses stationarity:</p>
<ul>
<li><p>Null hypothesis (<span class="math notranslate nohighlight">\( H_0 \)</span>): The series has a unit root (non-stationary).</p></li>
<li><p>Alternative hypothesis (<span class="math notranslate nohighlight">\( H_1 \)</span>): The series is stationary.</p></li>
<li><p>A low p-value (&lt; 0.05) rejects <span class="math notranslate nohighlight">\( H_0 \)</span>, indicating stationarity.</p></li>
</ul>
</li>
<li><p><strong>Application</strong>: For Holt-Winters, apply the ADF test to the differenced series (e.g., after removing trend and seasonality) to confirm that residuals or deseasonalized data are stationary.</p></li>
</ul>
</li>
<li><p><strong>Residual Normality</strong>:</p>
<ul class="simple">
<li><p><strong>Definition</strong>: Residuals (forecast errors, <span class="math notranslate nohighlight">\( e_t = x_t - \hat{x}_t \)</span>) should ideally follow a normal distribution with mean zero for valid confidence intervals and statistical inference.</p></li>
<li><p><strong>Why It Matters</strong>: Non-normal residuals (e.g., skewed or heavy-tailed) suggest model misspecification, such as unmodeled patterns or outliers, which can distort prediction intervals. Holt-Winters assumes residuals are approximately normal to produce reliable uncertainty estimates.</p></li>
<li><p><strong>Testing</strong>: Use a <strong>Q-Q plot</strong> to visually check normality (points should align with a straight line) or statistical tests like Shapiro-Wilk (though less common in time series due to autocorrelation).</p></li>
<li><p><strong>Application</strong>: If residuals deviate from normality, consider adjusting the Holt-Winters model (e.g., switching from additive to multiplicative seasonality) or preprocessing the data (e.g., log transformation).</p></li>
</ul>
</li>
<li><p><strong>Skewness</strong>:</p>
<ul class="simple">
<li><p><strong>Definition</strong>: Skewness measures the asymmetry of the residual distribution:
$<span class="math notranslate nohighlight">\(
\text{Skewness} = \frac{\frac{1}{T} \sum_{t=1}^T (e_t - \bar{e})^3}{\sigma_e^3}
\)</span><span class="math notranslate nohighlight">\(
where \)</span> e_t <span class="math notranslate nohighlight">\( is the residual, \)</span> \bar{e} <span class="math notranslate nohighlight">\( is the mean (ideally \)</span>~<span class="math notranslate nohighlight">\(0), and \)</span> \sigma_e $ is the standard deviation.</p>
<ul>
<li><p>Positive skewness: Right tail (overestimation errors).</p></li>
<li><p>Negative skewness: Left tail (underestimation errors).</p></li>
<li><p>Zero skewness: Symmetric distribution.</p></li>
</ul>
</li>
<li><p><strong>Why It Matters</strong>: Skewed residuals indicate bias in the model. For example, right-skewed residuals suggest the model underestimates high sales, which is critical for inventory planning in retail.</p></li>
<li><p><strong>Application</strong>: In Holt-Winters, skewness may signal incorrect seasonality (e.g., additive vs. multiplicative) or unmodeled effects (e.g., external factors like promotions).</p></li>
</ul>
</li>
<li><p><strong>Outliers</strong>:</p>
<ul class="simple">
<li><p><strong>Definition</strong>: Outliers are extreme residuals (e.g., beyond 3 standard deviations) that deviate significantly from the expected pattern.</p></li>
<li><p><strong>Why It Matters</strong>: Outliers can indicate model misspecification (e.g., missing a one-time event like a major sale) or data errors, leading to poor forecasts. Holt-Winters is sensitive to outliers, as they can distort smoothing parameters.</p></li>
<li><p><strong>Testing</strong>: Identify outliers using a residual histogram or boxplot, or flag values beyond a threshold (e.g., <span class="math notranslate nohighlight">\( |e_t| &gt; 3\sigma_e \)</span>).</p></li>
<li><p><strong>Application</strong>: Investigate outliers to determine if they reflect real events (e.g., a Black Friday spike) or errors, and consider robust adjustments (e.g., damping extreme values) or adding external regressors.</p></li>
</ul>
</li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.tsa.stattools</span><span class="w"> </span><span class="kn">import</span> <span class="n">adfuller</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.tsa.holtwinters</span><span class="w"> </span><span class="kn">import</span> <span class="n">ExponentialSmoothing</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">probplot</span><span class="p">,</span> <span class="n">skew</span>

<span class="c1"># Generate synthetic retail sales data (84 months, Jan 2018 - Dec 2024)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">84</span><span class="p">)</span>
<span class="n">trend</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">t</span>  <span class="c1"># Trend: $300/month increase</span>
<span class="n">seasonality</span> <span class="o">=</span> <span class="mi">60</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span> <span class="o">/</span> <span class="mi">12</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>  <span class="c1"># Peak in December</span>
<span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">84</span><span class="p">)</span>  <span class="c1"># Noise</span>
<span class="n">sales</span> <span class="o">=</span> <span class="mi">120</span> <span class="o">+</span> <span class="n">trend</span> <span class="o">+</span> <span class="n">seasonality</span> <span class="o">+</span> <span class="n">noise</span>  <span class="c1"># Baseline $~$$120K</span>
<span class="c1"># Add outliers for Dec 2020 and Dec 2022</span>
<span class="n">sales</span><span class="p">[</span><span class="mi">35</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">20</span>  <span class="c1"># Dec 2020 (index 35)</span>
<span class="n">sales</span><span class="p">[</span><span class="mi">59</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">20</span>  <span class="c1"># Dec 2022 (index 59)</span>

<span class="c1"># Create DataFrame</span>
<span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s1">&#39;2018-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">84</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Sales&#39;</span><span class="p">:</span> <span class="n">sales</span><span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="n">dates</span><span class="p">)</span>

<span class="c1"># Holt-Winters forecast (one-step-ahead)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">ExponentialSmoothing</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Sales&#39;</span><span class="p">],</span> <span class="n">seasonal</span><span class="o">=</span><span class="s1">&#39;mul&#39;</span><span class="p">,</span> <span class="n">seasonal_periods</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">trend</span><span class="o">=</span><span class="s1">&#39;add&#39;</span><span class="p">)</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">forecast</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">fittedvalues</span>

<span class="c1"># Calculate residuals, aligning with valid indices</span>
<span class="n">valid_indices</span> <span class="o">=</span> <span class="n">forecast</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span>
<span class="n">residuals</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Sales&#39;</span><span class="p">][</span><span class="n">valid_indices</span><span class="p">]</span> <span class="o">-</span> <span class="n">forecast</span><span class="p">[</span><span class="n">valid_indices</span><span class="p">]</span>

<span class="c1"># Stationarity test (ADF) on differenced series</span>
<span class="n">adf_result</span> <span class="o">=</span> <span class="n">adfuller</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Sales&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">())</span>
<span class="n">adf_stat</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">adf_result</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">adf_result</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Residual skewness</span>
<span class="n">skewness</span> <span class="o">=</span> <span class="n">skew</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span>

<span class="c1"># Outlier detection</span>
<span class="n">std_residuals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span>
<span class="n">outliers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">2.5</span> <span class="o">*</span> <span class="n">std_residuals</span>
<span class="n">outlier_count</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">outliers</span><span class="p">)</span>

<span class="c1"># Plot analysis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># Time series and forecast</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Sales&#39;</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sales ($K)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">forecast</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Holt-Winters Forecast&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Retail Sales and Holt-Winters Forecast (2018–2024)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Sales ($K)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Q-Q plot for normality</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">probplot</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="s2">&quot;norm&quot;</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="n">plt</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Residual Q-Q Plot</span><span class="se">\n</span><span class="s1">ADF: </span><span class="si">{</span><span class="n">adf_stat</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">, p-value: </span><span class="si">{</span><span class="n">p_value</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">, Skewness: </span><span class="si">{</span><span class="n">skewness</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;Near-normal residuals</span><span class="se">\n</span><span class="s1">Valid for Holt-Winters CIs&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Residual histogram for outliers</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">residuals</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Residuals&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mf">2.5</span> <span class="o">*</span> <span class="n">std_residuals</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;±2.5σ (</span><span class="si">{</span><span class="n">outlier_count</span><span class="si">}</span><span class="s1"> outliers)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span> <span class="o">*</span> <span class="n">std_residuals</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Residual Histogram&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Residual ($K)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Outliers suggest</span><span class="se">\n</span><span class="s1">unmodeled events&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;analyze_distributions_holt_winters.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/93/7lt42x5j7m39kz7wxbcghvrm0000gn/T/ipykernel_25888/1870635950.py:20: FutureWarning: &#39;M&#39; is deprecated and will be removed in a future version, please use &#39;ME&#39; instead.
  dates = pd.date_range(start=&#39;2018-01-01&#39;, periods=84, freq=&#39;M&#39;)
</pre></div>
</div>
<img alt="_images/00b24018dfbad5bd8a60581f12c8be9977c48c668f750c4650affc58d273d57b.png" src="_images/00b24018dfbad5bd8a60581f12c8be9977c48c668f750c4650affc58d273d57b.png" />
</div>
</div>
<hr class="docutils" />
<section id="data-reduction">
<h3>17. Data Reduction<a class="headerlink" href="#data-reduction" title="Link to this heading">#</a></h3>
<hr class="docutils" />
<ul class="simple">
<li><p><strong>Dropping Unnecessary Columns</strong>:</p>
<ul>
<li><p>Remove features with no predictive value (e.g., constant variables, irrelevant metadata).</p></li>
<li><p>Example: Drop store ID if forecasting total chain sales.</p></li>
</ul>
</li>
<li><p><strong>Aggregating Data</strong>:</p>
<ul>
<li><p>Convert high-frequency data (e.g., daily sales) to a lower frequency (e.g., monthly) to match Holt-Winters’ seasonal period (e.g., 12 months).</p></li>
<li><p>Smooths noise while preserving seasonality.</p></li>
</ul>
</li>
<li><p><strong>Feature Selection</strong>:</p>
<ul>
<li><p>Select features with strong correlations to the target (e.g., sales) or lagged effects (e.g., marketing spend at lag 2, as identified by cross-correlation).</p></li>
<li><p>Use correlation analysis or variance thresholds to keep relevant predictors.</p></li>
</ul>
</li>
<li><p><strong>Principal Component Analysis (PCA)</strong>: summarizing correlated data into a few key patterns</p>
<ul>
<li><p>Reduce multiple correlated features (e.g., financial indicators, marketing channels) into fewer components that capture most variance.</p></li>
<li><p>Useful when external regressors (e.g., marketing, promotions) are considered alongside Holt-Winters.</p></li>
</ul>
</li>
<li><p><strong>Binning (Numerosity Reduction)</strong>:</p>
<ul>
<li><p>Group continuous variables (e.g., customer age, sales volume) into categories to reduce noise and simplify analysis.</p></li>
<li><p>Example: Bin daily sales into weekly averages to stabilize fluctuations.</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.decomposition</span><span class="w"> </span><span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.feature_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">SelectKBest</span><span class="p">,</span> <span class="n">f_regression</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.tsa.holtwinters</span><span class="w"> </span><span class="kn">import</span> <span class="n">ExponentialSmoothing</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>

<span class="c1"># Suppress warnings for cleaner output (e.g., Holt-Winters convergence)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">UserWarning</span><span class="p">)</span>

<span class="c1"># 1. Generate synthetic daily retail sales data (2018–2024)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s1">&#39;2018-01-01&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;2024-12-31&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dates</span><span class="p">)</span>  <span class="c1"># ~2557 days</span>
<span class="c1"># Sales: trend, annual seasonality (Dec peaks), noise</span>
<span class="n">trend</span> <span class="o">=</span> <span class="mf">0.0001</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>  <span class="c1"># ~$10K/year</span>
<span class="n">seasonality</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">%</span> <span class="mf">365.25</span><span class="p">)</span> <span class="o">/</span> <span class="mf">365.25</span><span class="p">)</span>  <span class="c1"># Dec ~$8K</span>
<span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">sales</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">+</span> <span class="n">trend</span> <span class="o">+</span> <span class="n">seasonality</span> <span class="o">+</span> <span class="n">noise</span>  <span class="c1"># Daily ~$3K–$8K</span>
<span class="c1"># Features</span>
<span class="n">marketing</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">%</span> <span class="mf">365.25</span> <span class="o">-</span> <span class="mi">60</span><span class="p">)</span> <span class="o">/</span> <span class="mf">365.25</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">traffic</span> <span class="o">=</span> <span class="mi">7</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">marketing</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>  <span class="c1"># Correlated</span>
<span class="n">discounts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>  <span class="c1"># Weakly correlated</span>
<span class="n">store_id</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Store1&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span>  <span class="c1"># Constant</span>

<span class="c1"># Create daily DataFrame</span>
<span class="n">df_daily</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Date&#39;</span><span class="p">:</span> <span class="n">dates</span><span class="p">,</span> <span class="s1">&#39;Sales&#39;</span><span class="p">:</span> <span class="n">sales</span><span class="p">,</span> <span class="s1">&#39;Marketing&#39;</span><span class="p">:</span> <span class="n">marketing</span><span class="p">,</span>
    <span class="s1">&#39;Traffic&#39;</span><span class="p">:</span> <span class="n">traffic</span><span class="p">,</span> <span class="s1">&#39;Discounts&#39;</span><span class="p">:</span> <span class="n">discounts</span><span class="p">,</span> <span class="s1">&#39;StoreID&#39;</span><span class="p">:</span> <span class="n">store_id</span>
<span class="p">})</span>

<span class="c1"># 2. Data Reduction: Drop unnecessary columns</span>
<span class="c1"># Identify constant columns</span>
<span class="n">constant_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df_daily</span> <span class="k">if</span> <span class="n">df_daily</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
<span class="k">if</span> <span class="n">constant_cols</span><span class="p">:</span>
    <span class="n">df_reduced</span> <span class="o">=</span> <span class="n">df_daily</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">constant_cols</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dropped constant columns: </span><span class="si">{</span><span class="n">constant_cols</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">df_reduced</span> <span class="o">=</span> <span class="n">df_daily</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No constant columns to drop&quot;</span><span class="p">)</span>

<span class="c1"># 3. Data Reduction: Aggregate to monthly (Holt-Winters s=12)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">df_reduced</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_reduced</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">])</span>
    <span class="n">df_monthly</span> <span class="o">=</span> <span class="n">df_reduced</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">df_reduced</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">to_period</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span>
        <span class="s1">&#39;Sales&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span>  <span class="c1"># Monthly ~$80K–$200K</span>
        <span class="s1">&#39;Marketing&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Traffic&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Discounts&#39;</span><span class="p">:</span> <span class="s1">&#39;mean&#39;</span>
    <span class="p">})</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="n">df_monthly</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_monthly</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">to_timestamp</span><span class="p">()</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error in aggregation: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 4. Data Reduction: Feature selection (correlation-based)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df_monthly</span><span class="p">[[</span><span class="s1">&#39;Marketing&#39;</span><span class="p">,</span> <span class="s1">&#39;Traffic&#39;</span><span class="p">,</span> <span class="s1">&#39;Discounts&#39;</span><span class="p">]]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df_monthly</span><span class="p">[</span><span class="s1">&#39;Sales&#39;</span><span class="p">]</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">selector</span> <span class="o">=</span> <span class="n">SelectKBest</span><span class="p">(</span><span class="n">f_regression</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">X_selected</span> <span class="o">=</span> <span class="n">selector</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">selected_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">selector</span><span class="o">.</span><span class="n">get_support</span><span class="p">()]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>  <span class="c1"># Marketing, Traffic</span>
    <span class="n">df_selected</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_selected</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">selected_features</span><span class="p">)</span>
    <span class="n">df_selected</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_monthly</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span>
    <span class="n">df_selected</span><span class="p">[</span><span class="s1">&#39;Sales&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_monthly</span><span class="p">[</span><span class="s1">&#39;Sales&#39;</span><span class="p">]</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error in feature selection: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 5. Data Reduction: PCA on selected features (marketing, traffic)</span>
<span class="c1"># PCA reduces external features, NOT sales</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
    <span class="n">X_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df_selected</span><span class="p">[[</span><span class="s1">&#39;Marketing&#39;</span><span class="p">,</span> <span class="s1">&#39;Traffic&#39;</span><span class="p">]])</span>
    <span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>  <span class="c1"># Keep 95% variance</span>
    <span class="n">X_pca</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">)</span>
    <span class="n">df_pca</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;PC1&#39;</span><span class="p">:</span> <span class="n">X_pca</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;Date&#39;</span><span class="p">:</span> <span class="n">df_monthly</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]})</span>
    <span class="n">explained_variance</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error in PCA: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 6. Data Reduction: Binning sales for interpretation</span>
<span class="c1"># Binning applies to sales (target), NOT related to PCA</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">df_monthly</span><span class="p">[</span><span class="s1">&#39;Sales_Bin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">df_monthly</span><span class="p">[</span><span class="s1">&#39;Sales&#39;</span><span class="p">],</span> 
                                     <span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">300</span><span class="p">],</span> 
                                     <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Low&#39;</span><span class="p">,</span> <span class="s1">&#39;Medium&#39;</span><span class="p">,</span> <span class="s1">&#39;High&#39;</span><span class="p">])</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error in binning: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 7. Holt-Winters forecast on monthly sales</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">df_monthly</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">ExponentialSmoothing</span><span class="p">(</span><span class="n">df_monthly</span><span class="p">[</span><span class="s1">&#39;Sales&#39;</span><span class="p">],</span> 
                                <span class="n">seasonal</span><span class="o">=</span><span class="s1">&#39;mul&#39;</span><span class="p">,</span> 
                                <span class="n">seasonal_periods</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> 
                                <span class="n">trend</span><span class="o">=</span><span class="s1">&#39;add&#39;</span><span class="p">)</span>
    <span class="n">fit</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
    <span class="n">forecast</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">fittedvalues</span>
    <span class="c1"># Forecast for 2025</span>
    <span class="n">forecast_2025</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">forecast_dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s1">&#39;2025-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;ME&#39;</span><span class="p">)</span>
    <span class="n">df_forecast</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Forecast&#39;</span><span class="p">:</span> <span class="n">forecast_2025</span><span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="n">forecast_dates</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error in Holt-Winters forecasting: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 8. Plot results (4 panels for clarity)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>

<span class="c1"># Panel 1: Daily vs. Monthly Sales (Aggregation)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_daily</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">],</span> <span class="n">df_daily</span><span class="p">[</span><span class="s1">&#39;Sales&#39;</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Daily Sales ($K)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_monthly</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df_monthly</span><span class="p">[</span><span class="s1">&#39;Sales&#39;</span><span class="p">],</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Monthly Sales ($K)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Aggregation: Daily to Monthly Sales&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Sales ($K)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">df_monthly</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="mi">200</span><span class="p">,</span> <span class="s1">&#39;Monthly data reduces noise,</span><span class="se">\n</span><span class="s1">preserves 12-month seasonality</span><span class="se">\n</span><span class="s1">for Holt-Winters&#39;</span><span class="p">,</span> 
         <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># Panel 2: Selected Features</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_selected</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">],</span> <span class="n">df_selected</span><span class="p">[</span><span class="s1">&#39;Marketing&#39;</span><span class="p">],</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Marketing ($K)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_selected</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">],</span> <span class="n">df_selected</span><span class="p">[</span><span class="s1">&#39;Traffic&#39;</span><span class="p">],</span> <span class="s1">&#39;m-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Traffic (K visitors)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Selected Features: </span><span class="si">{</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">selected_features</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Value&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">df_selected</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">][</span><span class="mi">10</span><span class="p">],</span> <span class="mi">50</span><span class="p">,</span> <span class="s1">&#39;Correlated with sales,</span><span class="se">\n</span><span class="s1">use for post-forecast adjustments&#39;</span><span class="p">,</span> 
         <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># Panel 3: PCA on Features</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_pca</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">],</span> <span class="n">df_pca</span><span class="p">[</span><span class="s1">&#39;PC1&#39;</span><span class="p">],</span> <span class="s1">&#39;c-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;PC1 (</span><span class="si">{</span><span class="n">explained_variance</span><span class="si">:</span><span class="s1">.1%</span><span class="si">}</span><span class="s1"> variance)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;PCA: Reduced Features (Marketing, Traffic)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;PC1 Value&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">df_pca</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">][</span><span class="mi">10</span><span class="p">],</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;PCA combines marketing &amp; traffic</span><span class="se">\n</span><span class="s1">into one predictor for adjustments&#39;</span><span class="p">,</span> 
         <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># Panel 4: Holt-Winters Forecast with Binned Sales</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_monthly</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df_monthly</span><span class="p">[</span><span class="s1">&#39;Sales&#39;</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Monthly Sales ($K)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_monthly</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">forecast</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Holt-Winters Fitted&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_forecast</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df_forecast</span><span class="p">[</span><span class="s1">&#39;Forecast&#39;</span><span class="p">],</span> <span class="s1">&#39;g--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;2025 Forecast&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">df_monthly</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">df_monthly</span><span class="p">[</span><span class="s1">&#39;Sales_Bin&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">codes</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sales Bin&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Low&#39;</span><span class="p">,</span> <span class="s1">&#39;Medium&#39;</span><span class="p">,</span> <span class="s1">&#39;High&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Holt-Winters Forecast and Binned Sales&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Sales Bin&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">df_monthly</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;Binning categorizes sales</span><span class="se">\n</span><span class="s1">for stakeholder reports,</span><span class="se">\n</span><span class="s1">forecast uses raw sales&#39;</span><span class="p">,</span> 
         <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Print summary for teaching</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data Reduction Summary:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Original: </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2"> daily records, 5 features&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- After dropping: Removed </span><span class="si">{</span><span class="n">constant_cols</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- After aggregation: 84 monthly records&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Selected features: </span><span class="si">{</span><span class="n">selected_features</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- PCA: 1 component (marketing, traffic), </span><span class="si">{</span><span class="n">explained_variance</span><span class="si">:</span><span class="s2">.1%</span><span class="si">}</span><span class="s2"> variance&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Binning: Sales categorized as Low (&lt;$100K), Medium ($100K–$150K), High (&gt;$150K)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- Holt-Winters: Forecasted 2025 sales, e.g., Dec 2025 ~$</span><span class="si">{</span><span class="n">df_forecast</span><span class="p">[</span><span class="s1">&#39;Forecast&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">K&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dropped constant columns: [&#39;StoreID&#39;]
</pre></div>
</div>
<img alt="_images/c1578f32a54779e82b78fcd5050a2736afccf1a8b1c1926f2748544a98db5df5.png" src="_images/c1578f32a54779e82b78fcd5050a2736afccf1a8b1c1926f2748544a98db5df5.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Data Reduction Summary:
- Original: 2557 daily records, 5 features
- After dropping: Removed [&#39;StoreID&#39;]
- After aggregation: 84 monthly records
- Selected features: [&#39;Marketing&#39;, &#39;Traffic&#39;]
- PCA: 1 component (marketing, traffic), 84.2% variance
- Binning: Sales categorized as Low (&lt;$100K), Medium ($100K–$150K), High (&gt;$150K)
- Holt-Winters: Forecasted 2025 sales, e.g., Dec 2025 ~$nanK
</pre></div>
</div>
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="pareto-analysis-80-20-rule">
<h2>18. Pareto Analysis (80/20 Rule)<a class="headerlink" href="#pareto-analysis-80-20-rule" title="Link to this heading">#</a></h2>
<hr class="docutils" />
<p><strong>Definition:</strong> Pareto analysis is used to identify the most important factors contributing to an outcome.<br />
In finance, it often reveals that <strong>20% of assets contribute to 80% of returns or risk</strong>.</p>
<ul class="simple">
<li><p><strong>Description</strong>: Applying the 80/20 rule to identify key contributors.</p></li>
<li><p><strong>Relevance</strong>: Prioritizes focus in forecasting (e.g., key products driving revenue).</p></li>
<li><p><strong>Related Concepts</strong>:</p>
<ul>
<li><p><strong>Cumulative Distribution</strong>: Visualizing contribution.</p></li>
<li><p><strong>Decision-Making</strong>: Using Pareto for resource allocation.</p></li>
</ul>
</li>
<li><p><strong>Example</strong>: Finding that 20% of customers generate 80% of sales.</p></li>
<li><p><strong>Mathematical Context</strong>: Cumulative percentage: <span class="math notranslate nohighlight">\( C_i = \sum_{j=1}^i x_j / \sum_{j=1}^n x_j \)</span>.</p></li>
<li><p><strong>Teaching Tip</strong>: Create a Pareto chart in Excel and discuss its business applications.</p></li>
</ul>
<section id="steps">
<h3>Steps:<a class="headerlink" href="#steps" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Sort values in descending order.</p></li>
<li><p>Calculate cumulative sum and percentage.</p></li>
<li><p>Visualize with a Pareto chart.</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
\text{Cumulative \%} = \frac{\text{Cumulative Sum}}{\text{Total Sum}} \times 100
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Assuming df_sorted is already created with &#39;Stock&#39;, &#39;Return&#39;, &#39;Cumulative Return&#39;, and &#39;Cumulative %&#39;</span>
<span class="c1"># If not, here&#39;s how to prepare the data (example):</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Stock&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;AAPL&#39;</span><span class="p">,</span> <span class="s1">&#39;MSFT&#39;</span><span class="p">,</span> <span class="s1">&#39;GOOGL&#39;</span><span class="p">,</span> <span class="s1">&#39;TSLA&#39;</span><span class="p">,</span> <span class="s1">&#39;AMZN&#39;</span><span class="p">,</span> <span class="s1">&#39;FB&#39;</span><span class="p">,</span> <span class="s1">&#39;NFLX&#39;</span><span class="p">,</span> <span class="s1">&#39;NVDA&#39;</span><span class="p">],</span>
        <span class="s1">&#39;Return&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5000</span><span class="p">,</span> <span class="mi">4500</span><span class="p">,</span> <span class="mi">3000</span><span class="p">,</span> <span class="mi">2500</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">1500</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">500</span><span class="p">]}</span>
<span class="n">df_sorted</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">df_sorted</span><span class="p">[</span><span class="s1">&#39;Cumulative Return&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_sorted</span><span class="p">[</span><span class="s1">&#39;Return&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
<span class="n">df_sorted</span><span class="p">[</span><span class="s1">&#39;Cumulative %&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">df_sorted</span><span class="p">[</span><span class="s1">&#39;Cumulative Return&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df_sorted</span><span class="p">[</span><span class="s1">&#39;Return&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="c1"># Pareto Chart</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>  <span class="c1"># Increased width for better label spacing</span>

<span class="c1"># Bar Chart</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">df_sorted</span><span class="p">[</span><span class="s1">&#39;Stock&#39;</span><span class="p">],</span> <span class="n">df_sorted</span><span class="p">[</span><span class="s1">&#39;Return&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;skyblue&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Stocks&#39;</span><span class="p">)</span>  <span class="c1"># Added x-axis label</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Return ($)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>  <span class="c1"># Specified units for clarity</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>  <span class="c1"># Added grid for readability</span>

<span class="c1"># Line Chart</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_sorted</span><span class="p">[</span><span class="s1">&#39;Stock&#39;</span><span class="p">],</span> <span class="n">df_sorted</span><span class="p">[</span><span class="s1">&#39;Cumulative %&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Cumulative %&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;80% Threshold&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>  <span class="c1"># Added legend for clarity</span>

<span class="c1"># Customize</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Pareto Chart - Stock Returns&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>  <span class="c1"># Vertical labels</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>  <span class="c1"># Adjust layout to prevent clipping</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/60025a2defc7856d86f402629855d2799a549cbd564da5f43c9f6a15a9233f14.png" src="_images/60025a2defc7856d86f402629855d2799a549cbd564da5f43c9f6a15a9233f14.png" />
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Diff_and_integration.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Differentiation and integration</p>
      </div>
    </a>
    <a class="right-next"
       href="level_data_time_series.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Level Data Forecasting Models</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of Contents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data">Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#types-of-data">1. Types of Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#datasets-and-databases">2. Datasets and Databases</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#relational-databases-sql">1. Relational Databases (SQL)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-a-relational-database">What is a Relational Database?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-concepts">Key Concepts</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-data">Example Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#querying-with-sql">Querying with SQL</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-case">Use Case</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nosql-databases">2. NoSQL Databases</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-a-nosql-database">What is a NoSQL Database?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Key Concepts</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Example Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#querying-with-nosql-pseudo-code">Querying with NoSQL (Pseudo-Code)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Use Case</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparing-sql-and-nosql">3. Comparing SQL and NoSQL</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-in-python-pseudo-code">Example in Python (Pseudo-Code)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#why-this-matters">Why This Matters</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#data-selection">3. Data Selection</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-methods">Key Methods:</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#implementation-python"><strong>Implementation (Python)</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id4"><strong>Why This Matters</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-preparation-for-time-series">4. Data Preparation for Time Series</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#imputation">1. Imputation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#normalization-scaling">2. Normalization &amp; Scaling</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#outlier-detection-treatment">3. Outlier Detection &amp; Treatment</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#feature-engineering-for-time-series">4. Feature Engineering for Time Series</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#modifying-data-using-excel">5. Modifying Data Using Excel</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#using-range-names-in-databases">6. Using Range Names in Databases</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#excel-name-manager">Excel Name Manager</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#database-fields-and-naming-conventions-in-sql">Database Fields and Naming Conventions in SQL</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#examples">Examples</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1-excel-named-range-for-financial-calculations">Example 1: Excel Named Range for Financial Calculations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-2-dynamic-named-range-for-growing-data">Example 2: Dynamic Named Range for Growing Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-3-sql-database-field-naming">Example 3: SQL Database Field Naming</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#data-classification">7. Data Classification</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#data-partition">8. Data Partition</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#standard-splits">Standard Splits:</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#data-exploration">9. Data Exploration</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#common-steps-in-time-series-eda">Common Steps in Time Series EDA:</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sorting">10. Sorting</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-applications-in-time-series">Example Applications in Time Series:</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#filtering-data">11. Filtering Data</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#examples-in-time-series">Examples in Time Series:</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Modifying Data using Excel</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-distribution-from-data">12. Creating Distribution from Data</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#common-tools-for-visualizing-distributions">Common Tools for Visualizing Distributions:</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#analyzing-distribution">13. Analyzing Distribution</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tools-for-assessing-distribution-shape">Tools for Assessing Distribution Shape:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-distributions-from-time-series-data-for-forecasting">Creating Distributions from Time Series Data for Forecasting</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#measures-of-location">Measures of Location</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#measures-of-variability">Measures of Variability</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#measures-of-association">Measures of Association</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#autocorrelation-acf">1. Autocorrelation (ACF)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#partial-autocorrelation-pacf">2. Partial Autocorrelation (PACF)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cross-correlation">3. Cross-Correlation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analyzing-distributions-for-forecasting">Analyzing Distributions for Forecasting</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-reduction">17. Data Reduction</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pareto-analysis-80-20-rule">18. Pareto Analysis (80/20 Rule)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#steps">Steps:</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Chandravesh Chaudhari
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>