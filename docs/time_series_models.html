
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>TIME SERIES MODELS &#8212; Machine Learning for Business</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'time_series_models';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Seasonal Data Forecasting Models" href="seasonal_data.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Machine Learning for Business - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Machine Learning for Business - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to Machine Learning for Business Book
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="symbols.html">Common Math Symbols and Notations in Machine Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="1_Linear_regression.html">Linear Regression</a></li>

















<li class="toctree-l1"><a class="reference internal" href="2_Regularization.html">Generalization, Overfitting, Regularization</a></li>



<li class="toctree-l1"><a class="reference internal" href="3_Naive_Bayes.html">Naive Bayes</a></li>



<li class="toctree-l1"><a class="reference internal" href="4_Logistic_Regression.html"><strong>Logistic Regression (Mathematical Explanation)</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="5_Dimensionality_Reduction.html">Dimensionality Reduction: PCA</a></li>






<li class="toctree-l1"><a class="reference internal" href="6_Clustering.html">K-Means and Clustering</a></li>




<li class="toctree-l1"><a class="reference internal" href="7_Gaussian_Mixture_Models.html">Gaussian Mixture Models and EM</a></li>


<li class="toctree-l1"><a class="reference internal" href="8_Nearest_Neighbour_Algorithm.html">Nearest Neighbour Algorithm</a></li>







<li class="toctree-l1"><a class="reference internal" href="10_Support_Vector_Machines.html">Support Vector Machines</a></li>



<li class="toctree-l1"><a class="reference internal" href="11_Decision_Trees.html">Decision Trees</a></li>

<li class="toctree-l1"><a class="reference internal" href="12_Ensemble_Methods.html">Ensemble Methods</a></li>

<li class="toctree-l1"><a class="reference internal" href="13_Neural_Networks.html">Neural Networks: From Perceptron to MLP</a></li>





<li class="toctree-l1"><a class="reference internal" href="14_Arima.html">ARIMA</a></li>





<li class="toctree-l1"><a class="reference internal" href="15_LSTM.html">Advanced DL: ResNets, RNNs</a></li>

<li class="toctree-l1"><a class="reference internal" href="16_CNN.html">Convolutional Neural Networks</a></li>


<li class="toctree-l1"><a class="reference internal" href="17_Resnet.html">1D-ResNet (or TCN)</a></li>
<li class="toctree-l1"><a class="reference internal" href="18_LLM.html">Transformers and LLMs</a></li>

<li class="toctree-l1"><a class="reference internal" href="19_Reinforcement_Learning.html">Reinforcement Learning</a></li>

<li class="toctree-l1"><a class="reference internal" href="20_Multimodal_Learning.html">Multimodal Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="Generative_Models.html">Generative Models</a></li>




<li class="toctree-l1"><a class="reference internal" href="Performance_Metrics.html">Performance Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="Visualization.html">Visualisation</a></li>





<li class="toctree-l1"><a class="reference internal" href="clustering.html">Clustering KNN</a></li>

<li class="toctree-l1"><a class="reference internal" href="descriptive_analytics.html">Descriptive Analytics of Financial Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="Diff_and_integration.html">Differentiation and integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="financial_forecasting.html">FINANCIAL FORECASTING</a></li>
<li class="toctree-l1"><a class="reference internal" href="level_data_time_series.html">Level Data Forecasting Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="Llm_and_transformers.html">LLM Transformers</a></li>











































<li class="toctree-l1"><a class="reference internal" href="Python_crash_course.html">Python Crash Course</a></li>











<li class="toctree-l1"><a class="reference internal" href="seasonal_data.html">Seasonal Data Forecasting Models</a></li>








<li class="toctree-l1 current active"><a class="current reference internal" href="#">TIME SERIES MODELS</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/chandraveshchaudhari/BusinessML_web/blob/main/notebooks//./time_series_models.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>

<li>
  <a href="https://chandraveshchaudhari.github.io/BusinessML_web/jupyterlite/lab/index.html?path=time_series_models.ipynb" target="_blank"
     class="btn btn-sm dropdown-item"
     title="Launch on JupyterLite"
     data-bs-placement="left" data-bs-toggle="tooltip">
    <span class="btn__icon-container" style="display:inline-block; width:20px; height:20px;">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256">
        <circle cx="128" cy="128" r="128" fill="#f37726"/>
        <ellipse cx="128" cy="128" rx="110" ry="40" fill="white" transform="rotate(-25, 128, 128)"/>
        <ellipse cx="128" cy="128" rx="110" ry="40" fill="white" transform="rotate(25, 128, 128)"/>
        <circle cx="200" cy="60" r="18" fill="white"/>
        <circle cx="60" cy="200" r="18" fill="white"/>
      </svg>
    </span>
    <span class="btn__text-container">JupyterLite</span>
  </a>
</li>

</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/chandraveshchaudhari/BusinessML_web" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/chandraveshchaudhari/BusinessML_web/issues/new?title=Issue%20on%20page%20%2Ftime_series_models.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/time_series_models.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>TIME SERIES MODELS</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#topic-components-of-time-series-data">Topic: Components of Time Series Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-are-the-components-of-time-series">1. What are the Components of Time Series?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-in-finance">Use in Finance:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#decomposition-of-time-series-data">2. Decomposition of Time Series Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#decomposition-formula">Decomposition formula:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-model">1. The Model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estimate-the-trend-mathbf-t-t-via-centered-moving-average">2. Estimate the Trend <span class="math notranslate nohighlight">\(\mathbf{T_t}\)</span> via Centered Moving Average</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#detrend-to-expose-seasonality">3. Detrend to Expose Seasonality</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estimate-the-seasonal-indices-mathbf-s-i">4. Estimate the Seasonal Indices <span class="math notranslate nohighlight">\(\mathbf{S_i}\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-the-residuals-mathbf-r-t">5. Compute the Residuals <span class="math notranslate nohighlight">\(\mathbf{R_t}\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#worked-illustration-additive-m-4">6. Worked Illustration (Additive, <span class="math notranslate nohighlight">\(m=4\)</span>)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#topic-average-forecasting-method">Topic: Average Forecasting Method</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#topic-errors-and-error-criterion">Topic: Errors and Error Criterion</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Use in Finance:</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretation-of-results">Interpretation of Results</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#topic-naive-moving-average-and-ses-forecasts">Topic: Naïve, Moving Average, and SES Forecasts</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mathematics-behind-simple-exponential-smoothing-ses"><strong>Mathematics Behind Simple Exponential Smoothing (SES)</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forecasting-equation"><strong>1. Forecasting Equation</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mathematical-intuition"><strong>2. Mathematical Intuition</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recursive-expansion"><strong>3. Recursive Expansion</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#initialization"><strong>4. Initialization</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forecasting-future-values"><strong>5. Forecasting Future Values</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#summary"><strong>Summary</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#topic-diagnostic-tools-for-forecast-evaluation">Topic: Diagnostic Tools for Forecast Evaluation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-residual-analysis">a. <strong>Residual Analysis</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-autocorrelation-function-acf">b. <strong>Autocorrelation Function (ACF)</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-ljung-box-test">c. <strong>Ljung-Box Test</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d-normality-test-of-residuals-shapiro-wilk">d. <strong>Normality Test of Residuals (Shapiro-Wilk)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Interpretation of Results</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#homoscedasticity-and-heteroscedasticity">Homoscedasticity and Heteroscedasticity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#impact-of-heteroscedasticity-on-forecasting-with-simple-exponential-smoothing-ses"><strong>Impact of Heteroscedasticity on Forecasting with Simple Exponential Smoothing (SES)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recap-of-scenarios"><strong>Recap of Scenarios</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-exponential-smoothing-ses"><strong>Simple Exponential Smoothing (SES)</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#effect-of-error-variance-on-ses"><strong>Effect of Error Variance on SES</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#homoscedastic-time-series"><strong>1. Homoscedastic Time Series</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#heteroscedastic-time-series"><strong>2. Heteroscedastic Time Series</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exponential-smoothing-models-in-statsmodels"><strong>Exponential Smoothing Models in <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code></strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3"><strong>1. Simple Exponential Smoothing (SES)</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#holts-linear-trend-method"><strong>2. Holt’s Linear Trend Method</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#holt-winters-seasonal-method"><strong>3. Holt-Winters Seasonal Method</strong></a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="time-series-models">
<h1>TIME SERIES MODELS<a class="headerlink" href="#time-series-models" title="Link to this heading">#</a></h1>
<hr style="height:2px; border-width:0; color:gray; background-color:gray">
<table width="100%">
  <tr>
    <td align="left" width="60%">
      <h2 style="color: #2c3e50; font-family: Arial, sans-serif;">
        Technology for Financial Forecasting
      </h2>
      <p>
        <strong>Chandravesh Chaudhari</strong><br>
        Assistant Professor<br>
        School of Business and Management<br>
        <a href="mailto:chandravesh.chaudhari@christuniversity.in" style="color: #2980b9; text-decoration: none;">
          chandravesh.chaudhari@christuniversity.in
        </a>
      </p>
    </td>
    <td align="right" width="40%">
      <img src="logo.jpg" alt="Christ University" width="250">
    </td>
  </tr>
</table>
<hr style="height:2px; border-width:0; color:gray; background-color:gray">
<p><strong>Duration</strong>: 9 Hours</p>
<ol class="arabic simple">
<li><p>Components of Time Series Data</p></li>
<li><p>Average Forecasting Method</p></li>
<li><p>Errors and Error Criterion</p></li>
<li><p>Naïve Forecasting Method</p></li>
<li><p>Moving Average Forecast</p></li>
<li><p>Simple Exponential Smoothing (SES) Forecast</p></li>
<li><p>Diagnostic Tools to Evaluate Forecasting Models and Their Results</p></li>
</ol>
<hr class="docutils" />
<section id="topic-components-of-time-series-data">
<h2>Topic: Components of Time Series Data<a class="headerlink" href="#topic-components-of-time-series-data" title="Link to this heading">#</a></h2>
</section>
<hr class="docutils" />
<section id="what-are-the-components-of-time-series">
<h2>1. What are the Components of Time Series?<a class="headerlink" href="#what-are-the-components-of-time-series" title="Link to this heading">#</a></h2>
<p>Time series data typically has four main components:</p>
<ul class="simple">
<li><p><strong>Trend (T)</strong>: The long-term movement or direction in the data (e.g., upward or downward).</p></li>
<li><p><strong>Seasonality (S)</strong>: The repeating short-term patterns or fluctuations that occur at regular intervals (e.g., monthly, yearly).</p></li>
<li><p><strong>Cyclic (C)</strong>: The long-term fluctuations that do not occur at regular intervals (e.g., business cycles).</p></li>
<li><p><strong>Irregular (I)</strong>: The random or irregular component, often caused by unforeseen events or noise in the data.</p></li>
</ul>
<section id="use-in-finance">
<h3>Use in Finance:<a class="headerlink" href="#use-in-finance" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Trend</strong>: Stock market growth over the long term.</p></li>
<li><p><strong>Seasonality</strong>: Quarterly sales fluctuations of a company due to consumer behavior.</p></li>
<li><p><strong>Cyclic</strong>: Business cycle impacts on GDP growth or recessions.</p></li>
<li><p><strong>Irregular</strong>: Unpredictable shocks like the COVID-19 pandemic impacting financial markets.</p></li>
</ul>
</section>
</section>
<section id="decomposition-of-time-series-data">
<h2>2. Decomposition of Time Series Data<a class="headerlink" href="#decomposition-of-time-series-data" title="Link to this heading">#</a></h2>
<p>We can decompose a time series into these components using statistical methods such as <strong>Classical Decomposition</strong> or <strong>STL (Seasonal-Trend decomposition using LOESS)</strong>.</p>
<section id="decomposition-formula">
<h3>Decomposition formula:<a class="headerlink" href="#decomposition-formula" title="Link to this heading">#</a></h3>
<div class="math notranslate nohighlight">
\[
Y_t = T_t + S_t + C_t + I_t
\]</div>
<p>Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( Y_t \)</span> is the observed value at time <span class="math notranslate nohighlight">\( t \)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\( T_t \)</span> is the trend component,</p></li>
<li><p><span class="math notranslate nohighlight">\( S_t \)</span> is the seasonal component,</p></li>
<li><p><span class="math notranslate nohighlight">\( C_t \)</span> is the cyclic component,</p></li>
<li><p><span class="math notranslate nohighlight">\( I_t \)</span> is the irregular component.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># Generate sample time series data (e.g., sales with some noise)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">21</span><span class="p">)</span>  <span class="c1"># 20 time periods</span>
<span class="n">values</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">))</span>  <span class="c1"># Level around 100 + noise</span>

<span class="c1"># Calculate the level as the mean of the series</span>
<span class="n">level</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>

<span class="c1"># Plot the time series</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Time Series Data&#39;</span><span class="p">)</span>

<span class="c1"># Plot the level</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=</span><span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xmax</span><span class="o">=</span><span class="n">time</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Level (mean = </span><span class="si">{</span><span class="n">level</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>

<span class="c1"># Add title and labels</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Time Series with Level (Mean)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Value&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f5c9cb1022b773e3f9021f414d7303d12c0387556f0eb7db609e4b0ed9e250bf.png" src="_images/f5c9cb1022b773e3f9021f414d7303d12c0387556f0eb7db609e4b0ed9e250bf.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">statsmodels.api</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sm</span>

<span class="c1"># Simulate monthly stock data over 5 years (60 months)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">months</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s1">&#39;2015-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">)</span>
<span class="n">stock_prices</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">60</span><span class="p">))</span>  <span class="c1"># Random walk for prices</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Stock Price&#39;</span><span class="p">:</span> <span class="n">stock_prices</span><span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="n">months</span><span class="p">)</span>

<span class="c1"># Decompose the time series using seasonal decomposition of time series (STL)</span>
<span class="n">decomposition</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">tsa</span><span class="o">.</span><span class="n">seasonal_decompose</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Stock Price&#39;</span><span class="p">],</span> <span class="n">model</span><span class="o">=</span><span class="s1">&#39;additive&#39;</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># Plot the decomposed components</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">411</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Stock Price&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Observed&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Observed Time Series&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">412</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">decomposition</span><span class="o">.</span><span class="n">trend</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Trend&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Trend Component&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">413</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">decomposition</span><span class="o">.</span><span class="n">seasonal</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Seasonal&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Seasonal Component&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">414</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">decomposition</span><span class="o">.</span><span class="n">resid</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Residuals&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Residual Component&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/fe0df909d605789879791e65adf1130b95d8a49b714bed776aafced4e221fa4d.png" src="_images/fe0df909d605789879791e65adf1130b95d8a49b714bed776aafced4e221fa4d.png" />
</div>
</div>
<ol class="arabic simple" start="4">
<li><p>Interpretation of Results
•	Trend: Identifies the long-term movement in stock prices.
•	Seasonal: Shows repeating patterns in stock prices (e.g., yearly fluctuations).
•	Residuals: The leftover noise, which can indicate anomalies or irregular events.
•	Cyclic: Although not directly decomposed, business cycle effects can be inferred from the residuals.</p></li>
</ol>
</section>
</section>
<section id="the-model">
<h2>1. The Model<a class="headerlink" href="#the-model" title="Link to this heading">#</a></h2>
<p>We assume an <strong>additive</strong> form:</p>
<div class="math notranslate nohighlight">
\[
Y_t \;=\; T_t \;+\; S_t \;+\; R_t
\]</div>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(T_t\)</span> = trend component</p></li>
<li><p><span class="math notranslate nohighlight">\(S_t\)</span> = seasonal component (length <span class="math notranslate nohighlight">\(m\)</span>)</p></li>
<li><p><span class="math notranslate nohighlight">\(R_t\)</span> = residual (irregular)</p></li>
</ul>
</section>
<section id="estimate-the-trend-mathbf-t-t-via-centered-moving-average">
<h2>2. Estimate the Trend <span class="math notranslate nohighlight">\(\mathbf{T_t}\)</span> via Centered Moving Average<a class="headerlink" href="#estimate-the-trend-mathbf-t-t-via-centered-moving-average" title="Link to this heading">#</a></h2>
<p>Let <span class="math notranslate nohighlight">\(m\)</span> = seasonality period (e.g.\ <span class="math notranslate nohighlight">\(m=12\)</span> for monthly data, <span class="math notranslate nohighlight">\(m=4\)</span> for quarterly).</p>
<ol class="arabic">
<li><p>Compute the <span class="math notranslate nohighlight">\(m\)</span>‑point moving average (MA<span class="math notranslate nohighlight">\(_m\)</span>):</p>
<div class="math notranslate nohighlight">
\[
   \overline{Y}_{t} 
   = \frac{1}{m}\sum_{i=-(m-1)/2}^{+(m-1)/2} Y_{t+i}
   \quad
   \text{(if $m$ odd).}
   \]</div>
<p>If <span class="math notranslate nohighlight">\(m\)</span> is even, you do two successive averages to “center” it:</p>
<div class="math notranslate nohighlight">
\[
   \text{MA}_m(t)
   \;\to\;
   T_{t} 
   = \frac{\text{MA}_m(t) + \text{MA}_m(t+1)}{2}.
   \]</div>
</li>
<li><p>The result <span class="math notranslate nohighlight">\(T_t\)</span> is your <strong>trend</strong> estimate, defined only for those <span class="math notranslate nohighlight">\(t\)</span> where the average is “fully inside” the data.</p></li>
</ol>
</section>
<section id="detrend-to-expose-seasonality">
<h2>3. Detrend to Expose Seasonality<a class="headerlink" href="#detrend-to-expose-seasonality" title="Link to this heading">#</a></h2>
<p>Form the <strong>detrended</strong> series:</p>
<div class="math notranslate nohighlight">
\[
D_t \;=\; Y_t \;-\; T_t
\]</div>
<p>Each <span class="math notranslate nohighlight">\(D_t\)</span> still contains both seasonality <span class="math notranslate nohighlight">\(S_t\)</span> and residual <span class="math notranslate nohighlight">\(R_t\)</span>:</p>
<div class="math notranslate nohighlight">
\[
D_t = S_t + R_t.
\]</div>
</section>
<section id="estimate-the-seasonal-indices-mathbf-s-i">
<h2>4. Estimate the Seasonal Indices <span class="math notranslate nohighlight">\(\mathbf{S_i}\)</span><a class="headerlink" href="#estimate-the-seasonal-indices-mathbf-s-i" title="Link to this heading">#</a></h2>
<p>Because seasonality repeats every <span class="math notranslate nohighlight">\(m\)</span> periods, index months/quartiles/etc.\ by <span class="math notranslate nohighlight">\(i=1,\dots,m\)</span>.</p>
<ol class="arabic">
<li><p>For each season <span class="math notranslate nohighlight">\(i\)</span>, collect all <span class="math notranslate nohighlight">\(D_t\)</span> where <span class="math notranslate nohighlight">\(t \equiv i\pmod m\)</span>.</p></li>
<li><p>Average them:</p>
<div class="math notranslate nohighlight">
\[
   \hat S_i 
   = \frac{1}{N_i}\sum_{t \equiv i\;(m)} D_t,
   \]</div>
<p>where <span class="math notranslate nohighlight">\(N_i\)</span> = number of cycles.</p>
</li>
<li><p>(Optional) <strong>Normalize</strong> so <span class="math notranslate nohighlight">\(\sum_{i=1}^m \hat S_i = 0\)</span> (additive case).</p></li>
</ol>
<p>Then extend <span class="math notranslate nohighlight">\(\hat S_t = \hat S_{((t-1)\bmod m)+1}\)</span> to all <span class="math notranslate nohighlight">\(t\)</span>.</p>
</section>
<section id="compute-the-residuals-mathbf-r-t">
<h2>5. Compute the Residuals <span class="math notranslate nohighlight">\(\mathbf{R_t}\)</span><a class="headerlink" href="#compute-the-residuals-mathbf-r-t" title="Link to this heading">#</a></h2>
<p>Finally,</p>
<div class="math notranslate nohighlight">
\[
R_t \;=\; Y_t \;-\; T_t \;-\; \hat S_t.
\]</div>
<p>These <span class="math notranslate nohighlight">\(R_t\)</span> should look like “random noise” if the decomposition is good.</p>
</section>
<section id="worked-illustration-additive-m-4">
<h2>6. Worked Illustration (Additive, <span class="math notranslate nohighlight">\(m=4\)</span>)<a class="headerlink" href="#worked-illustration-additive-m-4" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p><span class="math notranslate nohighlight">\(t\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(Y_t\)</span></p></th>
<th class="head text-center"><p>4‑pt MA (uncentered)</p></th>
<th class="head text-center"><p>Centered <span class="math notranslate nohighlight">\(T_t\)</span></p></th>
<th class="head text-center"><p>Detrended <span class="math notranslate nohighlight">\(D_t=Y_t-T_t\)</span></p></th>
<th class="head text-center"><p>Season <span class="math notranslate nohighlight">\(i\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>1</p></td>
<td class="text-center"><p>120</p></td>
<td class="text-center"><p>—</p></td>
<td class="text-center"><p>—</p></td>
<td class="text-center"><p>—</p></td>
<td class="text-center"><p>1</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>2</p></td>
<td class="text-center"><p>150</p></td>
<td class="text-center"><p>—</p></td>
<td class="text-center"><p>—</p></td>
<td class="text-center"><p>—</p></td>
<td class="text-center"><p>2</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>3</p></td>
<td class="text-center"><p>100</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\( (120+150+100+130)/4 =125\)</span></p></td>
<td class="text-center"><p>—</p></td>
<td class="text-center"><p>—</p></td>
<td class="text-center"><p>3</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>4</p></td>
<td class="text-center"><p>130</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\( (150+100+130+140)/4 =130\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(\frac{125+130}{2}=127.5\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(130-127.5=2.5\)</span></p></td>
<td class="text-center"><p>4</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>5</p></td>
<td class="text-center"><p>140</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\( (100+130+140+170)/4 =135\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(\frac{130+135}{2}=132.5\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(140-132.5=7.5\)</span></p></td>
<td class="text-center"><p>1</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>6</p></td>
<td class="text-center"><p>170</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\( (130+140+170+110)/4 =137.5\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(\tfrac{135+137.5}{2}=136.25\)</span></p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(170-136.25=33.75\)</span></p></td>
<td class="text-center"><p>2</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>7</p></td>
<td class="text-center"><p>110</p></td>
<td class="text-center"><p>—</p></td>
<td class="text-center"><p>—</p></td>
<td class="text-center"><p>—</p></td>
<td class="text-center"><p>3</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>8</p></td>
<td class="text-center"><p>135</p></td>
<td class="text-center"><p>—</p></td>
<td class="text-center"><p>—</p></td>
<td class="text-center"><p>—</p></td>
<td class="text-center"><p>4</p></td>
</tr>
</tbody>
</table>
</div>
<ol class="arabic simple">
<li><p><strong>Trend</strong> <span class="math notranslate nohighlight">\(\{T_4,T_5,T_6\}=\{127.5,132.5,136.25\}.\)</span></p></li>
<li><p><strong>Detrended</strong> <span class="math notranslate nohighlight">\(D_4=2.5,\;D_5=7.5,\;D_6=33.75.\)</span></p></li>
<li><p>Group these by season <span class="math notranslate nohighlight">\(i\)</span>:</p>
<ul class="simple">
<li><p>Season 1 (<span class="math notranslate nohighlight">\(i=1\)</span>): only <span class="math notranslate nohighlight">\(D_5=7.5\)</span></p></li>
<li><p>Season 2: <span class="math notranslate nohighlight">\(D_6=33.75\)</span></p></li>
<li><p>Season 3: (no detrended point here)</p></li>
<li><p>Season 4: <span class="math notranslate nohighlight">\(D_4=2.5\)</span></p></li>
</ul>
</li>
<li><p>Seasonal indices <span class="math notranslate nohighlight">\(\hat S_i\)</span> are just these averages.  (With more years you’d average across cycles.)</p></li>
<li><p><strong>Residual</strong> <span class="math notranslate nohighlight">\(R_t = Y_t - T_t - \hat S_t\)</span>.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Step 1: Simulate 60 months of stock price data</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">months</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s1">&#39;2015-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;ME&#39;</span><span class="p">)</span>
<span class="n">Y_t</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">60</span><span class="p">))</span>  <span class="c1"># random walk</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Month&#39;</span><span class="p">:</span> <span class="n">months</span><span class="p">,</span> <span class="s1">&#39;Y_t&#39;</span><span class="p">:</span> <span class="n">Y_t</span><span class="p">})</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Month Name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span>

<span class="c1"># Step 2: Trend using 12-month centered moving average</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;T_t&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Y_t&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># Step 3: Detrended values</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;D_t&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Y_t&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;T_t&#39;</span><span class="p">]</span>

<span class="c1"># Step 4: Seasonal component (monthly average of detrended)</span>
<span class="n">seasonal_means</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;D_t&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Month Name&#39;</span><span class="p">)[</span><span class="s1">&#39;D_t&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;S_t&#39;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">seasonal_means</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;Month Name&#39;</span><span class="p">)</span>

<span class="c1"># Step 5: Residuals</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;R_t&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Y_t&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;T_t&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;S_t&#39;</span><span class="p">]</span>

<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Month</th>
      <th>Y_t</th>
      <th>Month Name</th>
      <th>T_t</th>
      <th>D_t</th>
      <th>S_t</th>
      <th>R_t</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2015-01-31</td>
      <td>101.49</td>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.63</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2015-02-28</td>
      <td>101.72</td>
      <td>2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-0.55</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2015-03-31</td>
      <td>103.51</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-1.91</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2015-04-30</td>
      <td>107.06</td>
      <td>4</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-1.50</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2015-05-31</td>
      <td>107.09</td>
      <td>5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-1.65</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2015-06-30</td>
      <td>107.12</td>
      <td>6</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-0.65</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2015-07-31</td>
      <td>110.78</td>
      <td>7</td>
      <td>108.71</td>
      <td>2.07</td>
      <td>0.08</td>
      <td>1.99</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2015-08-31</td>
      <td>112.82</td>
      <td>8</td>
      <td>109.76</td>
      <td>3.05</td>
      <td>0.81</td>
      <td>2.24</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2015-09-30</td>
      <td>112.38</td>
      <td>9</td>
      <td>110.52</td>
      <td>1.86</td>
      <td>1.05</td>
      <td>0.81</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2015-10-31</td>
      <td>113.96</td>
      <td>10</td>
      <td>110.87</td>
      <td>3.09</td>
      <td>0.82</td>
      <td>2.27</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2015-11-30</td>
      <td>113.53</td>
      <td>11</td>
      <td>110.89</td>
      <td>2.65</td>
      <td>1.38</td>
      <td>1.27</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2015-12-31</td>
      <td>113.10</td>
      <td>12</td>
      <td>110.77</td>
      <td>2.34</td>
      <td>0.95</td>
      <td>1.39</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2016-01-31</td>
      <td>114.09</td>
      <td>1</td>
      <td>110.74</td>
      <td>3.35</td>
      <td>1.63</td>
      <td>1.72</td>
    </tr>
    <tr>
      <th>13</th>
      <td>2016-02-29</td>
      <td>110.76</td>
      <td>2</td>
      <td>110.30</td>
      <td>0.46</td>
      <td>-0.55</td>
      <td>1.01</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2016-03-31</td>
      <td>107.81</td>
      <td>3</td>
      <td>109.49</td>
      <td>-1.68</td>
      <td>-1.91</td>
      <td>0.23</td>
    </tr>
    <tr>
      <th>15</th>
      <td>2016-04-30</td>
      <td>107.19</td>
      <td>4</td>
      <td>109.01</td>
      <td>-1.82</td>
      <td>-1.50</td>
      <td>-0.32</td>
    </tr>
    <tr>
      <th>16</th>
      <td>2016-05-31</td>
      <td>105.66</td>
      <td>5</td>
      <td>108.40</td>
      <td>-2.74</td>
      <td>-1.65</td>
      <td>-1.08</td>
    </tr>
    <tr>
      <th>17</th>
      <td>2016-06-30</td>
      <td>106.79</td>
      <td>6</td>
      <td>107.87</td>
      <td>-1.09</td>
      <td>-0.65</td>
      <td>-0.43</td>
    </tr>
    <tr>
      <th>18</th>
      <td>2016-07-31</td>
      <td>105.47</td>
      <td>7</td>
      <td>107.19</td>
      <td>-1.72</td>
      <td>0.08</td>
      <td>-1.80</td>
    </tr>
    <tr>
      <th>19</th>
      <td>2016-08-31</td>
      <td>103.15</td>
      <td>8</td>
      <td>106.38</td>
      <td>-3.23</td>
      <td>0.81</td>
      <td>-4.04</td>
    </tr>
    <tr>
      <th>20</th>
      <td>2016-09-30</td>
      <td>106.58</td>
      <td>9</td>
      <td>105.90</td>
      <td>0.68</td>
      <td>1.05</td>
      <td>-0.37</td>
    </tr>
    <tr>
      <th>21</th>
      <td>2016-10-31</td>
      <td>106.63</td>
      <td>10</td>
      <td>105.52</td>
      <td>1.11</td>
      <td>0.82</td>
      <td>0.29</td>
    </tr>
    <tr>
      <th>22</th>
      <td>2016-11-30</td>
      <td>107.26</td>
      <td>11</td>
      <td>105.30</td>
      <td>1.97</td>
      <td>1.38</td>
      <td>0.59</td>
    </tr>
    <tr>
      <th>23</th>
      <td>2016-12-31</td>
      <td>104.91</td>
      <td>12</td>
      <td>105.14</td>
      <td>-0.23</td>
      <td>0.95</td>
      <td>-1.18</td>
    </tr>
    <tr>
      <th>24</th>
      <td>2017-01-31</td>
      <td>104.32</td>
      <td>1</td>
      <td>104.89</td>
      <td>-0.56</td>
      <td>1.63</td>
      <td>-2.19</td>
    </tr>
    <tr>
      <th>25</th>
      <td>2017-02-28</td>
      <td>105.05</td>
      <td>2</td>
      <td>104.68</td>
      <td>0.37</td>
      <td>-0.55</td>
      <td>0.91</td>
    </tr>
    <tr>
      <th>26</th>
      <td>2017-03-31</td>
      <td>103.24</td>
      <td>3</td>
      <td>105.02</td>
      <td>-1.77</td>
      <td>-1.91</td>
      <td>0.13</td>
    </tr>
    <tr>
      <th>27</th>
      <td>2017-04-30</td>
      <td>104.50</td>
      <td>4</td>
      <td>105.11</td>
      <td>-0.61</td>
      <td>-1.50</td>
      <td>0.89</td>
    </tr>
    <tr>
      <th>28</th>
      <td>2017-05-31</td>
      <td>103.79</td>
      <td>5</td>
      <td>105.06</td>
      <td>-1.27</td>
      <td>-1.65</td>
      <td>0.38</td>
    </tr>
    <tr>
      <th>29</th>
      <td>2017-06-30</td>
      <td>103.71</td>
      <td>6</td>
      <td>105.14</td>
      <td>-1.43</td>
      <td>-0.65</td>
      <td>-0.78</td>
    </tr>
    <tr>
      <th>30</th>
      <td>2017-07-31</td>
      <td>103.01</td>
      <td>7</td>
      <td>105.26</td>
      <td>-2.25</td>
      <td>0.08</td>
      <td>-2.33</td>
    </tr>
    <tr>
      <th>31</th>
      <td>2017-08-31</td>
      <td>107.21</td>
      <td>8</td>
      <td>105.50</td>
      <td>1.72</td>
      <td>0.81</td>
      <td>0.90</td>
    </tr>
    <tr>
      <th>32</th>
      <td>2017-09-30</td>
      <td>107.69</td>
      <td>9</td>
      <td>105.39</td>
      <td>2.30</td>
      <td>1.05</td>
      <td>1.25</td>
    </tr>
    <tr>
      <th>33</th>
      <td>2017-10-31</td>
      <td>106.07</td>
      <td>10</td>
      <td>105.25</td>
      <td>0.82</td>
      <td>0.82</td>
      <td>-0.00</td>
    </tr>
    <tr>
      <th>34</th>
      <td>2017-11-30</td>
      <td>108.22</td>
      <td>11</td>
      <td>105.09</td>
      <td>3.13</td>
      <td>1.38</td>
      <td>1.75</td>
    </tr>
    <tr>
      <th>35</th>
      <td>2017-12-31</td>
      <td>106.27</td>
      <td>12</td>
      <td>105.15</td>
      <td>1.13</td>
      <td>0.95</td>
      <td>0.18</td>
    </tr>
    <tr>
      <th>36</th>
      <td>2018-01-31</td>
      <td>107.19</td>
      <td>1</td>
      <td>105.28</td>
      <td>1.91</td>
      <td>1.63</td>
      <td>0.28</td>
    </tr>
    <tr>
      <th>37</th>
      <td>2018-02-28</td>
      <td>103.77</td>
      <td>2</td>
      <td>105.50</td>
      <td>-1.72</td>
      <td>-0.55</td>
      <td>-1.18</td>
    </tr>
    <tr>
      <th>38</th>
      <td>2018-03-31</td>
      <td>101.62</td>
      <td>3</td>
      <td>105.35</td>
      <td>-3.74</td>
      <td>-1.91</td>
      <td>-1.83</td>
    </tr>
    <tr>
      <th>39</th>
      <td>2018-04-30</td>
      <td>102.51</td>
      <td>4</td>
      <td>104.97</td>
      <td>-2.46</td>
      <td>-1.50</td>
      <td>-0.95</td>
    </tr>
    <tr>
      <th>40</th>
      <td>2018-05-31</td>
      <td>104.49</td>
      <td>5</td>
      <td>104.63</td>
      <td>-0.15</td>
      <td>-1.65</td>
      <td>1.50</td>
    </tr>
    <tr>
      <th>41</th>
      <td>2018-06-30</td>
      <td>105.33</td>
      <td>6</td>
      <td>104.09</td>
      <td>1.24</td>
      <td>-0.65</td>
      <td>1.89</td>
    </tr>
    <tr>
      <th>42</th>
      <td>2018-07-31</td>
      <td>105.60</td>
      <td>7</td>
      <td>103.92</td>
      <td>1.67</td>
      <td>0.08</td>
      <td>1.59</td>
    </tr>
    <tr>
      <th>43</th>
      <td>2018-08-31</td>
      <td>105.50</td>
      <td>8</td>
      <td>103.78</td>
      <td>1.71</td>
      <td>0.81</td>
      <td>0.90</td>
    </tr>
    <tr>
      <th>44</th>
      <td>2018-09-30</td>
      <td>103.04</td>
      <td>9</td>
      <td>103.67</td>
      <td>-0.63</td>
      <td>1.05</td>
      <td>-1.68</td>
    </tr>
    <tr>
      <th>45</th>
      <td>2018-10-31</td>
      <td>102.10</td>
      <td>10</td>
      <td>103.84</td>
      <td>-1.74</td>
      <td>0.82</td>
      <td>-2.56</td>
    </tr>
    <tr>
      <th>46</th>
      <td>2018-11-30</td>
      <td>101.68</td>
      <td>11</td>
      <td>103.91</td>
      <td>-2.23</td>
      <td>1.38</td>
      <td>-3.61</td>
    </tr>
    <tr>
      <th>47</th>
      <td>2018-12-31</td>
      <td>104.29</td>
      <td>12</td>
      <td>103.74</td>
      <td>0.55</td>
      <td>0.95</td>
      <td>-0.39</td>
    </tr>
    <tr>
      <th>48</th>
      <td>2019-01-31</td>
      <td>105.48</td>
      <td>1</td>
      <td>103.64</td>
      <td>1.83</td>
      <td>1.63</td>
      <td>0.20</td>
    </tr>
    <tr>
      <th>49</th>
      <td>2019-02-28</td>
      <td>102.45</td>
      <td>2</td>
      <td>103.74</td>
      <td>-1.29</td>
      <td>-0.55</td>
      <td>-0.74</td>
    </tr>
    <tr>
      <th>50</th>
      <td>2019-03-31</td>
      <td>103.60</td>
      <td>3</td>
      <td>104.04</td>
      <td>-0.44</td>
      <td>-1.91</td>
      <td>1.47</td>
    </tr>
    <tr>
      <th>51</th>
      <td>2019-04-30</td>
      <td>103.33</td>
      <td>4</td>
      <td>104.45</td>
      <td>-1.12</td>
      <td>-1.50</td>
      <td>0.38</td>
    </tr>
    <tr>
      <th>52</th>
      <td>2019-05-31</td>
      <td>102.48</td>
      <td>5</td>
      <td>104.93</td>
      <td>-2.45</td>
      <td>-1.65</td>
      <td>-0.80</td>
    </tr>
    <tr>
      <th>53</th>
      <td>2019-06-30</td>
      <td>104.20</td>
      <td>6</td>
      <td>105.54</td>
      <td>-1.34</td>
      <td>-0.65</td>
      <td>-0.69</td>
    </tr>
    <tr>
      <th>54</th>
      <td>2019-07-31</td>
      <td>106.76</td>
      <td>7</td>
      <td>106.14</td>
      <td>0.63</td>
      <td>0.08</td>
      <td>0.55</td>
    </tr>
    <tr>
      <th>55</th>
      <td>2019-08-31</td>
      <td>109.12</td>
      <td>8</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.81</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>56</th>
      <td>2019-09-30</td>
      <td>107.95</td>
      <td>9</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.05</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>57</th>
      <td>2019-10-31</td>
      <td>107.83</td>
      <td>10</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.82</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>58</th>
      <td>2019-11-30</td>
      <td>108.99</td>
      <td>11</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.38</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>59</th>
      <td>2019-12-31</td>
      <td>111.44</td>
      <td>12</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.95</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plotting</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># Observed</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">411</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Y_t&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Observed&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Observed Time Series&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Y_t&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Trend</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">412</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;T_t&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Trend&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Trend Component (12-Month MA)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;T_t&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Seasonal</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">413</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;S_t&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Seasonal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Seasonal Component (Monthly Avg. of Detrended)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;S_t&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Residual</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">414</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;R_t&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Residual&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Residual Component&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Month&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;R_t&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/64490cc1dd12c776c9502183e3cd90bbf0f086f57bfbcd499495b1b9a3531674.png" src="_images/64490cc1dd12c776c9502183e3cd90bbf0f086f57bfbcd499495b1b9a3531674.png" />
</div>
</div>
</section>
<hr class="docutils" />
<section id="topic-average-forecasting-method">
<h2>Topic: Average Forecasting Method<a class="headerlink" href="#topic-average-forecasting-method" title="Link to this heading">#</a></h2>
<hr class="docutils" />
<p>The <strong>average forecasting method</strong> is one of the simplest approaches used for time series forecasting. It assumes that future values will be similar to the average of past observations.</p>
<div class="math notranslate nohighlight">
\[
\hat{Y}_{t+1} = \frac{1}{n} \sum_{i=1}^{n} Y_i
\]</div>
<p>Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( \hat{Y}_{t+1} \)</span> is the forecasted value at time <span class="math notranslate nohighlight">\( t+1 \)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\( Y_i \)</span> are the actual values of the time series,</p></li>
<li><p><span class="math notranslate nohighlight">\( n \)</span> is the number of data points in the period used for averaging.</p></li>
<li><p>Short-term forecasting of stock prices or market indices when no strong trend is present.</p></li>
<li><p>Can be used as a baseline method for comparison against more complex forecasting models.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Simulate stock prices over 12 months</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">months</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s1">&#39;2022-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">)</span>
<span class="n">stock_prices</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">))</span>  <span class="c1"># Random walk for prices</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Stock Price&#39;</span><span class="p">:</span> <span class="n">stock_prices</span><span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="n">months</span><span class="p">)</span>

<span class="c1"># Compute the average of the last n observations</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">3</span>  <span class="c1"># Number of periods to average over</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Average Forecast&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Stock Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Plot the observed and forecasted stock prices</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Stock Price&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Observed Stock Price&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Average Forecast&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Average Forecast&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Average Forecasting of Stock Prices&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Date&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Stock Price&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0273c9731c545ae8c0a7ab80d16f0d63866ad18205167636fc417685e943bb7c.png" src="_images/0273c9731c545ae8c0a7ab80d16f0d63866ad18205167636fc417685e943bb7c.png" />
</div>
</div>
</section>
<hr class="docutils" />
<section id="topic-errors-and-error-criterion">
<h2>Topic: Errors and Error Criterion<a class="headerlink" href="#topic-errors-and-error-criterion" title="Link to this heading">#</a></h2>
<hr class="docutils" />
<p>Forecasting errors are the differences between the <strong>actual</strong> values and the <strong>predicted</strong> values from a forecasting model. These errors provide insight into how well the model performs and help assess the accuracy of predictions.</p>
<div class="math notranslate nohighlight">
\[
\text{Error}_t = Y_t - \hat{Y}_t
\]</div>
<p>Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( \text{Error}_t \)</span> is the error at time <span class="math notranslate nohighlight">\( t \)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\( Y_t \)</span> is the actual value at time <span class="math notranslate nohighlight">\( t \)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\( \hat{Y}_t \)</span> is the forecasted value at time <span class="math notranslate nohighlight">\( t \)</span>.</p></li>
</ul>
<p>Several error criteria are used to evaluate the accuracy of forecasts. The most commonly used ones are:</p>
<ul class="simple">
<li><p><strong>Mean Absolute Error (MAE)</strong>:
$<span class="math notranslate nohighlight">\(
\text{MAE} = \frac{1}{n} \sum_{i=1}^{n} |Y_i - \hat{Y}_i|
\)</span>$</p></li>
<li><p><strong>Mean Squared Error (MSE)</strong>:
$<span class="math notranslate nohighlight">\(
\text{MSE} = \frac{1}{n} \sum_{i=1}^{n} (Y_i - \hat{Y}_i)^2
\)</span>$</p></li>
<li><p><strong>Root Mean Squared Error (RMSE)</strong>:
$<span class="math notranslate nohighlight">\(
\text{RMSE} = \sqrt{\frac{1}{n} \sum_{i=1}^{n} (Y_i - \hat{Y}_i)^2}
\)</span>$</p></li>
<li><p><strong>Mean Absolute Percentage Error (MAPE)</strong>:
$<span class="math notranslate nohighlight">\(
\text{MAPE} = \frac{100}{n} \sum_{i=1}^{n} \left|\frac{Y_i - \hat{Y}_i}{Y_i}\right|
\)</span>$</p></li>
</ul>
<section id="id1">
<h3>Use in Finance:<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>MSE</strong> and <strong>RMSE</strong> are useful when penalizing large errors is critical (e.g., large deviations in financial data).</p></li>
<li><p><strong>MAPE</strong> is frequently used when it is important to express the error in terms of percentages.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">mean_absolute_error</span><span class="p">,</span> <span class="n">mean_squared_error</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">math</span><span class="w"> </span><span class="kn">import</span> <span class="n">sqrt</span>

<span class="c1"># Simulate stock prices over 12 months and forecast using a simple method (e.g., moving average)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">months</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s1">&#39;2022-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">)</span>
<span class="n">stock_prices</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">))</span>  <span class="c1"># Random walk for prices</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Stock Price&#39;</span><span class="p">:</span> <span class="n">stock_prices</span><span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="n">months</span><span class="p">)</span>

<span class="c1"># Simple forecast using the last observed value (naive forecast)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Naive Forecast&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Stock Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Drop the first row as it will have NaN values</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

<span class="c1"># Calculate error metrics</span>
<span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Stock Price&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Naive Forecast&#39;</span><span class="p">])</span>
<span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Stock Price&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Naive Forecast&#39;</span><span class="p">])</span>
<span class="n">rmse</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>

<span class="c1"># Display the error metrics</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean Absolute Error (MAE): </span><span class="si">{</span><span class="n">mae</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean Squared Error (MSE): </span><span class="si">{</span><span class="n">mse</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Root Mean Squared Error (RMSE): </span><span class="si">{</span><span class="n">rmse</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mean Absolute Error (MAE): 1.29127148767799
Mean Squared Error (MSE): 3.3134789166058947
Root Mean Squared Error (RMSE): 1.8202963815285396
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># Sample data with a large error (500 vs. 700)</span>
<span class="n">actual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">600</span><span class="p">])</span>
<span class="n">forecast</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">110</span><span class="p">,</span> <span class="mi">190</span><span class="p">,</span> <span class="mi">320</span><span class="p">,</span> <span class="mi">380</span><span class="p">,</span> <span class="mi">700</span><span class="p">,</span> <span class="mi">590</span><span class="p">])</span>

<span class="c1"># Calculate errors</span>
<span class="n">errors</span> <span class="o">=</span> <span class="n">actual</span> <span class="o">-</span> <span class="n">forecast</span>
<span class="n">abs_errors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span>
<span class="n">percentage_errors</span> <span class="o">=</span> <span class="n">errors</span> <span class="o">/</span> <span class="n">actual</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">abs_percentage_errors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">percentage_errors</span><span class="p">)</span>
<span class="n">smape_denominator</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">actual</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">forecast</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span>

<span class="c1"># Compute metrics</span>
<span class="n">mae</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">abs_errors</span><span class="p">)</span>
<span class="n">mse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">errors</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>
<span class="n">mape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">abs_percentage_errors</span><span class="p">)</span>
<span class="n">mpe</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">percentage_errors</span><span class="p">)</span>
<span class="n">smape</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">abs_errors</span> <span class="o">/</span> <span class="n">smape_denominator</span><span class="p">)</span>

<span class="c1"># Display results</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAE: </span><span class="si">{</span><span class="n">mae</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> (average error in original units)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MSE: </span><span class="si">{</span><span class="n">mse</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> (squared error, sensitive to large errors)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RMSE: </span><span class="si">{</span><span class="n">rmse</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> (error in original units, penalizes large errors)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAPE: </span><span class="si">{</span><span class="n">mape</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">% (average percentage error)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MPE: </span><span class="si">{</span><span class="n">mpe</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">% (bias in percentage, negative = over-forecasting)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SMAPE: </span><span class="si">{</span><span class="n">smape</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">% (symmetric percentage error, handles zeros)&quot;</span><span class="p">)</span>

<span class="c1"># Visualize actual vs. forecast</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">actual</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Actual&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">forecast</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Forecast&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Actual vs. Forecasted Values&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Value ($y_t$, $\hat</span><span class="si">{y}</span><span class="s1">_t$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MAE: 45.00 (average error in original units)
MSE: 6850.00 (squared error, sensitive to large errors)
RMSE: 82.76 (error in original units, penalizes large errors)
MAPE: 11.39% (average percentage error)
MPE: -7.50% (bias in percentage, negative = over-forecasting)
SMAPE: 10.21% (symmetric percentage error, handles zeros)
</pre></div>
</div>
<img alt="_images/9ae6f559ec3fa1513c6f0f9926fae6d96e8e33ec1f236bff0dde94154766e68f.png" src="_images/9ae6f559ec3fa1513c6f0f9926fae6d96e8e33ec1f236bff0dde94154766e68f.png" />
</div>
</div>
<p>MAE: “Average mistake, like being off by 45 units.”
•  MSE: “Squares errors, so big mistakes like 80 units hurt a lot.”
•  RMSE: “Like MAE but penalizes big errors, about 82.76 units.”
•  MAPE: “Percentage error, 11.39% off on average.”
•  MPE: “-7.50% means we’re forecasting too high.”
•  SMAPE: “Like MAPE but better for tricky data, 10.21% error.”</p>
<section id="interpretation-of-results">
<h4>Interpretation of Results<a class="headerlink" href="#interpretation-of-results" title="Link to this heading">#</a></h4>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>•	MAE gives the average magnitude of the errors without considering their direction (positive/negative).
•	MSE is more sensitive to large errors and gives greater penalty for them.
•	RMSE provides a standard deviation-like measure of the forecast errors.
•	MAPE expresses error as a percentage, which is useful for relative performance across different datasets.
</pre></div>
</div>
</section>
</section>
</section>
<hr class="docutils" />
<section id="topic-naive-moving-average-and-ses-forecasts">
<h2>Topic: Naïve, Moving Average, and SES Forecasts<a class="headerlink" href="#topic-naive-moving-average-and-ses-forecasts" title="Link to this heading">#</a></h2>
<hr class="docutils" />
<p>The <strong>Naïve Forecasting</strong> method is the simplest form of forecasting, where the forecast for the next period is equal to the actual value of the current period. This method assumes that the future value will be the same as the most recent observation.</p>
<p><strong>Formula:</strong><br />
<span class="math notranslate nohighlight">\( \hat{Y}_{t+1} = Y_t \)</span>
Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( \hat{Y}_{t+1} \)</span> is the forecast for time <span class="math notranslate nohighlight">\( t+1 \)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\( Y_t \)</span> is the actual value at time <span class="math notranslate nohighlight">\( t \)</span>.</p></li>
<li><p>This method is often used as a <strong>benchmark</strong> for comparison with more sophisticated forecasting models.</p></li>
<li><p>Useful when the data doesn’t exhibit a clear trend or seasonality.</p></li>
</ul>
<p>The <strong>Moving Average (MA)</strong> method involves averaging a fixed number of past observations to predict future values. It’s a smoothing technique that can help reduce the impact of short-term fluctuations or noise.</p>
<div class="math notranslate nohighlight">
\[
\hat{Y}_{t+1} = \frac{1}{n} \sum_{i=1}^{n} Y_{t-i+1}
\]</div>
<p>Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( \hat{Y}_{t+1} \)</span> is the forecast for time <span class="math notranslate nohighlight">\( t+1 \)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\( Y_{t-i+1} \)</span> are the actual values of the past <span class="math notranslate nohighlight">\( n \)</span> observations.</p></li>
<li><p>Commonly used to smooth stock price data, identify long-term trends, and filter out short-term volatility.</p></li>
<li><p>Widely used in technical analysis, especially in indicators like the <strong>Simple Moving Average (SMA)</strong>.</p></li>
</ul>
<p><strong>Simple Exponential Smoothing (SES)</strong> is a forecasting technique that gives more weight to recent observations while smoothing past data. It uses a weighted average where the weights decrease exponentially over time.</p>
<div class="math notranslate nohighlight">
\[
\hat{Y}_{t+1} = \alpha Y_t + (1 - \alpha) \hat{Y}_t
\]</div>
<p>Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( \hat{Y}_{t+1} \)</span> is the forecast for time <span class="math notranslate nohighlight">\( t+1 \)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\( Y_t \)</span> is the actual value at time <span class="math notranslate nohighlight">\( t \)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\( \hat{Y}_t \)</span> is the previous forecast,</p></li>
<li><p><span class="math notranslate nohighlight">\( \alpha \)</span> is the smoothing constant, <span class="math notranslate nohighlight">\( 0 \leq \alpha \leq 1 \)</span>.</p></li>
<li><p><strong>SES</strong> is often used for forecasting when the data doesn’t exhibit trend or seasonality (i.e., it is a flat time series).</p></li>
<li><p>It’s commonly applied in short-term financial forecasting, such as predicting the next few stock prices or exchange rates.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Naïve Forecast Model</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Naive Forecast&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Stock Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Moving Average Model (n=3)</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;MA Forecast&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Stock Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># Simple Exponential Smoothing (SES) Model</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;SES Forecast&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Stock Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">ewm</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">adjust</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># Plotting the forecasts</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Stock Price&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Actual Stock Price&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Naive Forecast&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Naïve Forecast&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;MA Forecast&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Moving Average Forecast&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SES Forecast&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;SES Forecast&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Stock Price Forecasting Models&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Date&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Stock Price&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span><span class="n">a</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Calculating Forecast Errors (MAE, MSE, RMSE)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">mean_absolute_error</span><span class="p">,</span> <span class="n">mean_squared_error</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">math</span>

<span class="c1"># SES Forecast errors</span>
<span class="n">ses_valid</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Stock Price&#39;</span><span class="p">,</span> <span class="s1">&#39;SES Forecast&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">mae_ses</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">ses_valid</span><span class="p">[</span><span class="s1">&#39;Stock Price&#39;</span><span class="p">],</span> <span class="n">ses_valid</span><span class="p">[</span><span class="s1">&#39;SES Forecast&#39;</span><span class="p">])</span>
<span class="n">mse_ses</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">ses_valid</span><span class="p">[</span><span class="s1">&#39;Stock Price&#39;</span><span class="p">],</span> <span class="n">ses_valid</span><span class="p">[</span><span class="s1">&#39;SES Forecast&#39;</span><span class="p">])</span>
<span class="n">rmse_ses</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse_ses</span><span class="p">)</span>

<span class="c1"># Naïve Forecast errors</span>
<span class="n">naive_valid</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Stock Price&#39;</span><span class="p">,</span> <span class="s1">&#39;Naive Forecast&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">mae_naive</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">naive_valid</span><span class="p">[</span><span class="s1">&#39;Stock Price&#39;</span><span class="p">],</span> <span class="n">naive_valid</span><span class="p">[</span><span class="s1">&#39;Naive Forecast&#39;</span><span class="p">])</span>
<span class="n">mse_naive</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">naive_valid</span><span class="p">[</span><span class="s1">&#39;Stock Price&#39;</span><span class="p">],</span> <span class="n">naive_valid</span><span class="p">[</span><span class="s1">&#39;Naive Forecast&#39;</span><span class="p">])</span>
<span class="n">rmse_naive</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse_naive</span><span class="p">)</span>

<span class="c1"># Moving Average Forecast errors</span>
<span class="n">ma_valid</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Stock Price&#39;</span><span class="p">,</span> <span class="s1">&#39;MA Forecast&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">mae_ma</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">ma_valid</span><span class="p">[</span><span class="s1">&#39;Stock Price&#39;</span><span class="p">],</span> <span class="n">ma_valid</span><span class="p">[</span><span class="s1">&#39;MA Forecast&#39;</span><span class="p">])</span>
<span class="n">mse_ma</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">ma_valid</span><span class="p">[</span><span class="s1">&#39;Stock Price&#39;</span><span class="p">],</span> <span class="n">ma_valid</span><span class="p">[</span><span class="s1">&#39;MA Forecast&#39;</span><span class="p">])</span>
<span class="n">rmse_ma</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse_ma</span><span class="p">)</span>

<span class="c1"># Display Errors</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SES Model Errors: MAE=</span><span class="si">{</span><span class="n">mae_ses</span><span class="si">}</span><span class="s2">, MSE=</span><span class="si">{</span><span class="n">mse_ses</span><span class="si">}</span><span class="s2">, RMSE=</span><span class="si">{</span><span class="n">rmse_ses</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Naïve Model Errors: MAE=</span><span class="si">{</span><span class="n">mae_naive</span><span class="si">}</span><span class="s2">, MSE=</span><span class="si">{</span><span class="n">mse_naive</span><span class="si">}</span><span class="s2">, RMSE=</span><span class="si">{</span><span class="n">rmse_naive</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Moving Average Model Errors: MAE=</span><span class="si">{</span><span class="n">mae_ma</span><span class="si">}</span><span class="s2">, MSE=</span><span class="si">{</span><span class="n">mse_ma</span><span class="si">}</span><span class="s2">, RMSE=</span><span class="si">{</span><span class="n">rmse_ma</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5a7fe2b874ff8db9de5dbfbe38334ed7670588cd02111dc05df9e547f5c04724.png" src="_images/5a7fe2b874ff8db9de5dbfbe38334ed7670588cd02111dc05df9e547f5c04724.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SES Model Errors: MAE=0.9729133383726717, MSE=1.5601823406691222, RMSE=1.2490725922335828
Naïve Model Errors: MAE=1.29127148767799, MSE=3.3134789166058947, RMSE=1.8202963815285396
Moving Average Model Errors: MAE=1.2464174205732932, MSE=2.5699578089592032, RMSE=1.6031087951100522
</pre></div>
</div>
</div>
</div>
<ol class="arabic simple" start="3">
<li><p>Interpretation of Results</p></li>
</ol>
<p>a. Naïve Model:
•	The Naïve model is very simple, but it can be very accurate in short-term forecasting when there is little trend or seasonality.
•	However, its accuracy will degrade in the presence of significant trend or seasonality.</p>
<p>b. Moving Average Model:
•	The Moving Average model smooths the series, and the accuracy depends on the choice of window size ( n ).
•	Larger windows will smooth out noise but may miss recent changes in the data.</p>
<p>c. SES Model:
•	The Simple Exponential Smoothing model gives more weight to recent data, which makes it sensitive to recent trends.
•	The accuracy of SES depends heavily on the smoothing parameter ( \alpha ).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.tsa.holtwinters</span><span class="w"> </span><span class="kn">import</span> <span class="n">ExponentialSmoothing</span>

<span class="c1"># Sample data: a small time series (no trend or seasonality)</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">22</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">]</span>
<span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s1">&#39;2024-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
<span class="n">series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>

<span class="c1"># Fit SES model (no trend, no seasonality)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">ExponentialSmoothing</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">trend</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seasonal</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">smoothing_level</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">optimized</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># alpha = 0.5</span>

<span class="c1"># Forecast next 5 days</span>
<span class="n">forecast</span> <span class="o">=</span> <span class="n">fit</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="c1"># Plot the results</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Actual&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">fittedvalues</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fitted (SES)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">forecast</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Forecast&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Simple Exponential Smoothing Forecast&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Value&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/fa43fb478be6fdadcc63139a8d3297138fb1580fbc2d7af85752ef3412ce1a2f.png" src="_images/fa43fb478be6fdadcc63139a8d3297138fb1580fbc2d7af85752ef3412ce1a2f.png" />
</div>
</div>
<section id="mathematics-behind-simple-exponential-smoothing-ses">
<h3><strong>Mathematics Behind Simple Exponential Smoothing (SES)</strong><a class="headerlink" href="#mathematics-behind-simple-exponential-smoothing-ses" title="Link to this heading">#</a></h3>
</section>
<section id="forecasting-equation">
<h3><strong>1. Forecasting Equation</strong><a class="headerlink" href="#forecasting-equation" title="Link to this heading">#</a></h3>
<p>SES uses the following recursive formula:</p>
<div class="math notranslate nohighlight">
\[
\hat{Y}_t = \alpha Y_{t-1} + (1 - \alpha)\hat{Y}_{t-1}
\]</div>
<p>Where:</p>
<ul class="simple">
<li><p>$\hat{Y}_t$: Forecast at time $t$</p></li>
<li><p>$Y_{t-1}$: Actual value at time $t-1$</p></li>
<li><p>$\hat{Y}_{t-1}$: Forecast at time $t-1$</p></li>
<li><p>$\alpha$: Smoothing parameter, $0 &lt; \alpha &lt; 1$</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="mathematical-intuition">
<h3><strong>2. Mathematical Intuition</strong><a class="headerlink" href="#mathematical-intuition" title="Link to this heading">#</a></h3>
<p>At each step:</p>
<ul class="simple">
<li><p>The forecast is a weighted average of the latest observation and the previous forecast.</p></li>
<li><p><strong>Higher</strong> $\alpha$: more weight on $Y_{t-1}$ (recent observation)</p></li>
<li><p><strong>Lower</strong> $\alpha$: more weight on $\hat{Y}_{t-1}$ (historical trend)</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="recursive-expansion">
<h3><strong>3. Recursive Expansion</strong><a class="headerlink" href="#recursive-expansion" title="Link to this heading">#</a></h3>
<p>Expanding the formula recursively:</p>
<div class="math notranslate nohighlight">
\[
\hat{Y}_t = \alpha Y_{t-1} + \alpha(1 - \alpha)Y_{t-2} + \alpha(1 - \alpha)^2 Y_{t-3} + \dots
\]</div>
<p>This reveals:</p>
<ul class="simple">
<li><p>SES is a <strong>weighted average</strong> of all past observations</p></li>
<li><p>Weights <strong>decay exponentially</strong> for older data</p></li>
</ul>
<p>Hence the name: <em>Exponential</em> Smoothing</p>
</section>
<hr class="docutils" />
<section id="initialization">
<h3><strong>4. Initialization</strong><a class="headerlink" href="#initialization" title="Link to this heading">#</a></h3>
<p>To start the recursion at $t = 1$:</p>
<div class="math notranslate nohighlight">
\[
\hat{Y}_1 = Y_1
\]</div>
<p>Alternatively, an average of the first few observations can be used.</p>
</section>
<hr class="docutils" />
<section id="forecasting-future-values">
<h3><strong>5. Forecasting Future Values</strong><a class="headerlink" href="#forecasting-future-values" title="Link to this heading">#</a></h3>
<p>For $h$-step ahead forecasts ($h &gt; 0$):</p>
<div class="math notranslate nohighlight">
\[
\hat{Y}_{t+h} = \hat{Y}_t
\]</div>
<p>Since SES assumes no trend or seasonality, all future forecasts are constant — equal to the last forecast.</p>
</section>
<hr class="docutils" />
<section id="summary">
<h3><strong>Summary</strong><a class="headerlink" href="#summary" title="Link to this heading">#</a></h3>
<p>SES creates a smooth version of the time series where:</p>
<ul class="simple">
<li><p>Recent data has <strong>greater influence</strong></p></li>
<li><p>Forecasts <strong>adapt gradually</strong> unless $\alpha$ is high</p></li>
</ul>
<p>It’s simple, robust, and effective for stationary series with no trend or seasonality.</p>
</section>
</section>
<hr class="docutils" />
<section id="topic-diagnostic-tools-for-forecast-evaluation">
<h2>Topic: Diagnostic Tools for Forecast Evaluation<a class="headerlink" href="#topic-diagnostic-tools-for-forecast-evaluation" title="Link to this heading">#</a></h2>
<hr class="docutils" />
<p>Evaluating forecasting models is crucial for determining how well a model performs and whether it can be used for decision-making. <strong>Diagnostic tools</strong> help assess the accuracy, reliability, and validity of the forecasted data.</p>
<section id="a-residual-analysis">
<h3>a. <strong>Residual Analysis</strong><a class="headerlink" href="#a-residual-analysis" title="Link to this heading">#</a></h3>
<p>Residuals are the differences between the observed values and the forecasted values. A good forecasting model should have residuals that resemble white noise, i.e., they should have no autocorrelation and should be normally distributed.</p>
<div class="math notranslate nohighlight">
\[
\text{Residual}_t = Y_t - \hat{Y}_t
\]</div>
<p>Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( Y_t \)</span> is the observed value at time <span class="math notranslate nohighlight">\( t \)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\( \hat{Y}_t \)</span> is the forecasted value at time <span class="math notranslate nohighlight">\( t \)</span>.</p></li>
</ul>
<p><strong>Steps to Perform Residual Analysis:</strong></p>
<ol class="arabic simple">
<li><p>Calculate the residuals.</p></li>
<li><p>Plot the residuals (or use statistical tests like the Ljung-Box test) to check for autocorrelation.</p></li>
<li><p>Analyze the distribution of residuals using histograms or Q-Q plots to ensure normality.</p></li>
</ol>
</section>
<section id="b-autocorrelation-function-acf">
<h3>b. <strong>Autocorrelation Function (ACF)</strong><a class="headerlink" href="#b-autocorrelation-function-acf" title="Link to this heading">#</a></h3>
<p>The <strong>Autocorrelation Function (ACF)</strong> measures the correlation between the time series data and its lagged values. It is used to check if the residuals of the forecast model are autocorrelated.</p>
<div class="math notranslate nohighlight">
\[
\text{ACF}(h) = \frac{\sum_{t=1}^{n-h} (Y_t - \bar{Y})(Y_{t+h} - \bar{Y})}{\sum_{t=1}^{n} (Y_t - \bar{Y})^2}
\]</div>
<p>Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( h \)</span> is the lag,</p></li>
<li><p><span class="math notranslate nohighlight">\( Y_t \)</span> is the observed value at time <span class="math notranslate nohighlight">\( t \)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\( \bar{Y} \)</span> is the mean of the observed values.</p></li>
</ul>
<p>Scenario:</p>
<p>Suppose you have a time series of residuals from a forecasting model:</p>
<p>Y = [3, 2, 4, 5, 6]</p>
<p>Step 1: Compute the Mean</p>
<div class="math notranslate nohighlight">
\[
\bar{Y} = \frac{3 + 2 + 4 + 5 + 6}{5} = \frac{20}{5} = 4
\]</div>
<p>Step 2: Compute ACF at Lag <span class="math notranslate nohighlight">\(h = 1\)</span></p>
<div class="math notranslate nohighlight">
\[
\text{ACF}(1) = \frac{\sum_{t=1}^{n-1} (Y_t - \bar{Y})(Y_{t+1} - \bar{Y})}{\sum_{t=1}^{n} (Y_t - \bar{Y})^2}
\]</div>
<p>Numerator:</p>
<div class="math notranslate nohighlight">
\[
(3 - 4)(2 - 4) + (2 - 4)(4 - 4) + (4 - 4)(5 - 4) + (5 - 4)(6 - 4) \
= (-1)(-2) + (-2)(0) + (0)(1) + (1)(2) = 2 + 0 + 0 + 2 = 4
\]</div>
<p>Denominator:</p>
<div class="math notranslate nohighlight">
\[
(3 - 4)^2 + (2 - 4)^2 + (4 - 4)^2 + (5 - 4)^2 + (6 - 4)^2 \
= 1 + 4 + 0 + 1 + 4 = 10
\]</div>
<p>ACF:</p>
<div class="math notranslate nohighlight">
\[
\text{ACF}(1) = \frac{4}{10} = 0.4
\]</div>
<p>Interpretation:</p>
<p>There is a moderate positive autocorrelation at lag 1. If this were residuals, it would suggest the model is missing a pattern.</p>
</section>
<section id="c-ljung-box-test">
<h3>c. <strong>Ljung-Box Test</strong><a class="headerlink" href="#c-ljung-box-test" title="Link to this heading">#</a></h3>
<p>The <strong>Ljung-Box test</strong> is used to check whether there is significant autocorrelation in the residuals. If the p-value is high, we fail to reject the null hypothesis, indicating no significant autocorrelation.</p>
<div class="math notranslate nohighlight">
\[
Q = n(n+2) \sum_{h=1}^{m} \frac{\hat{\rho}_h^2}{n-h}
\]</div>
<p>Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( \hat{\rho}_h \)</span> is the sample autocorrelation at lag <span class="math notranslate nohighlight">\( h \)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\( n \)</span> is the number of observations,</p></li>
<li><p><span class="math notranslate nohighlight">\( m \)</span> is the number of lags to test.</p></li>
</ul>
<p>Assume you have these autocorrelations of residuals at lags <span class="math notranslate nohighlight">\(h = 1, 2, 3\)</span>:</p>
<div class="math notranslate nohighlight">
\[
\hat{\rho}_1 = 0.4,\quad \hat{\rho}_2 = 0.2,\quad \hat{\rho}_3 = 0.1
\]</div>
<p>And <span class="math notranslate nohighlight">\(n = 20\)</span>, <span class="math notranslate nohighlight">\(m = 3\)</span>.</p>
<p>Formula:</p>
<div class="math notranslate nohighlight">
\[
Q = n(n+2) \sum_{h=1}^{m} \frac{\hat{\rho}_h^2}{n - h}
\]</div>
<p>Plug in the values:</p>
<div class="math notranslate nohighlight">
\[
Q = 20(22) \left( \frac{0.4^2}{19} + \frac{0.2^2}{18} + \frac{0.1^2}{17} \right)
\]</div>
<div class="math notranslate nohighlight">
\[
Q = 440 \left( \frac{0.16}{19} + \frac{0.04}{18} + \frac{0.01}{17} \right)
\]</div>
<div class="math notranslate nohighlight">
\[
Q = 440 \left( 0.00842 + 0.00222 + 0.00059 \right) = 440 \times 0.01123 \approx 4.94
\]</div>
<p>Interpretation:</p>
<p>Compare <span class="math notranslate nohighlight">\(Q = 4.94\)</span> to the chi-squared critical value at 3 degrees of freedom:</p>
<div class="math notranslate nohighlight">
\[
\chi^2_{0.05, df=3} = 7.815
\]</div>
<p>Since <span class="math notranslate nohighlight">\(4.94 &lt; 7.815\)</span>, we fail to reject the null hypothesis:</p>
<p>→ Residuals are likely not autocorrelated.</p>
</section>
<section id="d-normality-test-of-residuals-shapiro-wilk">
<h3>d. <strong>Normality Test of Residuals (Shapiro-Wilk)</strong><a class="headerlink" href="#d-normality-test-of-residuals-shapiro-wilk" title="Link to this heading">#</a></h3>
<p>A normality test, such as the <strong>Shapiro-Wilk</strong> test, assesses if the model’s residuals follow a normal distribution, a key assumption for the validity of many statistical inferences. Normally distributed residuals suggest the model is appropriate.</p>
<p><strong>Example using the Shapiro-Wilk test:</strong></p>
<p>Assume the residuals from a forecasting model are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">e</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6</span><span class="p">]</span>
</pre></div>
</div>
<p>We can use the <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code> library in Python to perform the Shapiro-Wilk test:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">shapiro</span>

<span class="n">residuals</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6</span><span class="p">]</span>
<span class="n">stat</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">shapiro</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shapiro-Wilk test statistic: </span><span class="si">{</span><span class="n">stat</span><span class="si">}</span><span class="s2">, p-value: </span><span class="si">{</span><span class="n">p_value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Output:</strong>
$<span class="math notranslate nohighlight">\(\text{Test statistic} = 0.97,\quad p\text{-value} = 0.85\)</span>$</p>
<p><strong>Interpretation:</strong></p>
<p>Since the <span class="math notranslate nohighlight">\(p\)</span>-value (0.85) is greater than the typical significance level of 0.05, we fail to reject the null hypothesis. This indicates that the residuals are likely normally distributed, supporting the model’s assumptions.</p>
<p><strong>Understanding Normality:</strong></p>
<p>A variable is normally distributed if its values form a bell-shaped curve (Gaussian distribution), characterized by:</p>
<ul class="simple">
<li><p>Most values clustering around the mean.</p></li>
<li><p>Symmetrical distribution with fewer values further from the mean.</p></li>
<li><p>Consistent spread, quantified by the standard deviation.</p></li>
</ul>
<p>The probability density function (PDF) of the normal distribution is given by:</p>
<div class="math notranslate nohighlight">
\[f(x) = \frac{1}{\sqrt{2\pi\sigma^2}} e^{ -\frac{(x - \mu)^2}{2\sigma^2} }\]</div>
<p>where <span class="math notranslate nohighlight">\(\\mu\)</span> is the mean and <span class="math notranslate nohighlight">\(\\sigma^2\)</span> is the variance.</p>
<p><strong>Importance of Normal Residuals in Forecasting:</strong></p>
<p>In forecasting, we often assume that the errors (residuals) behave as random noise with specific properties, including normality. This assumption is crucial because:</p>
<ol class="arabic simple">
<li><p><strong>Statistical Inference:</strong> Many statistical tests and the construction of confidence intervals rely on the assumption of normality. Non-normal residuals can lead to unreliable conclusions.</p></li>
<li><p><strong>Model Appropriateness:</strong> Normally distributed residuals suggest that the model has effectively captured the underlying patterns in the data. Deviations from normality might indicate issues like:</p>
<ul class="simple">
<li><p><strong>Missing Nonlinearity:</strong> The model might not be accounting for non-linear relationships.</p></li>
<li><p><strong>Outliers:</strong> Extreme values can distort the distribution of residuals.</p></li>
<li><p><strong>Model Misspecification:</strong> The chosen model structure might not be appropriate for the data.</p></li>
</ul>
</li>
</ol>
<p><strong>The Shapiro-Wilk Test in Detail:</strong></p>
<p>The Shapiro-Wilk test specifically assesses whether a given data sample is likely drawn from a normally distributed population.</p>
<ul class="simple">
<li><p><strong>Null Hypothesis (<span class="math notranslate nohighlight">\(H\_0\)</span>):</strong> The data follows a normal distribution.</p></li>
<li><p><strong>Alternative Hypothesis (<span class="math notranslate nohighlight">\(H\_1\)</span>):</strong> The data does not follow a normal distribution.</p></li>
</ul>
<p>The test calculates a statistic (<span class="math notranslate nohighlight">\(W\)</span>) that measures the similarity between the ordered sample values and the expected values under a normal distribution. A small <span class="math notranslate nohighlight">\(p\)</span>-value (typically &lt; 0.05) leads to the rejection of the null hypothesis, suggesting that the data is not normally distributed.</p>
<p><strong>Further Interpretation Example:</strong></p>
<p>Consider the following Shapiro-Wilk test result:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">shapiro</span>
<span class="n">residuals</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>
<span class="n">stat</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">shapiro</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Output:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">0.78</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Since the <span class="math notranslate nohighlight">\(p\)</span>-value (0.78) is greater than 0.05, we fail to reject the null hypothesis.</p></li>
<li><p>Therefore, we can conclude that these residuals are likely normally distributed, indicating that the model performs adequately with respect to this assumption.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.graphics.tsaplots</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_acf</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.stats.diagnostic</span><span class="w"> </span><span class="kn">import</span> <span class="n">acorr_ljungbox</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">shapiro</span>

<span class="c1"># Simulate stock prices over 12 months and perform forecast using SES model</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">months</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s1">&#39;2022-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">)</span>
<span class="n">stock_prices</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">))</span>  <span class="c1"># Random walk for prices</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Stock Price&#39;</span><span class="p">:</span> <span class="n">stock_prices</span><span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="n">months</span><span class="p">)</span>

<span class="c1"># Simple Exponential Smoothing Forecast (using alpha = 0.5)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.tsa.holtwinters</span><span class="w"> </span><span class="kn">import</span> <span class="n">ExponentialSmoothing</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">ExponentialSmoothing</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Stock Price&#39;</span><span class="p">],</span> <span class="n">trend</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seasonal</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;SES Forecast&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span><span class="o">.</span><span class="n">fittedvalues</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Calculate residuals</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Residuals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Stock Price&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;SES Forecast&#39;</span><span class="p">]</span>

<span class="c1"># Plot residuals</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Residuals&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Residuals&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Residuals of SES Forecast&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Date&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Residuals&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># ACF plot for residuals</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plot_acf</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Residuals&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;ACF of Residuals&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Ljung-Box test for autocorrelation in residuals</span>
<span class="n">ljung_box_result</span> <span class="o">=</span> <span class="n">acorr_ljungbox</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Residuals&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">lags</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ljung-Box test results:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ljung_box_result</span><span class="p">)</span>

<span class="c1"># Shapiro-Wilk test for normality of residuals</span>
<span class="n">stat</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">shapiro</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Residuals&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shapiro-Wilk test statistic: </span><span class="si">{</span><span class="n">stat</span><span class="si">}</span><span class="s2">, p-value: </span><span class="si">{</span><span class="n">p_value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/93/7lt42x5j7m39kz7wxbcghvrm0000gn/T/ipykernel_1900/2612017982.py:10: FutureWarning: &#39;M&#39; is deprecated and will be removed in a future version, please use &#39;ME&#39; instead.
  months = pd.date_range(start=&#39;2022-01-01&#39;, periods=12, freq=&#39;M&#39;)
</pre></div>
</div>
<img alt="_images/4d707ba27a28cbd05997d2df0bed2f533f90a719c8942d97301474c93c8fb41f.png" src="_images/4d707ba27a28cbd05997d2df0bed2f533f90a719c8942d97301474c93c8fb41f.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 1000x600 with 0 Axes&gt;
</pre></div>
</div>
<img alt="_images/b0a0d117e399538d6055700475626bea19e6168010e44f1143bb71c3175d63d5.png" src="_images/b0a0d117e399538d6055700475626bea19e6168010e44f1143bb71c3175d63d5.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ljung-Box test results:
   lb_stat  lb_pvalue
1     0.19       0.66
2     3.88       0.14
3     4.48       0.21
4     4.92       0.30
5     5.35       0.38
Shapiro-Wilk test statistic: 0.8512478657520903, p-value: 0.04430714212710189
</pre></div>
</div>
</div>
</div>
<section id="id2">
<h4>Interpretation of Results<a class="headerlink" href="#id2" title="Link to this heading">#</a></h4>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>•	Residual Plot: The residuals should be randomly scattered around zero, with no discernible pattern. Any pattern in the residuals indicates that the model has not fully captured some aspect of the data.
•	ACF Plot: If the residuals are autocorrelated, we expect spikes in the ACF plot at certain lags. A white noise residual should have no significant autocorrelations.
•	Ljung-Box Test: A high p-value indicates that the residuals are uncorrelated, meaning that there is no significant autocorrelation in the model residuals.
•	Shapiro-Wilk Test: A p-value above 0.05 indicates that the residuals are normally distributed.
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.graphics.tsaplots</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_acf</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.stats.diagnostic</span><span class="w"> </span><span class="kn">import</span> <span class="n">acorr_ljungbox</span>

<span class="c1"># Set seed for reproducibility</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>

<span class="c1"># Generate white noise residuals (ideal model)</span>
<span class="n">residuals_white_noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

<span class="c1"># Generate autocorrelated residuals (bad model)</span>
<span class="n">residuals_autocorrelated</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="n">residuals_autocorrelated</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.7</span> <span class="o">*</span> <span class="n">residuals_autocorrelated</span><span class="p">[</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Plot residual time series and ACFs</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1"># Time series</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">residuals_white_noise</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;White Noise Residuals (Good Model)&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Residuals&quot;</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">residuals_autocorrelated</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Autocorrelated Residuals (Misspecified Model)&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Residuals&quot;</span><span class="p">)</span>

<span class="c1"># ACFs</span>
<span class="n">plot_acf</span><span class="p">(</span><span class="n">residuals_white_noise</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">lags</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;ACF: White Noise&quot;</span><span class="p">)</span>
<span class="n">plot_acf</span><span class="p">(</span><span class="n">residuals_autocorrelated</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">lags</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;ACF: Autocorrelated&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Ljung-Box Test Results</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ljung-Box Test (White Noise Residuals):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">acorr_ljungbox</span><span class="p">(</span><span class="n">residuals_white_noise</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">return_df</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Ljung-Box Test (Autocorrelated Residuals):&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">acorr_ljungbox</span><span class="p">(</span><span class="n">residuals_autocorrelated</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">return_df</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/be25fd467695ef158f1c4b769981b1bccdb10a2e9b78bd2053a6484d5437684e.png" src="_images/be25fd467695ef158f1c4b769981b1bccdb10a2e9b78bd2053a6484d5437684e.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ljung-Box Test (White Noise Residuals):
    lb_stat  lb_pvalue
10     7.47       0.68

Ljung-Box Test (Autocorrelated Residuals):
    lb_stat  lb_pvalue
10    51.50       0.00
</pre></div>
</div>
</div>
</div>
<p>What is a p-value?</p>
<p>In statistics, the p-value is the probability of observing test results at least as extreme as the results actually observed, under the assumption that the null hypothesis is true.</p>
<p>In the Context of the Ljung-Box Test:
•	Null Hypothesis (H₀): Residuals are white noise (no autocorrelation).
•	Alternative Hypothesis (H₁): Residuals are not white noise (they are autocorrelated).</p>
<p>Example 1:</p>
<p>Ljung-Box Test (White Noise Residuals):
lb_stat = 7.468256
lb_pvalue = 0.680622</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>•	p-value = 0.680622
•	Interpretation: There’s a 68% chance you’d see this test statistic (or more extreme) if residuals really were white noise.
•	Conclusion: That’s very likely — so we don’t reject the null hypothesis.
</pre></div>
</div>
<p>The residuals are probably just noise.</p>
<p>Example 2:</p>
<p>Ljung-Box Test (Autocorrelated Residuals):
lb_stat = 51.501766
lb_pvalue = 0.000000141</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>•	p-value = 0.000000141 (or 1.41e-07)
•	Interpretation: There’s a 0.0000141% chance you’d get this test statistic (or more extreme) if residuals were truly white noise.
•	Conclusion: That’s highly unlikely — so we reject the null hypothesis.
</pre></div>
</div>
<p>The residuals are not random; they show autocorrelation.</p>
<p>Use the 5% significance level (p &lt; 0.05) as a cutoff:
•	p &gt; 0.05 → Residuals are okay → Model is fine
•	p &lt; 0.05 → Residuals are autocorrelated → Model is inadequate</p>
</section>
</section>
<section id="homoscedasticity-and-heteroscedasticity">
<h3>Homoscedasticity and Heteroscedasticity<a class="headerlink" href="#homoscedasticity-and-heteroscedasticity" title="Link to this heading">#</a></h3>
<p><strong>Definition:</strong> Homoscedasticity refers to a condition where the variance of the errors (residuals) in a model is constant across all levels of the predicted values.</p>
<p><strong>Mathematical Representation:</strong> If the error term at time <span class="math notranslate nohighlight">\(t\)</span> is defined as:</p>
<div class="math notranslate nohighlight">
\[e_t = Y_t - \hat Y_t\]</div>
<p>where <span class="math notranslate nohighlight">\(Y_t\)</span> is the actual value and <span class="math notranslate nohighlight">\(\hat Y_t\)</span> is the predicted value, then homoscedasticity implies:</p>
<div class="math notranslate nohighlight">
\[\mathrm{Var}(e_t) = \sigma^2 \quad \text{for all }t.\]</div>
<p>This means the spread of the residuals remains the same regardless of the magnitude of the forecast.</p>
<p><strong>Importance of Homoscedasticity:</strong></p>
<p>The assumption of homoscedasticity is crucial for several reasons:</p>
<ol class="arabic simple">
<li><p><strong>Reliable Confidence Intervals:</strong> Many forecasting and regression techniques rely on the assumption of constant error variance to calculate the width of prediction intervals. If the error variance changes (heteroscedasticity), the prediction intervals will be:</p>
<ul class="simple">
<li><p>Too narrow in regions where the error variance is high, leading to overconfidence.</p></li>
<li><p>Too wide in regions where the error variance is low, leading to underconfidence.</p></li>
</ul>
</li>
<li><p><strong>Valid Hypothesis Tests:</strong> Statistical tests for significance, such as t-tests on coefficients and F-tests for model fit, assume constant error variance. Heteroscedasticity can lead to:</p>
<ul class="simple">
<li><p>Incorrect p-values, potentially causing you to incorrectly identify variables as significant or insignificant.</p></li>
</ul>
</li>
<li><p><strong>Efficiency of Estimates:</strong> Under homoscedasticity, Ordinary Least Squares (OLS) and similar estimators are considered the Best Linear Unbiased Estimators (BLUE), meaning they provide the most efficient (lowest variance) unbiased estimates. In the presence of heteroscedasticity:</p>
<ul class="simple">
<li><p>OLS remains unbiased but is no longer the most efficient estimator. Other estimation methods could yield more precise results.</p></li>
</ul>
</li>
</ol>
<p><strong>Illustrative Example:</strong></p>
<p>Consider forecasting daily sales for two stores:</p>
<ul class="simple">
<li><p><strong>Store A:</strong> Consistently sells around 100 units with a variation of <span class="math notranslate nohighlight">\(\pm 10\)</span> units.</p></li>
<li><p><strong>Store B:</strong> Sales fluctuate more widely, selling around 100 units with a variation of <span class="math notranslate nohighlight">\(\pm 50\)</span> units.</p></li>
</ul>
<p>If a single forecasting model is applied to both stores, the residuals for Store B will exhibit a much larger spread than those for Store A. This violates the assumption of homoscedasticity (“same scatter everywhere”). Consequently, the prediction intervals generated by the model might be:</p>
<ul class="simple">
<li><p>Too tight for Store B, underestimating the actual uncertainty in sales.</p></li>
<li><p>Too loose for Store A, overestimating the uncertainty.</p></li>
</ul>
<p><strong>Consequences of Ignoring Heteroscedasticity:</strong></p>
<p>Ignoring heteroscedasticity can lead to several problems:</p>
<ul class="simple">
<li><p><strong>Misleading Confidence Intervals:</strong> Forecast uncertainty will be inaccurately represented, either overstated or understated.</p></li>
<li><p><strong>Wrong Significance Tests:</strong> Conclusions about the significance of trends or effects might be incorrect due to unreliable p-values.</p></li>
<li><p><strong>Poor Resource Allocation:</strong> Decisions based on flawed intervals and tests (e.g., staffing levels, inventory management) will likely be suboptimal.</p></li>
</ul>
<p><strong>Methods to Check for Homoscedasticity:</strong></p>
<p>Several methods can be used to detect heteroscedasticity:</p>
<ol class="arabic simple">
<li><p><strong>Residuals vs. Fitted Plot:</strong></p>
<ul class="simple">
<li><p>Plot the residuals (<span class="math notranslate nohighlight">\(e_t\)</span>) on the vertical (y) axis against the fitted values (<span class="math notranslate nohighlight">\(\hat Y_t\)</span>) on the horizontal (x) axis.</p></li>
<li><p>Examine the scatter of the points. Under homoscedasticity, the points should form a <strong>random cloud with a roughly constant vertical spread</strong> across all fitted values.</p></li>
<li><p>A <strong>fan shape</strong> (where the vertical spread of the residuals increases or decreases as the fitted values change) is a visual indicator of <strong>heteroscedasticity</strong>.</p></li>
</ul>
</li>
<li><p><strong>Breusch–Pagan Test:</strong></p>
<ul class="simple">
<li><p>This is a formal statistical test designed to detect whether the variance of the errors is dependent on the values of the independent variables (or the fitted values).</p></li>
<li><p><strong>Null Hypothesis:</strong> The variance of the errors is constant (homoscedasticity).</p></li>
<li><p>A <strong>low p-value</strong> (typically below a chosen significance level, e.g., 0.05) leads to the rejection of the null hypothesis, providing statistical evidence of <strong>heteroscedasticity</strong>.</p></li>
</ul>
</li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">statsmodels.api</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sm</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.stats.diagnostic</span><span class="w"> </span><span class="kn">import</span> <span class="n">het_breuschpagan</span>

<span class="c1"># Set random seed for reproducibility</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Generate data</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

<span class="c1"># Homoscedastic data: constant variance</span>
<span class="n">y_homo</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

<span class="c1"># Heteroscedastic data: variance increases with x</span>
<span class="n">y_hetero</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

<span class="c1"># Fit linear regression models</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># Add intercept</span>
<span class="n">model_homo</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">y_homo</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">model_hetero</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">y_hetero</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="c1"># Residuals</span>
<span class="n">res_homo</span> <span class="o">=</span> <span class="n">model_homo</span><span class="o">.</span><span class="n">resid</span>
<span class="n">res_hetero</span> <span class="o">=</span> <span class="n">model_hetero</span><span class="o">.</span><span class="n">resid</span>

<span class="c1"># Plotting</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># Homoscedastic plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">res_homo</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Homoscedasticity: Constant Residual Variance&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Residuals ($e_i$)&#39;</span><span class="p">)</span>

<span class="c1"># Heteroscedastic plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">res_hetero</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Heteroscedasticity: Increasing Residual Variance&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Residuals ($e_i$)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Breusch-Pagan test for heteroscedasticity</span>
<span class="n">bp_test_homo</span> <span class="o">=</span> <span class="n">het_breuschpagan</span><span class="p">(</span><span class="n">res_homo</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
<span class="n">bp_test_hetero</span> <span class="o">=</span> <span class="n">het_breuschpagan</span><span class="p">(</span><span class="n">res_hetero</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Breusch-Pagan Test for Homoscedastic Data:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;LM Statistic: </span><span class="si">{</span><span class="n">bp_test_homo</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, p-value: </span><span class="si">{</span><span class="n">bp_test_homo</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Breusch-Pagan Test for Heteroscedastic Data:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;LM Statistic: </span><span class="si">{</span><span class="n">bp_test_hetero</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, p-value: </span><span class="si">{</span><span class="n">bp_test_hetero</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3a306787c7a52adbef511290782b5c80664fe8554955e49646a8f975e6b62c0e.png" src="_images/3a306787c7a52adbef511290782b5c80664fe8554955e49646a8f975e6b62c0e.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Breusch-Pagan Test for Homoscedastic Data:
LM Statistic: 0.27, p-value: 0.6014

Breusch-Pagan Test for Heteroscedastic Data:
LM Statistic: 13.07, p-value: 0.0003
</pre></div>
</div>
</div>
</div>
<p>Stall A is located in a stable residential area with consistent foot traffic. Its daily sales tend to fluctuate within a narrow range.</p>
<p>Stall B is located near a seasonal tourist attraction. Its daily sales are much more volatile, depending on the time of the week and the tourist season.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># --- Stall A: Homoscedasticity ---</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">time_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
<span class="n">historical_sales_a</span> <span class="o">=</span> <span class="mi">50</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">forecast_days</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">37</span><span class="p">)</span>
<span class="n">forecast_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">51</span><span class="p">)</span>
<span class="n">upper_bound_a</span> <span class="o">=</span> <span class="n">forecast_a</span> <span class="o">+</span> <span class="mi">5</span>
<span class="n">lower_bound_a</span> <span class="o">=</span> <span class="n">forecast_a</span> <span class="o">-</span> <span class="mi">5</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_a</span><span class="p">,</span> <span class="n">historical_sales_a</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Historical Sales&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">forecast_days</span><span class="p">,</span> <span class="n">forecast_a</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Forecast&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">forecast_days</span><span class="p">,</span> <span class="n">lower_bound_a</span><span class="p">,</span> <span class="n">upper_bound_a</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;95% Prediction Interval&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Stall A: Homoscedasticity&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Day&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Ice Cream Cones Sold&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># --- Stall B: Heteroscedasticity ---</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">time_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
<span class="n">base_sales_b</span> <span class="o">=</span> <span class="mi">30</span> <span class="o">+</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span> <span class="c1"># Simulate some trend</span>
<span class="n">noise_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span> <span class="mi">30</span><span class="p">)</span> <span class="c1"># Increasing variance over time</span>
<span class="n">historical_sales_b</span> <span class="o">=</span> <span class="n">base_sales_b</span> <span class="o">+</span> <span class="n">noise_b</span>
<span class="n">forecast_b_point</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">35</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">upper_bound_b</span> <span class="o">=</span> <span class="n">forecast_b_point</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">lower_bound_b</span> <span class="o">=</span> <span class="n">forecast_b_point</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_b</span><span class="p">,</span> <span class="n">historical_sales_b</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Historical Sales&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">forecast_days</span><span class="p">,</span> <span class="n">forecast_b_point</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Forecast&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">forecast_days</span><span class="p">,</span> <span class="n">lower_bound_b</span><span class="p">,</span> <span class="n">upper_bound_b</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;95% Prediction Interval&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Stall B: Heteroscedasticity&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Day&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Ice Cream Cones Sold&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/370045d3950111da3c572e95e2ff826fcee0e86b33aec104eabefc4a2428bb22.png" src="_images/370045d3950111da3c572e95e2ff826fcee0e86b33aec104eabefc4a2428bb22.png" />
</div>
</div>
</section>
<section id="impact-of-heteroscedasticity-on-forecasting-with-simple-exponential-smoothing-ses">
<h3><strong>Impact of Heteroscedasticity on Forecasting with Simple Exponential Smoothing (SES)</strong><a class="headerlink" href="#impact-of-heteroscedasticity-on-forecasting-with-simple-exponential-smoothing-ses" title="Link to this heading">#</a></h3>
<section id="recap-of-scenarios">
<h4><strong>Recap of Scenarios</strong><a class="headerlink" href="#recap-of-scenarios" title="Link to this heading">#</a></h4>
<ol class="arabic simple">
<li><p><strong>Homoscedastic Data</strong></p>
<ul class="simple">
<li><p>Constant residual variance across predictor ($x$)</p></li>
<li><p>Example: $y = 2x + \epsilon$, where $\epsilon \sim N(0, 1)$</p></li>
<li><p>Visual: Residuals are evenly scattered with constant spread</p></li>
</ul>
</li>
<li><p><strong>Heteroscedastic Data</strong></p>
<ul class="simple">
<li><p>Residual variance changes with $x$</p></li>
<li><p>Example: $y = 2x + \epsilon$, where $\epsilon \sim N(0, 0.5x)$</p></li>
<li><p>Visual: Residuals form a funnel shape; spread increases with $x$</p></li>
</ul>
</li>
</ol>
</section>
</section>
<section id="simple-exponential-smoothing-ses">
<h3><strong>Simple Exponential Smoothing (SES)</strong><a class="headerlink" href="#simple-exponential-smoothing-ses" title="Link to this heading">#</a></h3>
<p>SES forecasts future values using exponentially weighted past data:</p>
<p><span class="math notranslate nohighlight">\(\hat{y}_{t+1} = \alpha y_t + (1 - \alpha)\hat{y}_t\)</span></p>
<p>Where:</p>
<ul class="simple">
<li><p>$\hat{y}_{t+1}$: forecast for next time step</p></li>
<li><p>$y_t$: actual value at time $t$</p></li>
<li><p>$\hat{y}_t$: forecast at time $t$</p></li>
<li><p>$\alpha$: smoothing parameter, $0 &lt; \alpha &lt; 1$</p></li>
</ul>
<p><strong>Assumptions:</strong></p>
<ul class="simple">
<li><p>No trend or seasonality</p></li>
<li><p>Errors are i.i.d. with constant variance (homoscedastic)</p></li>
</ul>
</section>
<section id="effect-of-error-variance-on-ses">
<h3><strong>Effect of Error Variance on SES</strong><a class="headerlink" href="#effect-of-error-variance-on-ses" title="Link to this heading">#</a></h3>
<section id="homoscedastic-time-series">
<h4><strong>1. Homoscedastic Time Series</strong><a class="headerlink" href="#homoscedastic-time-series" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Error: $\epsilon_t \sim N(0, \sigma^2)$ (constant over time)</p></li>
</ul>
<p><strong>Impact:</strong></p>
<ul class="simple">
<li><p>SES aligns well with assumptions</p></li>
<li><p>Forecasts and intervals are stable and reliable</p></li>
<li><p>$\alpha$ effectively balances recency and history</p></li>
</ul>
<p><strong>Example:</strong> Daily bread sales with random noise of about $\pm 100$</p>
</section>
<section id="heteroscedastic-time-series">
<h4><strong>2. Heteroscedastic Time Series</strong><a class="headerlink" href="#heteroscedastic-time-series" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Error: $\epsilon_t \sim N(0, \sigma_t^2)$, where $\sigma_t^2$ grows with $t$ or $y_t$</p></li>
</ul>
<p><strong>Impact:</strong></p>
<ul class="simple">
<li><p><strong>Forecast Bias:</strong> SES misinterprets fluctuations</p></li>
<li><p><strong>Unreliable Intervals:</strong> Too narrow during high variance, too wide during low</p></li>
<li><p><strong>Poor Volatility Handling:</strong> May lag or overreact with large $\alpha$</p></li>
</ul>
<p><strong>Example:</strong> Tech gadget sales</p>
<ul class="simple">
<li><p>Launch: noise $\approx \pm 1000$</p></li>
<li><p>Off-peak: noise $\approx \pm 50$</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.tsa.holtwinters</span><span class="w"> </span><span class="kn">import</span> <span class="n">SimpleExpSmoothing</span>

<span class="c1"># Set random seed for reproducibility</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Generate time-series data</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

<span class="c1"># Homoscedastic data: constant variance</span>
<span class="n">y_homo</span> <span class="o">=</span> <span class="mi">50</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

<span class="c1"># Heteroscedastic data: variance increases with time</span>
<span class="n">y_hetero</span> <span class="o">=</span> <span class="mi">50</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">t</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

<span class="c1"># Apply SES</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">model_homo</span> <span class="o">=</span> <span class="n">SimpleExpSmoothing</span><span class="p">(</span><span class="n">y_homo</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">smoothing_level</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">optimized</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">model_hetero</span> <span class="o">=</span> <span class="n">SimpleExpSmoothing</span><span class="p">(</span><span class="n">y_hetero</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">smoothing_level</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">optimized</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Forecasts (one-step ahead)</span>
<span class="n">forecast_homo</span> <span class="o">=</span> <span class="n">model_homo</span><span class="o">.</span><span class="n">fittedvalues</span>
<span class="n">forecast_hetero</span> <span class="o">=</span> <span class="n">model_hetero</span><span class="o">.</span><span class="n">fittedvalues</span>

<span class="c1"># Residuals</span>
<span class="n">res_homo</span> <span class="o">=</span> <span class="n">y_homo</span> <span class="o">-</span> <span class="n">forecast_homo</span>
<span class="n">res_hetero</span> <span class="o">=</span> <span class="n">y_hetero</span> <span class="o">-</span> <span class="n">forecast_hetero</span>

<span class="c1"># Plotting</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1"># Homoscedastic: Series and Forecast</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y_homo</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Actual&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">forecast_homo</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;SES Forecast&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Homoscedastic Data: SES Forecast&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Value ($y_t$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Homoscedastic: Residuals</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">res_homo</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Homoscedastic Residuals&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Residuals ($e_t$)&#39;</span><span class="p">)</span>

<span class="c1"># Heteroscedastic: Series and Forecast</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y_hetero</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Actual&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">forecast_hetero</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;SES Forecast&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Heteroscedastic Data: SES Forecast&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Value ($y_t$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Heteroscedastic: Residuals</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">res_hetero</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Heteroscedastic Residuals&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Residuals ($e_t$)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Calculate Mean Absolute Error (MAE)</span>
<span class="n">mae_homo</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">res_homo</span><span class="p">))</span>
<span class="n">mae_hetero</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">res_hetero</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAE for Homoscedastic Data: </span><span class="si">{</span><span class="n">mae_homo</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAE for Heteroscedastic Data: </span><span class="si">{</span><span class="n">mae_hetero</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1591da8f896594f862ea9f870adda4a68ea2a7bfdfe9890600fc3022c9691072.png" src="_images/1591da8f896594f862ea9f870adda4a68ea2a7bfdfe9890600fc3022c9691072.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MAE for Homoscedastic Data: 2.54
MAE for Heteroscedastic Data: 4.60
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="exponential-smoothing-models-in-statsmodels">
<h3><strong>Exponential Smoothing Models in <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code></strong><a class="headerlink" href="#exponential-smoothing-models-in-statsmodels" title="Link to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code> library supports three main types of exponential smoothing models:</p>
<hr class="docutils" />
<section id="id3">
<h4><strong>1. Simple Exponential Smoothing (SES)</strong><a class="headerlink" href="#id3" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>No trend</p></li>
<li><p>No seasonality</p></li>
<li><p>Suitable for stationary data (no upward/downward pattern)</p></li>
</ul>
<p><strong>Forecast equation:</strong>
<span class="math notranslate nohighlight">\(\hat{y}_{t+1} = \alpha y_t + (1 - \alpha)\hat{y}_t\)</span>
Where:</p>
<ul class="simple">
<li><p>$0 &lt; \alpha &lt; 1$ is the smoothing parameter</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="holts-linear-trend-method">
<h4><strong>2. Holt’s Linear Trend Method</strong><a class="headerlink" href="#holts-linear-trend-method" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Captures linear trend</p></li>
<li><p>No seasonality</p></li>
<li><p>Also known as <strong>Double Exponential Smoothing</strong></p></li>
</ul>
<p><strong>Equations:</strong></p>
<ul class="simple">
<li><p>Level: $l_t = \alpha y_t + (1 - \alpha)(l_{t-1} + b_{t-1})$</p></li>
<li><p>Trend: $b_t = \beta (l_t - l_{t-1}) + (1 - \beta) b_{t-1}$</p></li>
<li><p>Forecast: $\hat{y}_{t+h} = l_t + h b_t$</p></li>
</ul>
<p>Where:</p>
<ul class="simple">
<li><p>$\alpha$ is the level smoothing parameter</p></li>
<li><p>$\beta$ is the trend smoothing parameter</p></li>
<li><p>$h$ is the forecast horizon</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="holt-winters-seasonal-method">
<h4><strong>3. Holt-Winters Seasonal Method</strong><a class="headerlink" href="#holt-winters-seasonal-method" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Captures trend and seasonality</p></li>
<li><p>Also called <strong>Triple Exponential Smoothing</strong></p></li>
<li><p>Seasonality can be <strong>additive</strong> or <strong>multiplicative</strong></p></li>
</ul>
<p><strong>Additive Seasonal Model:</strong></p>
<ul class="simple">
<li><p>Level: $l_t = \alpha (y_t - s_{t-m}) + (1 - \alpha)(l_{t-1} + b_{t-1})$</p></li>
<li><p>Trend: $b_t = \beta (l_t - l_{t-1}) + (1 - \beta) b_{t-1}$</p></li>
<li><p>Seasonality: $s_t = \gamma (y_t - l_{t-1} - b_{t-1}) + (1 - \gamma)s_{t-m}$</p></li>
<li><p>Forecast: $\hat{y}<em>{t+h} = l_t + h b_t + s</em>{t+h-m(k)}$</p></li>
</ul>
<p><strong>Multiplicative Seasonal Model:</strong></p>
<ul class="simple">
<li><p>Replace additive components (e.g., $y_t - s_{t-m}$) with multiplicative ones (e.g., $y_t / s_{t-m}$)</p></li>
</ul>
<p>Where:</p>
<ul class="simple">
<li><p>$m$ is the seasonal period</p></li>
<li><p>$\gamma$ is the seasonality smoothing parameter</p></li>
<li><p>$k = \lfloor (h-1)/m \rfloor$</p></li>
</ul>
<hr class="docutils" />
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="seasonal_data.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Seasonal Data Forecasting Models</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#topic-components-of-time-series-data">Topic: Components of Time Series Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-are-the-components-of-time-series">1. What are the Components of Time Series?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-in-finance">Use in Finance:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#decomposition-of-time-series-data">2. Decomposition of Time Series Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#decomposition-formula">Decomposition formula:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-model">1. The Model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estimate-the-trend-mathbf-t-t-via-centered-moving-average">2. Estimate the Trend <span class="math notranslate nohighlight">\(\mathbf{T_t}\)</span> via Centered Moving Average</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#detrend-to-expose-seasonality">3. Detrend to Expose Seasonality</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estimate-the-seasonal-indices-mathbf-s-i">4. Estimate the Seasonal Indices <span class="math notranslate nohighlight">\(\mathbf{S_i}\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-the-residuals-mathbf-r-t">5. Compute the Residuals <span class="math notranslate nohighlight">\(\mathbf{R_t}\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#worked-illustration-additive-m-4">6. Worked Illustration (Additive, <span class="math notranslate nohighlight">\(m=4\)</span>)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#topic-average-forecasting-method">Topic: Average Forecasting Method</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#topic-errors-and-error-criterion">Topic: Errors and Error Criterion</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Use in Finance:</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretation-of-results">Interpretation of Results</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#topic-naive-moving-average-and-ses-forecasts">Topic: Naïve, Moving Average, and SES Forecasts</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mathematics-behind-simple-exponential-smoothing-ses"><strong>Mathematics Behind Simple Exponential Smoothing (SES)</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forecasting-equation"><strong>1. Forecasting Equation</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mathematical-intuition"><strong>2. Mathematical Intuition</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recursive-expansion"><strong>3. Recursive Expansion</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#initialization"><strong>4. Initialization</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forecasting-future-values"><strong>5. Forecasting Future Values</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#summary"><strong>Summary</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#topic-diagnostic-tools-for-forecast-evaluation">Topic: Diagnostic Tools for Forecast Evaluation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-residual-analysis">a. <strong>Residual Analysis</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-autocorrelation-function-acf">b. <strong>Autocorrelation Function (ACF)</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-ljung-box-test">c. <strong>Ljung-Box Test</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d-normality-test-of-residuals-shapiro-wilk">d. <strong>Normality Test of Residuals (Shapiro-Wilk)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Interpretation of Results</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#homoscedasticity-and-heteroscedasticity">Homoscedasticity and Heteroscedasticity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#impact-of-heteroscedasticity-on-forecasting-with-simple-exponential-smoothing-ses"><strong>Impact of Heteroscedasticity on Forecasting with Simple Exponential Smoothing (SES)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recap-of-scenarios"><strong>Recap of Scenarios</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-exponential-smoothing-ses"><strong>Simple Exponential Smoothing (SES)</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#effect-of-error-variance-on-ses"><strong>Effect of Error Variance on SES</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#homoscedastic-time-series"><strong>1. Homoscedastic Time Series</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#heteroscedastic-time-series"><strong>2. Heteroscedastic Time Series</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exponential-smoothing-models-in-statsmodels"><strong>Exponential Smoothing Models in <code class="docutils literal notranslate"><span class="pre">statsmodels</span></code></strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3"><strong>1. Simple Exponential Smoothing (SES)</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#holts-linear-trend-method"><strong>2. Holt’s Linear Trend Method</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#holt-winters-seasonal-method"><strong>3. Holt-Winters Seasonal Method</strong></a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Chandravesh Chaudhari
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>